---
title: 役割、役割サービス、または機能のインストールまたはアンインストール
description: サーバー マネージャー
ms.topic: article
ms.assetid: 04f16d84-45c2-4771-84c1-1cc973d0ee02
ms.author: lizross
author: eross-msft
manager: mtillman
ms.date: 10/16/2017
ms.openlocfilehash: 91cc11133d42168197541e451da27771a377bab9
ms.sourcegitcommit: db2d46842c68813d043738d6523f13d8454fc972
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/10/2020
ms.locfileid: "89628399"
---
# <a name="install-or-uninstall-roles-role-services-or-features"></a>役割、役割サービス、または機能のインストールまたはアンインストール

>適用先:Windows Server (半期チャネル)、Windows Server 2016、Windows Server 2012 R2、Windows Server 2012

サーバー マネージャーのコンソールと Windows PowerShell コマンドレットでサーバー マネージャーは、Windows Server の役割と機能をローカルまたはリモート サーバーまたはオフラインの仮想ハード_ディスク (Vhd) のインストールを許可します。 1台のリモートサーバーまたはオフライン VHD に複数の役割と機能をインストールするには、単一の役割と機能の追加ウィザードまたは Windows PowerShell セッションを使用します。

> [!IMPORTANT]
> Windows Server オペレーティング システムのそれ以降のリリースを管理する、サーバー マネージャーを使用できません。 Windows server 2012 R2 または Windows 8.1 で実行されているサーバーマネージャーを使用して、Windows Server 2016 を実行しているサーバーに役割、役割サービス、および機能をインストールすることはできません。

インストールまたは役割、役割サービス、および機能をアンインストールするために管理者は、サーバーにログオンする必要があります。 ターゲット サーバーに対する管理者権限のないアカウントでローカル コンピューターにログオンしている場合は、**[サーバー]** タイルでターゲット サーバーを右クリックし、**[管理に使用する資格情報]** をクリックして、管理者権限を持つアカウントを指定します。 オフライン VHD のマウント先のサーバーをサーバー マネージャーに追加する必要があります。さらに、マウント先のサーバーの管理者権限が必要です。

詳細については、役割、役割サービス、および機能とは、次を参照してください。 [役割、役割サービス、および機能](https://go.microsoft.com/fwlink/p/?LinkId=239558)です。

このトピックは、次のセクションで構成されています。

-   [役割と機能の追加ウィザードを使用して役割、役割サービス、および機能をインストールする](#install-roles-role-services-and-features-by-using-the-add-roles-and-features-wizard)

-   [Windows PowerShell コマンドレットを使用して役割、役割サービス、および機能をインストールする](#install-roles-role-services-and-features-by-using-windows-powershell-cmdlets)

-   [役割と機能の削除ウィザードを使用して役割、役割サービス、および機能を削除する](#remove-roles-role-services-and-features-by-using-the-remove-roles-and-features-wizard)

-   [Windows PowerShell コマンドレットを使用して役割、役割サービス、および機能を削除する](#remove-roles-role-services-and-features-by-using-windows-powershell-cmdlets)

-   [Windows PowerShell スクリプトを実行して複数のサーバーに役割と機能をインストールする](#install-roles-and-features-on-multiple-servers-by-running-a-windows-powershell-script)

-   [.NET Framework 3.5 とその他の機能をオンデマンドでインストールする](#install-net-framework-35-and-other-features-on-demand)

## <a name="install-roles-role-services-and-features-by-using-the-add-roles-and-features-wizard"></a>役割と機能の追加ウィザードを使用して役割、役割サービス、および機能をインストールする
役割と機能の追加ウィザードの1回のセッションで、役割、役割サービス、および機能をローカルサーバー、サーバーマネージャーに追加されたリモートサーバー、またはオフライン VHD にインストールできます。 サーバー マネージャーを管理するサーバーを追加する方法の詳細については、次を参照してください。 [サーバー マネージャーにサーバーの追加](add-servers-to-server-manager.md)します。

> [!NOTE]
> Windows Server 2016 または Windows 10 でサーバーマネージャーを実行している場合は、役割と機能の追加ウィザードを使用して、Windows Server 2016 を実行しているサーバーおよびオフライン Vhd のみに役割と機能をインストールすることができます。

#### <a name="to-install-roles-and-features-by-using-the-add-roles-and-features-wizard"></a>役割と機能の追加ウィザードを使用して役割と機能をインストールするには

1.  サーバー マネージャーを既に開いている場合は、次の手順に進んでください。 サーバー マネージャーをまだ開いていない場合は、次のいずれかの方法で開きます。

    -   Windows デスクトップで、Windows タスク バーの **[サーバー マネージャー]** をクリックし、サーバー マネージャーを開始します。

    -   Windows の **スタート** 画面で、[ **サーバーマネージャー** ] タイルをクリックします。

2.  [ **管理** ] メニューの [ **役割と機能の追加**] をクリックします。

3.  **[開始する前に]** ページで、インストールする役割と機能のために、対象サーバーとネットワーク環境の準備が整っていることを確認してください。 **[次へ]** をクリックします。

4.  **[インストールの種類の選択]** ページで、**[役割ベースまたは機能ベースのインストール]** を選択して 1 台のサーバーにすべての役割や機能をインストールするか、**[リモート デスクトップ サービスのインストール]** を選択して仮想マシン ベースのデスクトップ インフラストラクチャ、またはリモート デスクトップ サービス向けのセッション ベースのデスクトップ インフラストラクチャをインストールします。 **[リモート デスクトップ サービスのインストール]** オプションでは、管理者の必要に応じて、リモート デスクトップ サービスの役割の論理部分がさまざまなサーバーに分散されます。 **[次へ]** をクリックします。

5.  **[対象サーバーの選択]** ページで、サーバー プールからサーバーを選択するか、オフライン VHD を選択します。 対象サーバーとしてオフライン VHD を選択するには、まず VHD マウント先のサーバーを選択してから、VHD ファイルを選択します。 サーバーをサーバープールに追加する方法の詳細については、「 [サーバーマネージャーへのサーバーの追加](add-servers-to-server-manager.md)」を参照してください。 対象サーバーを選択したら、**[次へ]** をクリックします。

    > [!NOTE]
    > オフライン VHD に役割や機能をインストールするには、対象 VHD が次の要件を満たしている必要があります。
    >
    > -   Vhd では、実行しているサーバー マネージャーのバージョンに対応する Windows Server のリリースが実行されている必要があります。 役割 [と機能の追加ウィザードを使用した役割、役割サービス、および機能のインストール](#install-roles-role-services-and-features-by-using-the-add-roles-and-features-wizard)の開始に関するメモを参照してください。
    > -   VHD に複数のシステム ボリュームまたはパーティションが存在することはできません。
    > -   VHD ファイルが格納されているネットワーク共有フォルダーについては、VHD のマウント先に選択したサーバーのコンピューター アカウント (またはローカル システム アカウント) に、次のアクセス許可を付与する必要があります。 ユーザー専用のアカウントにアクセス許可を与えるだけでは不十分です。 ネットワーク共有では、**読み取り**アクセス許可と**書き込み**アクセス許可を **Everyone** グループに付与し、VHD へのアクセスを許可することができますが、セキュリティ上の理由からこの方法はお勧めしません。
    >
    >     -   **[ファイルの共有]** ダイアログ ボックスの **[読み取り/書き込み]** アクセス
    >     -   **フル コントロール** 上のアクセス、 **セキュリティ** ] タブ、ファイルまたはフォルダー **プロパティ** ] ダイアログ ボックス。

6.  役割を選択して、役割の役割サービス (該当する場合) を選択し、**[次へ]** をクリックして機能を選択します。

    続行すると、役割と機能の追加ウィザードは、選択した役割または機能のインストールまたは通常の動作を妨げる可能性がある競合が移行先サーバーで見つかった場合に自動的に通知します。 また、選択した役割または機能で必要とされる役割、役割サービス、または機能を追加するように求めるダイアログも表示されます。

    さらに、別のサーバー、またはリモート サーバー管理ツールを実行している Windows クライアントベースのコンピューターのどちらかから役割をリモート管理する場合は、役割に使用する管理ツールやスナップインを対象サーバーにインストールしない選択もできます。 既定では、役割と機能の追加ウィザードでは、管理ツールがインストール用に選択されています。

7.  **[インストール オプションの確認]** ページで、選択されている役割、機能、およびサーバーを確認します。 インストールする準備が整ったら、**[インストール]** をクリックします。

    Windows PowerShell を使用した無人インストール用に使用できる XML ベースの構成ファイルに、選択内容をエクスポートすることもできます。 この役割と機能の追加ウィザードのセッションで指定した構成をエクスポートするには、[ **構成設定のエクスポート**] をクリックし、XML ファイルを任意の場所に保存します。

    **[インストール オプションの確認]** ページの **[代替ソース パスの指定]** コマンドをクリックすると、選択したサーバーに役割と機能をインストールするために必要なファイルの代替ソース パスを指定することができます。 Windows Server 2012 および Windows Server の今後のリリースで [オンデマンド機能](https://go.microsoft.com/fwlink/p/?LinkID=241573) ディスクのみリモートで管理されているサーバーから役割と機能のファイルを削除することによって、オペレーティング システムで使用される領域の量を減らすことができます。 `Uninstall-WindowsFeature -remove` コマンドレットを使用して役割と機能のファイルをサーバーから削除した場合、代替ソース パス、または必要な機能と役割のファイルが保存される共有を指定して、役割と機能を後からサーバーにインストールすることができます。 ソースパスまたはファイル共有では、**読み取り**アクセス許可を**Everyone**グループ (セキュリティ上の理由から推奨されません)、または移行先サーバーのコンピューターアカウント (*DOMAIN*SERverNAME $) のいずれかに付与する必要があります。 \\ *SERverNAME*ユーザーアカウントのアクセス許可を付与するだけでは不十分です。 オンデマンド機能の詳細については、「 [Windows Server インストール オプション](https://go.microsoft.com/fwlink/p/?LinkId=241573)」を参照してください。

    実行中の物理サーバーの役割、役割サービス、および機能をインストールしている場合は、別の機能ファイルのソースとして WIM ファイルを指定できます。 WIM ファイルのソース パスは、**WIM** をプレフィックスとし、機能ファイルの位置を示すインデックスをサフィックスとして、**WIM:e:\sources\install.wim:4** という形式にする必要があります。 。 オフライン VHD に役割、役割サービス、および機能をインストールするため、ソースとして直接 WIM ファイルを使用することはできません必要がありますか、オフライン VHD をマウントしてソース ファイルのマウント パスをポイントしたか、WIM ファイルの内容のコピーを含むフォルダーをポイントする必要があります。

8.  [ **インストール**] をクリックすると、インストール **の進行状況ページに** 、インストールの進行状況、結果、メッセージ (警告、エラー、インストールした役割または機能に必要なインストール後の構成手順など) が表示されます。 Windows server 2012 以降のリリースの Windows Server では、インストールの進行中に役割と機能の追加ウィザードを閉じて、サーバーマネージャーコンソールの上部にある [ **通知** ] 領域でインストールの結果や他のメッセージを確認できます。 クリックして、 **通知** フラグ アイコンをインストールや、サーバー マネージャーを実行している他のタスクに関する詳細を参照してください。

## <a name="install-roles-role-services-and-features-by-using-windows-powershell-cmdlets"></a>Windows PowerShell コマンドレットを使用して役割、役割サービス、および機能をインストールする
Windows PowerShell のサーバーマネージャー展開コマンドレットは、GUI ベースの役割と機能の追加ウィザードおよび役割と機能の削除ウィザードと同様に機能しますが、重要な違いがあります。 Windows PowerShell では、役割と機能の追加ウィザードとは異なり、既定では、役割の管理ツールとスナップインは含まれません。 役割のインストールの一環として管理ツールを含めるには、 `IncludeManagementTools` パラメーターをコマンドレットに追加します。 Windows Server 2012 またはそれ以降のリリースの Server Core インストール オプションを実行しているサーバーの役割と機能をインストールする場合、インストールに役割の管理ツールを追加することができますが、GUI ベースの管理ツールとスナップインを Windows Server の Server Core インストール オプションを実行しているサーバーにインストールすることはできません。 唯一のコマンドライン管理ツールの Windows PowerShell は Server Core インストール オプションにインストールすることができます。

#### <a name="to-install-roles-and-features-by-using-the-install-windowsfeature-cmdlet"></a>Install-WindowsFeature コマンドレットを使用して役割と機能をインストールするには

1. 次のいずれかを実行して、管理者特権を使って Windows PowerShell セッションを開きます。

   > [!NOTE]
   > リモート サーバー上の役割と機能をインストールする場合は、管理者特権で Windows PowerShell を実行する必要はありません。

   -   Windows デスクトップで、タスク バーの **[Windows PowerShell]** を右クリックし、**[管理者として実行]** をクリックします。

   -   Windows の **開始** 画面、Windows PowerShell のタイルを右クリックし、アプリ バーをクリックして **管理者として実行**します。

2. ローカル サーバーにインストール済みの利用可能な役割と機能の一覧を表示するには、「**Get-WindowsFeature**」と入力し、**Enter** キーを押します。 ローカルコンピューターがサーバーでない場合、またはリモートサーバーに関する情報が必要な場合は、 **<** <em>computer_name</em>を実行します。この場合、 **>** *computer_name*は、Windows server 2016 を実行しているリモートコンピューターの名前を表します。 コマンドレットの結果には、手順 4. でコマンドレットに追加される役割と機能のコマンド名が含まれています。

   > [!NOTE]
   > Windows PowerShell 3.0 および Windows PowerShell の今後のリリースでは、モジュールの一部であるコマンドレットを実行する前に Windows PowerShell セッションにサーバー マネージャー コマンドレット モジュールをインポートする必要はありません。 モジュールは、モジュールに含まれるコマンドレットを初めて実行するときに自動的にインポートされます。 また、Windows PowerShell コマンドレットでも、コマンドレットで使用される機能名は大文字小文字を区別します。

3. 「 **Get-help Install-add-windowsfeature**」と入力し、 **enter** キーを押して、コマンドレットの構文と受け入れられたパラメーターを表示し `Install-WindowsFeature` ます。

4. 次のように入力し、 **enter キーを**押します。 *feature_name* は、(手順2で取得した) インストールする役割または機能のコマンド名を表します。 *computer_name* は、役割と機能をインストールするリモートコンピューターを表します。 *feature_name* に複数の値を指定する場合は、コンマで区切ります。 `Restart` パラメーターによって、対象サーバーが自動的に再起動されます (役割または機能のインストールで必要な場合)。

   ```
   Install-WindowsFeature -Name <feature_name> -computerName <computer_name> -Restart
   ```

   オフライン VHD に役割や機能をインストールするには、 `computerName` パラメーターと `VHD` パラメーターの両方を追加する必要があります。 `computerName` パラメーターを追加しない場合、コマンドレットでは、VHD にアクセスするためにローカル コンピューターがマウントされていると想定されます。 `computerName` パラメーターには VHD のマウント先のサーバー名が格納され、 `VHD` パラメーターには指定したサーバー上の VHD ファイルへのパスが格納されます。

   > [!NOTE]
   > 追加する必要があります、 `computerName` パラメーター コマンドレットを実行する、コンピューターからいる場合は、Windows クライアント オペレーティング システムを実行しています。
   >
   > オフライン VHD に役割や機能をインストールするには、対象 VHD が次の要件を満たしている必要があります。
   >
   > -   Vhd では、実行しているサーバー マネージャーのバージョンに対応する Windows Server のリリースが実行されている必要があります。 役割 [と機能の追加ウィザードを使用した役割、役割サービス、および機能のインストール](#install-roles-role-services-and-features-by-using-the-add-roles-and-features-wizard)の開始に関するメモを参照してください。
   > -   VHD に複数のシステム ボリュームまたはパーティションが存在することはできません。
   > -   VHD ファイルが格納されているネットワーク共有フォルダーについては、VHD のマウント先に選択したサーバーのコンピューター アカウント (またはローカル システム アカウント) に、次のアクセス許可を付与する必要があります。 ユーザー専用のアカウントにアクセス許可を与えるだけでは不十分です。 ネットワーク共有では、**読み取り**アクセス許可と**書き込み**アクセス許可を **Everyone** グループに付与し、VHD へのアクセスを許可することができますが、セキュリティ上の理由からこの方法はお勧めしません。
   >
   >     -   **[ファイルの共有]** ダイアログ ボックスの **[読み取り/書き込み]** アクセス
   >     -   **フル コントロール** 上のアクセス、 **セキュリティ** ] タブ、ファイルまたはフォルダー **プロパティ** ] ダイアログ ボックス。

   ```
   Install-WindowsFeature -Name <feature_name> -VHD <path> -computerName <computer_name> -Restart
   ```

   **例:** 次のコマンドレットは、active directory ドメインサービスの役割とグループポリシーの管理機能をリモートサーバー ContosoDC1 にインストールします。 `IncludeManagementTools` パラメーターを使用して管理ツールとスナップインが追加され、インストールでサーバーの再起動が必要な場合、対象サーバーは自動的に再起動します。

   ```
   Install-WindowsFeature -Name AD-Domain-Services,GPMC -computerName ContosoDC1 -IncludeManagementTools -Restart
   ```

5. インストールが完了したら、インストールの確認を開いて、 **のすべてのサーバー** サーバー マネージャーで、役割と機能をインストールしたサーバーの選択と表示] ページ、 **役割と機能の** タイルを選択したサーバーのページです。 また、 `Get-WindowsFeature` 選択したサーバー (get-help-computerName <*computer_name*>) を対象としたコマンドレットを実行して、サーバーにインストールされている役割と機能の一覧を表示することもできます。

## <a name="remove-roles-role-services-and-features-by-using-the-remove-roles-and-features-wizard"></a>役割と機能の削除ウィザードを使用して役割、役割サービス、および機能を削除する
役割、役割サービス、および機能をアンインストールするために管理者は、サーバーにログオンする必要があります。 アンインストール ターゲット サーバーに対する管理者権限のないアカウントでローカル コンピューターにログオンしている場合は、**[サーバー]** タイルでターゲット サーバーを右クリックし、**[管理に使用する資格情報]** をクリックして、管理者権限を持つアカウントを指定します。 オフライン VHD のマウント先のサーバーをサーバー マネージャーに追加する必要があります。さらに、マウント先のサーバーの管理者権限が必要です。

#### <a name="to-remove-roles-and-features-by-using-the-remove-roles-and-features-wizard"></a>役割と機能の削除ウィザードを使用して役割と機能を削除するには

1.  サーバー マネージャーを既に開いている場合は、次の手順に進んでください。 サーバー マネージャーをまだ開いていない場合は、次のいずれかの方法で開きます。

    -   Windows デスクトップで、Windows タスク バーの **[サーバー マネージャー]** をクリックし、サーバー マネージャーを開始します。

    -   Windows の**スタート**画面で、**[サーバー マネージャー]** タイルをクリックします。

2.  **[管理]** メニューの **[役割と機能の削除]** をクリックします。

3.  **[開始する前に]** ページで、サーバーから役割または機能を削除する準備が整っていることを確認します。 **[次へ]** をクリックします。

4.  [ **対象サーバーの選択** ] ページで、サーバープールからサーバーを選択するか、オフライン VHD を選択します。 オフライン VHD を選択するには、最初に VHD マウント先のサーバーを選択してから、VHD ファイルを選択します。

    > [!NOTE]
    > VHD ファイルが格納されているネットワーク共有フォルダーについては、VHD のマウント先に選択したサーバーのコンピューター アカウント (またはローカル システム アカウント) に、次のアクセス許可を付与する必要があります。 ユーザー専用のアカウントにアクセス許可を与えるだけでは不十分です。 ネットワーク共有では、**読み取り**アクセス許可と**書き込み**アクセス許可を **Everyone** グループに付与し、VHD へのアクセスを許可することができますが、セキュリティ上の理由からこの方法はお勧めしません。
    >
    > -   **[ファイルの共有]** ダイアログ ボックスの **[読み取り/書き込み]** アクセス
    > -   ファイルまたはフォルダーの **[プロパティ]** ダイアログ ボックスにある **[セキュリティ]** タブの **[フル コントロール]** アクセス

    サーバーをサーバープールに追加する方法の詳細については、「 [サーバーマネージャーへのサーバーの追加](add-servers-to-server-manager.md)」を参照してください。 対象サーバーを選択したら、**[次へ]** をクリックします。

    > [!NOTE]
    > 役割と機能の削除ウィザードを使用して、使用しているバージョンのサーバーマネージャーをサポートする Windows Server の同じリリースを実行しているサーバーから役割と機能を削除できます。 Windows server 2012 R2、Windows Server 2012、または Windows 8 でサーバーマネージャーを実行している場合は、Windows Server 2016 を実行しているサーバーから役割、役割サービス、または機能を削除することはできません。 役割と機能の削除ウィザードを使用して、Windows Server 2008 または Windows Server 2008 R2 を実行しているサーバーから役割と機能を削除することはできません。

5.  役割を選択して、役割の役割サービス (該当する場合) を選択し、**[次へ]** をクリックして機能を選択します。

    続行すると、役割と機能の削除ウィザードでは、役割、役割サービス、または削除する役割または機能がないと実行できない機能を削除するように自動的に求められます。

    さらに、移行先サーバー上の役割の管理ツールとスナップインを削除することもできます。 既定では、役割と機能の削除ウィザードでは、管理ツールが削除対象として選択されています。 選択したサーバーを使って、他のリモート サーバーで役割を管理する場合は、管理ツールとスナップインを削除せずに残しておくことができます。

6.  **[削除オプションの確認]** ページで、選択されている役割、機能、およびサーバーを確認します。 役割または機能を削除する準備ができたら、[ **削除**] をクリックします。

7.  [ **削除**] をクリックすると、[削除の **進行状況** ] ページに、削除の進行状況、結果、メッセージ (警告、エラー、または移行先サーバーの再起動など、必要な削除後の構成手順など) が表示されます。 Windows server 2012 以降のリリースの Windows Server では、削除の実行中に役割と機能の削除ウィザードを閉じても、サーバーマネージャーコンソールの上部にある [ **通知** ] 領域で削除の結果や他のメッセージを確認できます。 クリックして、 **通知** フラグを削除や、サーバー マネージャーを実行している他のタスクに関する詳細を参照してください。

## <a name="remove-roles-role-services-and-features-by-using-windows-powershell-cmdlets"></a>Windows PowerShell コマンドレットを使用して役割、役割サービス、および機能を削除する
Windows PowerShell のサーバーマネージャー展開コマンドレットは、GUI ベースの役割と機能の削除ウィザードと同様に機能しますが、重要な違いがあります。 Windows PowerShell では、役割と機能の削除ウィザードとは異なり、既定では、役割の管理ツールとスナップインは削除されません。 役割の削除の一環として管理ツールを削除するには、 `IncludeManagementTools` パラメーターをコマンドレットに追加します。 役割と Windows Server 2012 の Server Core インストール オプションまたは Windows Server、このコマンド ライン パラメーターを削除し、指定されたロールの管理ツールを Windows PowerShell の今後のリリースを実行しているサーバーからの機能をアンインストールする場合。

#### <a name="to-remove-roles-and-features-by-using-the-uninstall-windowsfeature-cmdlet"></a>Uninstall-WindowsFeature コマンドレットを使用して役割と機能を削除するには

1. 次のいずれかを実行して、管理者特権を使って Windows PowerShell セッションを開きます。

   > [!NOTE]
   > リモートサーバーから役割と機能をアンインストールする場合は、管理者特権で Windows PowerShell を実行する必要はありません。

   -   Windows デスクトップで、タスク バーの **[Windows PowerShell]** を右クリックし、**[管理者として実行]** をクリックします。

   -   Windows の **スタート** 画面で、[windows PowerShell] タイルを右クリックし、アプリバーの [ **管理者として実行**] をクリックします。

2. ローカル サーバーにインストール済みの利用可能な役割と機能の一覧を表示するには、「**Get-WindowsFeature**」と入力し、**Enter** キーを押します。 ローカルコンピューターがサーバーでない場合、またはリモートサーバーに関する情報が必要な場合は、 **<** <em>computer_name</em>を実行します。この場合、 **>** *computer_name*は、Windows server 2016 を実行しているリモートコンピューターの名前を表します。 コマンドレットの結果には、手順 4. でコマンドレットに追加される役割と機能のコマンド名が含まれています。

   > [!NOTE]
   > Windows PowerShell 3.0 および Windows PowerShell の今後のリリースでは、モジュールの一部であるコマンドレットを実行する前に Windows PowerShell セッションにサーバー マネージャー コマンドレット モジュールをインポートする必要はありません。 モジュールは、モジュールに含まれるコマンドレットを初めて実行するときに自動的にインポートされます。 また、Windows PowerShell コマンドレットでも、コマンドレットで使用される機能名は大文字小文字を区別します。

3. 「 **Get-help Uninstall-add-windowsfeature**」と入力し、 **enter** キーを押して、コマンドレットの構文と受け入れられたパラメーターを表示し `Uninstall-WindowsFeature` ます。

4. 次のコマンドを入力し、**Enter** キーを押します。*feature_name* は削除する役割や機能のコマンド名を表し (手順 2. で取得)、*computer_name* は役割と機能を削除する対象となるリモート コンピューターを表します。 *feature_name* に複数の値を指定する場合は、コンマで区切ります。 `Restart` パラメーターによって、対象サーバーが自動的に再起動されます (役割または機能の削除で必要な場合)。

   ```
   Uninstall-WindowsFeature -Name <feature_name> -computerName <computer_name> -Restart
   ```

   オフライン VHD から役割と機能を削除するには、 `computerName` パラメーターと `VHD` パラメーターの両方を追加します。 `computerName` パラメーターを追加しない場合、コマンドレットでは、VHD にアクセスするためにローカル コンピューターがマウントされていると想定されます。 `computerName` パラメーターには VHD のマウント先のサーバー名が格納され、 `VHD` パラメーターには指定したサーバー上の VHD ファイルへのパスが格納されます。

   > [!NOTE]
   > 追加する必要があります、 `computerName` パラメーター コマンドレットを実行する、コンピューターからいる場合は、Windows クライアント オペレーティング システムを実行しています。
   >
   > VHD ファイルが格納されているネットワーク共有フォルダーについては、VHD のマウント先に選択したサーバーのコンピューター アカウント (またはローカル システム アカウント) に、次のアクセス許可を付与する必要があります。 ユーザー専用のアカウントにアクセス許可を与えるだけでは不十分です。 ネットワーク共有では、**読み取り**アクセス許可と**書き込み**アクセス許可を **Everyone** グループに付与し、VHD へのアクセスを許可することができますが、セキュリティ上の理由からこの方法はお勧めしません。
   >
   > -   **[ファイルの共有]** ダイアログ ボックスの **[読み取り/書き込み]** アクセス
   > -   **フル コントロール** 上のアクセス、 **セキュリティ** ] タブ、ファイルまたはフォルダー **プロパティ** ] ダイアログ ボックス。

   ```
   Uninstall-WindowsFeature -Name <feature_name> -VHD <path> -computerName <computer_name> -Restart
   ```

   **例:** 次のコマンドレットは、active directory ドメインサービスの役割とグループポリシー管理機能をリモートサーバー ContosoDC1 から削除します。 管理ツールとスナップインも削除され、削除でサーバーの再起動が必要な場合、対象サーバーは自動的に再起動します。

   ```
   Uninstall-WindowsFeature -Name AD-Domain-Services,GPMC -computerName ContosoDC1 -IncludeManagementTools -Restart
   ```

5. 削除が完了したらを開き、役割と機能を削除することを確認、 **のすべてのサーバー** でサーバー マネージャー] ページで、役割と機能を削除したサーバーを選択し、表示、 **役割と機能の** タイルを選択したサーバーのページです。 また、 `Get-WindowsFeature` 選択したサーバー (get-help-computerName <*computer_name*>) を対象としたコマンドレットを実行して、サーバーにインストールされている役割と機能の一覧を表示することもできます。

## <a name="install-roles-and-features-on-multiple-servers-by-running-a-windows-powershell-script"></a>Windows PowerShell スクリプトを実行して複数のサーバーに役割と機能をインストールする
役割と機能の追加ウィザードを使用して、1つのウィザードセッションで複数の対象サーバーに役割、役割サービス、および機能をインストールすることはできませんが、Windows PowerShell スクリプトを使用すると、サーバーマネージャーを使用して管理している複数の対象サーバーに役割、役割サービス、および機能をインストールできます。 Batch の展開を実行するために使用するスクリプトは、このプロセスが呼び出されると、XML 構成ファイルをポイントします。このファイルは、役割と機能の追加ウィザードを使用して簡単に作成でき、役割と機能の追加ウィザードの [**インストールオプションの確認**] ページで [**構成設定のエクスポート**] をクリックすると表示されます。

> [!IMPORTANT]
> スクリプトで指定されているすべてのターゲット サーバーでは、ローカル コンピューターで実行しているサーバー マネージャーのバージョンに対応する Windows Server のリリースが実行されている必要があります。 たとえば、Windows 10 でサーバー マネージャーを実行している場合は、その Windows Server 2016 を実行しているサーバー上の役割、役割サービス、および機能をインストールできます。 GUI ベースの管理ツールをインストールに追加する場合、インストール プロセスは自動的にフル インストール オプション (またの名サーバー グラフィック シェルが実行中に完全な GUI 搭載サーバー) に Windows Server の Server Core インストール オプションを実行しているターゲット サーバーを変換します。
>
> このセクションで示されているスクリプトを使用して一括展開を実行する方法の例に示します、 `Install-WindowsFeature` コマンドレットと Windows PowerShell スクリプトです。 複数のサーバーに対して一括展開を実行するスクリプトや手段は他にも考えられます。 役割と機能を展開するための他のスクリプトを検索または提供するには、 [スクリプト センター リポジトリ](https://gallery.technet.microsoft.com/ScriptCenter)を検索してください。

#### <a name="to-install-roles-and-features-on-multiple-servers"></a>複数のサーバーに役割と機能をインストールするには

1.  されていない場合は、役割、役割サービスを含む XML 構成ファイルと複数のサーバーにインストールする機能を作成します。 この構成ファイルを作成するには、役割と機能の追加ウィザードを実行し、必要な役割、役割サービス、および機能を選択し、ウィザードの指示に従って [**インストールオプションの確認**] ページに進み、[**構成設定のエクスポート**] をクリックします。 構成ファイルを任意の場所に保存します。 構成ファイルを作成するためだけにウィザードを実行している場合は、**[インストール]** をクリックする必要も、ウィザードを完了する必要もありません。

2.  次のいずれかを実行して、管理者特権を使って Windows PowerShell セッションを開きます。

    -   Windows デスクトップで、タスク バーの **[Windows PowerShell]** を右クリックし、**[管理者として実行]** をクリックします。

    -   Windows の **スタート** 画面で、[windows PowerShell] タイルを右クリックし、アプリバーの [ **管理者として実行**] をクリックします。

3.  コピーして、Windows PowerShell セッションに、次のスクリプトを貼り付けます。

    ```
    function Invoke-WindowsFeatureBatchDeployment {
        param (
            [parameter(mandatory)]
            [string[]] $computerNames,
            [parameter(mandatory)]
            [string] $ConfigurationFilepath
        )

        # Deploy the features on multiple computers simultaneously.
        $jobs = @()
        foreach($computerName in $computerNames) {
            $jobs += start-Job -Command {
                Install-WindowsFeature -ConfigurationFilepath $using:ConfigurationFilepath -computerName $using:computerName -Restart
            }
        }

        Receive-Job -Job $jobs -Wait | select-Object Success, RestartNeeded, exitCode, FeatureResult
    }
    ```

    選択した役割または機能によって、必要であれば、ターゲット サーバーが自動的に再起動されます。

4.  次のようにして関数を実行します。

    1.  変数を作成し、ターゲット コンピューターの名前をコンマで区切って格納します。 次の例では、変数 `$ServerNames` に、ターゲット サーバー *Contoso_01* および *Contoso_02* が格納されています。 **Enter** キーを押します。

        ```
        # Sample Invocation
        $ServerNames = 'Contoso_01','Contoso_02'
        Invoke-WindowsFeatureBatchDeployment -computerNames $ServerNames -ConfigurationFilepath C:\Users\sampleuser\Desktop\DeploymentConfigTemplate.xml
        ```

    2.  関数を実行するには、次のように入力し、**Enter** キーを押します。`$ServerNames` は前の手順で作成した変数、*C:\Users\Sampleuser\Desktop\DeploymentConfigTemplate.xml* は手順 1. で作成した構成ファイルのパスです。

        **Invoke-WindowsFeatureBatchDeployment-computerNames $ServerNames-ConfigurationFilepath C:\Users\Sampleuser\Desktop\DeploymentConfigTemplate.xml**

5.  インストールが完了したら、インストールの確認を開いて、 **のすべてのサーバー** サーバー マネージャーで、役割と機能をインストールしたサーバーの選択と表示] ページ、 **役割と機能の** タイルを選択したサーバーのページです。 また、 `Get-WindowsFeature` 特定のサーバー (computer_name>) を対象としたコマンドレットを実行し `Get-WindowsFeature -computerName`  < *computer_name*て、サーバーにインストールされている役割と機能の一覧を表示することもできます。

## <a name="install-net-framework-35-and-other-features-on-demand"></a>.NET Framework 3.5 とその他の機能をオンデマンドでインストールする
Windows Server 2012 および Windows 8 以降では、.NET Framework 3.5 (.NET Framework 2.0 と .NET Framework 3.0 を含む) の機能ファイルは、既定ではローカルコンピューターで使用できません。 これらのファイルは削除されました。 "オンデマンド機能" 構成で削除された機能のファイルは、.NET Framework 3.5 の機能ファイルと共に、Windows Update から入手できます。 既定では、機能ファイルが Windows Server 2012 またはそれ以降のリリースを実行している移行先サーバーで利用できない場合、インストール プロセス検索不足しているファイルの Windows Update に接続しています。 既定の動作を上書きするには、グループポリシー設定を構成するか、インストール中に代替ソースパスを指定します。インストールする場合は、役割と機能の追加ウィザードの GUI またはコマンドラインを使用します。

.NET Framework 3.5 は、次のいずれかの方法でインストールできます。

-   「[Install-WindowsFeature コマンドレットを実行して .NET Framework 3.5 をインストールするには](#to-install-net-framework-35-by-running-the-install-windowsfeature-cmdlet)」に従って、`Source` パラメーターを追加し、.NET Framework 3.5 機能ファイルの取得元となるソースを指定します。 `Source` パラメーターを追加しない場合、インストール プロセスでは、最初に、グループ ポリシー設定で機能ファイルへのパスが指定されているかどうかを確認し、そのようなパスが見つからない場合には、Windows Update を使用して見つからない機能ファイルを検索します。

-   役割と機能の [追加ウィザードを使用して .NET Framework 3.5 をインストールするに](#to-install-net-framework-35-by-using-the-add-roles-and-features-wizard) は、役割と機能の追加ウィザードの [ **インストールオプションの確認** ] ページで代替ソースファイルの場所を指定します。

-   「[DISM を使用して .NET Framework 3.5 をインストールするには](#to-install-net-framework-35-by-using-dism)」を使用して、既定では Windows Update からファイルを取得するか、インストール メディアへのソース パスを指定します。

.NET Framework 3.5 またはその他の機能の機能ファイルがローカル コンピューターに見つからない場合は、[グループ ポリシーで機能ファイルの代替ソースを構成](#configure-alternate-sources-for-feature-files-in-group-policy)します。

> [!IMPORTANT]
> リモート ソースから機能ファイルをインストールする場合、ソース パスまたはファイル共有では、**読み取り**アクセス許可を **Everyone** グループ (セキュリティ上の理由からお勧めできません)、または対象サーバーのコンピューター アカウント (ローカル システム アカウント) のどちらかに付与する必要があります。ユーザー アカウントのアクセス許可を付与するだけでは不十分です。
>
> 外部のファイル共有に対する**読み取り**アクセス許可がワークグループ サーバーのコンピューター アカウントに割り当てられている場合でも、ワークグループ内のサーバーからは、外部の共有にアクセスすることはできません。 ワークグループ サーバーで使用できる代替ソースは、インストール メディア、Windows Update、およびローカルのワークグループ サーバーに格納されている VHD ファイルと WIM ファイルです。
>
> 実行中の物理サーバーの役割、役割サービス、および機能をインストールしている場合は、別の機能ファイルのソースとして WIM ファイルを指定できます。 WIM ファイルのソース パスは、**WIM** をプレフィックスとし、機能ファイルの位置を示すインデックスをサフィックスとして、**WIM:e:\sources\install.wim:4** という形式にする必要があります。 。 オフライン VHD に役割、役割サービス、および機能をインストールするため、ソースとして直接 WIM ファイルを使用することはできません必要がありますか、オフライン VHD をマウントしてソース ファイルのマウント パスをポイントしたか、WIM ファイルの内容のコピーを含むフォルダーをポイントする必要があります。

### <a name="to-install-net-framework-35-by-running-the-install-windowsfeature-cmdlet"></a>Install-WindowsFeature コマンドレットを実行して .NET Framework 3.5 をインストールするには

1.  次のいずれかを実行して、管理者特権を使って Windows PowerShell セッションを開きます。

    > [!NOTE]
    > リモートサーバーから役割と機能をインストールする場合は、管理者特権で Windows PowerShell を実行する必要はありません。

    -   Windows デスクトップで、タスク バーの **[Windows PowerShell]** を右クリックし、**[管理者として実行]** をクリックします。

    -   Windows の **スタート** 画面で、[windows PowerShell] タイルを右クリックし、アプリバーの [ **管理者として実行**] をクリックします。

    -   Windows Server 2012 R2 または Windows Server 2012 の Server Core インストールオプションを実行しているサーバーで、コマンドプロンプトに「 **PowerShell** 」と入力し **、enter キー**を押します。

2.  次のコマンドを入力し **、enter キーを押します。** 次の例では、ソース ファイルはドライブ D のインストール メディアのサイド バイ サイド ストア (**SxS** と略す) にあります。

    ```
    Install-WindowsFeature NET-Framework-Core -Source D:\Sources\SxS
    ```

    コマンドで Windows Update を見つからない機能ファイルのソースとして使用する場合、または既定のソースが既にグループ ポリシーを使用して構成されている場合は、別のソースを指定する必要がない限り、 `Source` パラメーターを追加する必要はありません。

### <a name="to-install-net-framework-35-by-using-the-add-roles-and-features-wizard"></a>役割と機能の追加ウィザードを使用して .NET Framework 3.5 をインストールするには

1. サーバーマネージャーの [ **管理** ] メニューで、[ **役割と機能の追加**] をクリックします。

2. Windows Server 2016 を実行している移行先サーバーを選択します。

3. 役割と機能の追加ウィザードの [ **機能の選択** ] ページで、[ **.NET Framework 3.5**] を選択します。

4. ローカル コンピューターがグループ ポリシー設定で許可している場合、インストール プロセスは Windows Update を使用して見つからない機能ファイルを取得しようとします。 **[インストール]** をクリックします。次の手順に進む必要はありません。

   グループポリシー設定によって許可されない場合、または .NET Framework 3.5 機能ファイルに別のソースを使用する場合は、ウィザードの [ **インストールオプションの確認** ] ページで、[ **代替ソースパスの指定**] をクリックします。

5. インストール メディアのサイド バイ サイド ストア (**SxS** と呼ばれています) へのパスまたは WIM ファイルへのパスを指定します。 次の例では、インストール メディアはドライブ D にあります。

   **D:\Sources\SxS\\**

   WIM ファイルを指定するには、次の例のように、**WIM:** プレフィックスを追加し、WIM ファイルで使用するイメージのインデックスをサフィックスとして追加します。

   **WIM: \\ \\ **<em>server_name</em>、**wim: 3**

6. **[OK]** をクリックし、**[インストール]** をクリックします。

### <a name="to-install-net-framework-35-by-using-dism"></a>DISM を使用して .NET Framework 3.5 をインストールするには

1.  次のいずれかを実行して、管理者特権を使って Windows PowerShell セッションを開きます。

    > [!NOTE]
    > リモートサーバーから役割と機能をインストールする場合は、管理者特権で Windows PowerShell を実行する必要はありません。

    -   Windows デスクトップで、タスク バーの **[Windows PowerShell]** を右クリックし、**[管理者として実行]** をクリックします。

    -   Windows の **開始** 画面、Windows PowerShell タイルを右クリックし、アプリ バーでクリックして **管理者として実行**します。

    -   Server Core インストールオプションを実行しているサーバーで、コマンドプロンプトに「 **PowerShell** 」と入力し、 **enter キーを**押します。

2.  次のいずれかの DISM コマンドを実行します。

    -   コンピューターが Windows Update にアクセスできる場合、または既定のソースファイルの場所が既にグループポリシーで構成されている場合は、次のコマンドを実行します。

        ```
        DISM /online /Enable-Feature /Featurename:NetFx3 /All
        ```

    -   コンピューターがインストールメディアにアクセスできる場合は、次のようなコマンドを実行します。 次の例では、オペレーティング システムのインストール メディアはドライブ D にあります。 `LimitAccess` パラメーターは、コマンドが Windows Update、または WSUS を実行しているサーバーに接続しないようにするものです。

        ```
        DISM /online /Enable-Feature /Featurename:NetFx3 /All /LimitAccess /Source:d:\sources\sxs
        ```

    > [!NOTE]
    > DISM コマンドでは大文字と小文字が区別されます。

### <a name="configure-alternate-sources-for-feature-files-in-group-policy"></a>グループ ポリシーで機能ファイルの代替ソースを構成する
このセクションで説明されているグループ ポリシー設定で、.NET Framework 3.5 ファイルの正規のソースの場所、およびオンデマンド機能の構成の一部として削除された他の機能ファイルを指定します。 [ **オプションコンポーネントのインストールおよびコンポーネントの修復の設定を指定する** ] ポリシー設定は、グループポリシー管理コンソールまたはローカルグループポリシーエディターの [ **コンピューターの構成 \ 管理用テンプレート \ システム "** ] フォルダーにあります。

> [!NOTE]
> ローカル コンピューターのグループ ポリシー設定を変更するには、Administrators グループのメンバーである必要があります。 管理対象コンピューターのグループ ポリシー設定がドメイン レベルで制御されている場合、グループ ポリシー設定を変更するには、Domain Administrators グループのメンバーである必要があります。

##### <a name="to-configure-a-default-alternate-source-path-in-group-policy"></a>グループ ポリシーで既定の代替ソース パスを構成するには

1. ローカルグループポリシーエディターまたはグループポリシー管理コンソールで、次のポリシー設定を開きます。

   **コンピューターの構成 \ 管理用テンプレート \ オプションコンポーネントのインストールおよびコンポーネントの修復の設定を指定する**

2. [有効 **] をオンにすると** 、ポリシー設定が有効になっていない場合に有効になります。

3. **[オプション]** 領域の **[代替ソース パスの指定]** ボックスに、共有フォルダーまたは WMI ファイルへの完全修飾パスを指定します。 WIM ファイルを代替ソース ファイルの場所として指定するには、パスに **WIM:** プレフィックスを追加し、WIM ファイルで使用するイメージのインデックスをサフィックスとして追加します。 指定できる値の例を次に示します。

   - 共有フォルダーへのパス: **\\\\** <em>server_name</em>**\ 共有 \\ **<em>folder_name</em>

   - wim ファイルへのパス。 **3**は、機能ファイルが存在するイメージのインデックスを表します。 **wim \\ \\ :**<em>server_name</em>、wim:**3**

4. このポリシー設定によって制御されているコンピューターが Windows Update で見つからない機能ファイルを検索しないようにする場合は、[ **Windows Update からペイロードのダウンロードを試行しない**] を選択します。

5. このポリシー設定によって制御されているコンピューターが通常、WSUS 経由で更新プログラムを受け取る場合でも、見つからない機能ファイルの検索には WSUS ではなく Windows Update を使用する場合は、**[Windows Server Update Services (WSUS) の代わりに、Windows Update に直接アクセスして修復コンテンツをダウンロードする]** を選択します。

6. このポリシー設定の変更が完了したら **[OK]** をクリックし、グループ ポリシー エディターを閉じます。

## <a name="see-also"></a>参照
[Windows Server インストールオプション](https://go.microsoft.com/fwlink/p/?LinkId=241573) 
[Microsoft .NET Framework 3.5 の展開に関する考慮事項](https://go.microsoft.com/fwlink/p/?LinkId=248869) 
[Windows の機能を有効または無効にする方法](https://go.microsoft.com/fwlink/p/?LinkId=246552)



