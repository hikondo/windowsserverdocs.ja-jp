---
title: Diskraid
description: Diskraid コマンドラインツールのリファレンス記事。独立した (または安価な) ディスク (RAID) 記憶域サブシステムの冗長配列を構成および管理できます。
ms.prod: windows-server
ms.technology: manage-windows-commands
ms.topic: article
ms.assetid: 20aef1e5-7641-47cf-b4eb-cda117f65b6e
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/16/2017
ms.openlocfilehash: d0745c708878fa9da6571666b5702b4408976164
ms.sourcegitcommit: 2afed2461574a3f53f84fc9ec28d86df3b335685
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/02/2020
ms.locfileid: "85924767"
---
# <a name="diskraid"></a>Diskraid

**Diskraid**は、独立した (または安価な) ディスク (RAID) 記憶域サブシステムの冗長配列を構成および管理できるコマンドラインツールです。

通常、RAID は、フォールトトレラントなディスクシステムを標準化して分類するためにサーバーで使用されます。 RAID のレベルには、パフォーマンス、信頼性、およびコストをさまざまに組み合わせたものがあります。 一部のサーバーは、レベル 0 (ストライピング)、レベル 1 (ミラーリング)、レベル 5 (パリティ付きストライピング) の3つの RAID レベルを提供します。

ハードウェア RAID サブシステムでは、論理ユニット番号 (LUN) を使用して、物理的にアドレス指定可能な記憶域ユニットを相互に区別します。 LUN オブジェクトは、少なくとも1つのプレックスを持つ必要があり、追加のプレックスをいくつでも持つことができます。 各プレックスには、LUN オブジェクト上のデータのコピーが含まれます。 LUN オブジェクトに対して、プレックスの追加と削除を行うことができます。

ほとんどの Diskraid コマンドは、特定のホストバスアダプター (HBA) ポート、イニシエーターアダプター、イニシエーターポータル、プロバイダー、サブシステム、コントローラー、ポート、ドライブ、LUN、ターゲットポータル、ターゲット、またはターゲットポータルグループに対して動作します。 オブジェクトを選択するには、 **select**コマンドを使用します。 選択されたオブジェクトは、フォーカスがあると言います。 フォーカスを設定すると、同じサブシステム内に複数の Lun を作成するなど、一般的な構成タスクが簡略化されます。

> [!NOTE]
> Diskraid コマンドラインツールは、仮想ディスクサービス (VDS) をサポートする記憶域サブシステムでのみ動作します。

## <a name="diskraid-commands"></a>Diskraid コマンド

次のコマンドは、Diskraid ツール内から使用できます。

### <a name="add"></a>add

現在選択されている LUN に既存の LUN を追加します。または、現在選択されている iSCSI ターゲットポータルグループに iSCSI ターゲットポータルを追加します。

#### <a name="syntax"></a>構文

```
add plex lun=n [noerr]
add tpgroup tportal=n [noerr]
```

##### <a name="parameters"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| プレックス lun =`<n>` | 現在選択されている LUN にプレックスとして追加する LUN 番号を指定します。 注意: プレックスとして追加されている LUN 上のすべてのデータが削除されます。 |
| tpgroup tportal =`<n>` | 現在選択されている iSCSI ターゲットポータルグループに追加する iSCSI ターゲットポータルの番号を指定します。 |
| noerr | スクリプト専用です。 エラーが発生すると、エラーが発生しなかったかのように、Diskraid はコマンドの処理を続行します。 |

### <a name="associate"></a>組み合わせる

現在選択されている LUN に対して指定されたコントローラーポートの一覧をアクティブとして設定します (他のコントローラーポートは非アクティブになります)。または、指定されたコントローラーポートを現在選択されている lun の既存のアクティブコントローラーポートの一覧に追加するか、現在選択されている LUN に指定した

#### <a name="syntax"></a>構文

```
associate controllers [add] <n>[,<n> [,…]]
associate ports [add] <n-m>[,<n-m>[,…]]
associate targets [add] <n>[,<n> [,…]]
```

##### <a name="parameters"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| コントローラー | 現在選択されている LUN に関連付けられているコントローラーの一覧を追加または置き換えます。 VDS 1.0 プロバイダーでのみ使用します。 |
| ports | 現在選択されている LUN に関連付けられているコントローラーポートの一覧を追加または置換します。 VDS 1.1 プロバイダーでのみ使用します。 |
| ターゲット | 現在選択されている LUN に関連付けられている iSCSI ターゲットの一覧を追加または置換します。 VDS 1.1 プロバイダーでのみ使用します。 |
| add | **VDS 1.0 プロバイダーを使用する場合:** 指定されたコントローラーを、LUN に関連付けられている既存のコントローラーの一覧に追加します。 このパラメーターを指定しない場合、コントローラーの一覧によって、この LUN に関連付けられているコントローラーの既存の一覧が置き換えられます。<p>**VDS 1.1 プロバイダーを使用する場合:** 指定されたコントローラーポートを、LUN に関連付けられている既存のコントローラーポートの一覧に追加します。 このパラメーターが指定されていない場合、コントローラーポートの一覧によって、この LUN に関連付けられているコントローラーポートの既存の一覧が置き換えられます。 |
| `<n>[,<n> [, ...]]` | **コントローラー**または**ターゲット**のパラメーターと共に使用します。 アクティブまたは関連付けに設定するコントローラーまたは iSCSI ターゲットの番号を指定します。 |
| `<n-m>[,<n-m>[,…]]` | **Ports**パラメーターを指定してを使用します。 コントローラー番号 (*n*) とポート番号 (*m*) のペアを使用して、アクティブに設定するコントローラーポートを指定します。 |

#### <a name="example"></a>例

VDS 1.1 プロバイダーを使用する LUN にポートを関連付け、追加するには、次のようにします。

```
DISKRAID> SEL LUN 5
LUN 5 is now the selected LUN.

DISKRAID> ASSOCIATE PORTS 0-0,0-1
Controller port associations changed.
(Controller ports active after this command: Ctlr 0 Port 0, Ctlr 0 Port 1)

DISKRAID> ASSOCIATE PORTS ADD 1-1
Controller port associations changed.
(Controller ports active after this command: Ctlr 0 Port 0, Ctlr 0 Port 1, Ctlr 1 Port 1)
```

### <a name="automagic"></a>automagic

LUN の構成方法について、プロバイダーにヒントを提供するフラグを設定またはクリアします。 パラメーターを使用せずに**automagic**操作を実行すると、フラグの一覧が表示されます。

#### <a name="syntax"></a>構文

```
automagic {set | clear | apply} all <flag=value> [<flag=value> [...]]
```

##### <a name="parameters"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| set | 指定したフラグを指定した値に設定します。 |
| オフ | 指定したフラグをクリアします。 **All**キーワードは、すべての automagic フラグをクリアします。 |
| apply | 現在のフラグを選択した LUN に適用します。 |
| `<flag>` | フラグは、次のような3文字の頭字語によって識別されます。<ul><li>**Fcr** -高速クラッシュ回復が必要</li><li>**FTL** -フォールトトレラント</li><li>**MSR** -主に読み取り</li><li>**Mxd** -最大ドライブ</li><li>**Mxs** -最大サイズが必要です</li><li>**ORA** -最適な読み取りの配置</li><li>値 **-最適**な読み取りサイズ</li><li>**OSR** -順次読み取りの最適化</li><li>**Osw** -シーケンシャル書き込みの最適化</li><li> **OWA** -最適な書き込み配置</li><li>**OWS** -最適な書き込みサイズ</li><li>**Rbp** -再構築の優先順位</li><li>**Rbv** -読み取り/書き込みの確認が有効</li><li>**RMP**が有効</li><li>**STS** -ストリップサイズ</li><li>**Wtc** -ライトスルーキャッシュが有効</li><li>**/-** リムーバブル</li></ul> |

### <a name="break"></a>break

現在選択されている LUN からプレックスを削除します。 プレックスとそれに含まれるデータは保持されず、ドライブのエクステントは再利用される可能性があります。

> [!CAUTION]
> このコマンドを使用する前に、ミラー化された LUN を最初に選択する必要があります。 プレックス上のすべてのデータが削除されます。 元の LUN に含まれるすべてのデータの整合性は保証されていません。

#### <a name="syntax"></a>構文

```
break plex=<plex_number> [noerr]
```

##### <a name="parameters"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| p | 削除するプレックスの番号を指定します。 プレックスとそれに含まれるデータは保持されず、このプレックスによって使用されるリソースは回収されます。 LUN に含まれるデータの整合性は保証されていません。 このプレックスを保持する場合は、ボリュームシャドウコピーサービス (VSS) を使用します。 |
| noerr | スクリプト専用です。 エラーが発生すると、エラーが発生しなかったかのように、Diskraid はコマンドの処理を続行します。 |

### <a name="chap"></a>ms-chap

チャレンジハンドシェイク認証プロトコル (CHAP) の共有シークレットを設定して、iSCSI イニシエーターと iSCSI ターゲットが相互に通信できるようにします。

#### <a name="syntax"></a>構文

```
chap initiator set secret=[<secret>] [target=<target>]
chap initiator remember secret=[<secret>] target=<target>
chap target set secret=[<secret>] [initiator=<initiatorname>]
chap target remember secret=[<secret>] initiator=<initiatorname>
```

##### <a name="parameters"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| イニシエーターセット | イニシエーターがターゲットを認証するときに、相互 CHAP 認証に使用されるローカル iSCSI イニシエーターサービスの共有シークレットを設定します。 |
| イニシエーターの記憶 | は、iSCSI ターゲットの CHAP シークレットをローカル iSCSI イニシエーターサービスに伝えます。これにより、イニシエーターサービスは、CHAP 認証時にターゲットに対して自身を認証するためにシークレットを使用できるようになります。 |
| ターゲットセット | ターゲットがイニシエーターを認証するときに、CHAP 認証に使用される現在選択されている iSCSI ターゲットに共有シークレットを設定します。 |
| ターゲットを記憶する | ISCSI イニシエーターの CHAP シークレットを現在のフォーカスがある iSCSI ターゲットに伝達します。これにより、ターゲットは、相互 CHAP 認証中にイニシエーターに対して自身を認証するためにシークレットを使用できるようになります。 |
| secret | 使用するシークレットを指定します。 空の場合、シークレットはクリアされます。 |
| ターゲット (target) | 現在選択されているサブシステムで、シークレットに関連付けるターゲットを指定します。 これは、イニシエーターでシークレットを設定し、そのままにしておくと、シークレットが関連付けられていないすべてのターゲットに使用されることを示しています。 |
| initiatorname | シークレットに関連付けるイニシエーター iSCSI 名を指定します。 これはオプションです。ターゲットでシークレットを設定し、そのままにしておくと、シークレットが関連付けられていないすべてのイニシエーターに対してシークレットが使用されることを示します。 |

### <a name="create"></a>create

現在選択されているサブシステムに新しい LUN または iSCSI ターゲットを作成するか、現在選択されているターゲットに対してターゲットポータルグループを作成します。 実際のバインドは、 **Diskraid リスト**コマンドを使用して表示できます。

#### <a name="syntax"></a>構文

```
create lun simple [size=<n>] [drives=<n>] [noerr]
create lun stripe [size=<n>] [drives=<n, n> [,...]]  [stripesize=<n>] [noerr]
create lun raid [size=<n>] [drives=<n, n> [,...]] [stripesize=<n>] [noerr]
create lun mirror [size=<n>] [drives=<n, n> [,...]] [stripesize=<n>] [noerr]
create lun automagic size=<n> [noerr]
create target name=<name> [iscsiname=<iscsiname>] [noerr]
create tpgroup [noerr]
```

##### <a name="parameters"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| simple | 単純な LUN を作成します。 |
| ストライプ (stripe) | ストライプ LUN を作成します。 |
| raid-z | パリティ付きストライプ LUN を作成します。 |
| mirror | ミラー化された LUN を作成します。 |
| automagic | 現在有効になっている*automagic*ヒントを使用して LUN を作成します。 詳細については、この記事の**automagic**サブコマンドを参照してください。 |
| size= | LUN の合計サイズをメガバイト単位で指定します。 **Size**= または**drive = パラメーターのどちら**かを指定する必要があります。 同時に使用することもできます。 **Size =** パラメーターが指定されていない場合、作成される LUN は、指定されたすべてのドライブで許可される最大サイズになります。<p>通常、プロバイダーは要求されたサイズと同じ大きさの LUN を作成しますが、プロバイダーは次の最大サイズに切り上げなければならない場合があります。 たとえば、size が 99 GB として指定され、プロバイダーが割り当てることができるのが GB のディスクエクステントのみである場合、結果として得られる LUN は 1 GB になります。 他の単位を使用してサイズを指定するには、サイズの直後に次のいずれかのサフィックスを使用します。<ul><li>**B**バイト</li><li>**Kb kb**</li><li>**Mb** -メガバイト</li><li>**Gb** -ギガバイト</li><li>**Tb** -テラバイト</li><li>**Pb** ~ ペタバイト。</li></ul> |
| ドライブ = | LUN の作成に使用するドライブの*drive_number*を指定します。 **Size**= または**drive = パラメーターのどちら**かを指定する必要があります。 同時に使用することもできます。 **Size =** パラメーターが指定されていない場合、作成される LUN は、指定されたすべてのドライブで許可される最大サイズになります。 **Size =** パラメーターが指定されている場合、プロバイダーは指定されたドライブ一覧からドライブを選択して LUN を作成します。 プロバイダーは、可能な場合は、指定された順序でドライブを使用しようとします。 |
| stripesize = | *ストライプ*または*raid* LUN のサイズを mb 単位で指定します。 LUN の作成後に stripesize を変更することはできません。 他の単位を使用してサイズを指定するには、サイズの直後に次のいずれかのサフィックスを使用します。<ul><li>**B**バイト</li><li>**Kb kb**</li><li>**Mb** -メガバイト</li><li>**Gb** -ギガバイト</li><li>**Tb** -テラバイト</li><li>**Pb** ~ ペタバイト。</li></ul> |
| ターゲット (target) | 現在選択されているサブシステムに新しい iSCSI ターゲットを作成します。 |
| name | ターゲットのフレンドリ名を提供します。 |
| iscsiname | ターゲットの iSCSI 名を指定します。プロバイダーによって名前が生成されるように、省略することもできます。 |
| tpgroup | 現在選択されているターゲットに新しい iSCSI ターゲットポータルグループを作成します。 |
| noerr | スクリプト専用です。 エラーが発生すると、エラーが発生しなかったかのように、Diskraid はコマンドの処理を続行します。 |

### <a name="delete"></a>delete

現在選択されている LUN、iscsi ターゲット (iSCSI ターゲットに関連付けられている Lun がない場合)、または iSCSI ターゲットポータルグループを削除します。

#### <a name="syntax"></a>構文

```
delete lun [uninstall] [noerr]
delete target [noerr]
delete tpgroup [noerr]
```

##### <a name="parameters"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| lun | 現在選択されている LUN とすべてのデータを削除します。 |
| uninstall | Lun が削除される前に、LUN に関連付けられているローカルシステム上のディスクをクリーンアップすることを指定します。 |
| ターゲット (target) | ターゲットに関連付けられている Lun がない場合は、現在選択されている iSCSI ターゲットを削除します。 |
| tpgroup | 現在選択されている iSCSI ターゲットポータルグループを削除します。 |
| noerr | スクリプト専用です。 エラーが発生すると、エラーが発生しなかったかのように、Diskraid はコマンドの処理を続行します。 |

### <a name="detail"></a>詳細

指定された種類の現在選択されているオブジェクトに関する詳細情報を表示します。

#### <a name="syntax"></a>構文

```
detail {hbaport | iadapter | iportal | provider | subsystem | controller | port | drive | lun | tportal | target | tpgroup} [verbose]
```

##### <a name="parameters"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| hbaport | 現在選択されているホストバスアダプター (HBA) ポートに関する詳細情報を一覧表示します。 |
| iadapter | 現在選択されている iSCSI イニシエーターアダプターに関する詳細情報を一覧表示します。 |
| iportal | 現在選択されている iSCSI イニシエーターポータルに関する詳細情報を一覧表示します。 |
| provider | 現在選択されているプロバイダーに関する詳細情報を一覧表示します。 |
| subsystem | 現在選択されているサブシステムに関する詳細情報を一覧表示します。 |
| コントローラー | 現在選択されているコントローラーに関する詳細情報を一覧表示します。 |
| port | 現在選択されているコントローラーポートに関する詳細情報を一覧表示します。 |
| ドライブ | 現在選択されているドライブに関する詳細情報を一覧表示します (Lun の占有を含む)。 |
| lun | 現在選択されている LUN に関する詳細情報を一覧表示、影響を与えるドライブを含みます。 この出力は、LUN がファイバーチャネルまたは iSCSI サブシステムの一部であるかどうかによって若干異なります。 マスクされていないホストの一覧にアスタリスクしか含まれていない場合は、LUN がすべてのホストに対してマスク解除されることを意味します。 |
| portal 新規 | 現在選択されている iSCSI ターゲットポータルに関する詳細情報を一覧表示します。 |
| ターゲット (target) | 現在選択されている iSCSI ターゲットに関する詳細情報を一覧表示します。 |
| tpgroup | 現在選択されている iSCSI ターゲットポータルグループに関する詳細情報を一覧表示します。 |
| verbose | LUN パラメーターでのみ使用します。 プレックスを含む追加情報を一覧表示します。 |

### <a name="dissociate"></a>解除

現在選択されている LUN に対して、指定されたコントローラーポートの一覧を非アクティブとして設定します (他のコントローラーポートは影響を受けません)。または、現在選択されている LUN の iSCSI ターゲットの指定リストを解除します。

#### <a name="syntax"></a>Syntax

```
dissociate controllers <n> [,<n> [,...]]
dissociate ports <n-m>[,<n-m>[,…]]
dissociate targets <n> [,<n> [,…]]
```

##### <a name="parameter"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| controllers | 現在選択されている LUN に関連付けられているコントローラーの一覧からコントローラーを削除します。 VDS 1.0 プロバイダーでのみ使用します。 |
| ports | 現在選択されている LUN に関連付けられているコントローラーポートの一覧からコントローラーポートを削除します。 VDS 1.1 プロバイダーでのみ使用します。 |
| ターゲット | 現在選択されている LUN に関連付けられている iSCSI ターゲットの一覧からターゲットを削除します。 VDS 1.1 プロバイダーでのみ使用します。 |
| `<n> [,<n> [,…]]` | **Controller**または**targets**パラメーターと共に使用します。 非アクティブまたは関連付け解除として設定するコントローラーまたは iSCSI ターゲットの番号を指定します。 |
| `<n-m>[,<n-m>[,…]]` | **Ports**パラメーターと共に使用します。 コントローラー番号 (*n*) とポート番号 (*m*) のペアを使用して、非アクティブとして設定するコントローラーポートを指定します。 |

#### <a name="example"></a>例

```
DISKRAID> SEL LUN 5
LUN 5 is now the selected LUN.

DISKRAID> ASSOCIATE PORTS 0-0,0-1
Controller port associations changed.
(Controller ports active after this command: Ctlr 0 Port 0, Ctlr 0 Port 1)

DISKRAID> ASSOCIATE PORTS ADD 1-1
Controller port associations changed.
(Controller ports active after this command: Ctlr 0 Port 0, Ctlr 0 Port 1, Ctlr 1 Port 1)

DISKRAID> DISSOCIATE PORTS 0-0,1-1
Controller port associations changed.
(Controller ports active after this command: Ctlr 0 Port 1)
```

### <a name="exit"></a>exit

Diskraid を終了します。

#### <a name="syntax"></a>Syntax

```
exit
```

### <a name="extend"></a>extend

LUN の最後にセクターを追加して、現在選択されている LUN を拡張します。 すべてのプロバイダーが Lun の拡張をサポートするわけではありません。 は、LUN に含まれるボリュームまたはファイルシステムを拡張しません。 LUN を拡張した後、 **DiskPart の拡張**コマンドを使用して、関連付けられているディスク上の構造体を拡張する必要があります。

#### <a name="syntax"></a>構文

```
extend lun [size=<LUN_size>] [drives=<drive_number>, [<drive_number>, ...]] [noerr]
```

##### <a name="parameters"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| size | LUN を拡張するメガバイト単位のサイズを指定します。 *サイズ*またはパラメーターのいずれかを `<drive>` 指定する必要があります。 同時に使用することもできます。 **Size =** パラメーターが指定されていない場合、LUN は、指定されたすべてのドライブで許可される最大サイズによって拡張されます。 **Size =** パラメーターが指定されている場合、プロバイダーは、 **drives =** パラメーターによって指定された一覧からドライブを選択して LUN を作成します。 他の単位を使用してサイズを指定するには、サイズの直後に次のいずれかのサフィックスを使用します。<ul><li>**B**バイト</li><li>**Kb kb**</li><li>**Mb** -メガバイト</li><li>**Gb** -ギガバイト</li><li>**Tb** -テラバイト</li><li>**Pb** ~ ペタバイト。</li></ul> |
| ドライブ = | `<drive_number>`LUN を作成するときに使用するドライブのを指定します。 *サイズ*またはパラメーターのいずれかを `<drive>` 指定する必要があります。 同時に使用することもできます。 **Size =** パラメーターが指定されていない場合、作成される LUN は、指定されたすべてのドライブで許可される最大サイズになります。 プロバイダーは、可能であれば指定された順序でドライブを使用します。 |
| noerr | スクリプト専用です。 エラーが発生すると、エラーが発生しなかったかのように、Diskraid はコマンドの処理を続行します。 |

### <a name="flushcache"></a>flushcache

現在選択されているコントローラーのキャッシュを消去します。

#### <a name="syntax"></a>Syntax

```
flushcache controller
```

### <a name="help"></a>help

すべての Diskraid コマンドの一覧を表示します。

#### <a name="syntax"></a>Syntax

```
help
```

### <a name="importtarget"></a>importtarget

現在選択されているサブシステムに対して設定されている現在のボリュームシャドウコピーサービス (VSS) インポートターゲットを取得または設定します。

#### <a name="syntax"></a>Syntax

```
importtarget subsystem [set target]
```

##### <a name="parameter"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| ターゲットの設定 | 指定した場合、現在選択されているターゲットを、現在選択されているサブシステムの VSS インポートターゲットに設定します。 指定しない場合、コマンドは現在選択されているサブシステムに対して設定されている現在の VSS インポートターゲットを取得します。 |

### <a name="initiator"></a>initiator

ローカル iSCSI イニシエーターに関する情報を取得します。

#### <a name="syntax"></a>Syntax

```
initiator
```

### <a name="invalidatecache"></a>invalidatecache

現在選択されているコントローラーのキャッシュを無効にします。

#### <a name="syntax"></a>Syntax

```
invalidatecache controller
```

### <a name="lbpolicy"></a>lbpolicy

現在選択されている LUN の負荷分散ポリシーを設定します。

#### <a name="syntax"></a>構文

```
lbpolicy set lun type=<type> [paths=<path>-{primary | <weight>}[,<path>-{primary | <weight>}[,…]]]
lbpolicy set lun paths=<path>-{primary | <weight>}[,<path>-{primary | <weight>}[,…]]
```

##### <a name="parameters"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| type | 負荷分散ポリシーを指定します。 型が指定されていない場合は、 **path**パラメーターを指定する必要があります。 Type は次のいずれかになります。<ul><li>**フェールオーバー** -バックアップパスとして、他のパスとの1つのプライマリパスを使用します。</li><li>[イン**ビンの丸め**]-ラウンドロビン方式のすべてのパスを使用して、各パスを順番に試行します。</li><li>**SUBSETROUNDROBIN** -すべてのプライマリパスをラウンドロビン方式で使用します。バックアップパスは、すべてのプライマリパスで障害が発生した場合にのみ使用されます。</li><li>**Dynlqd** -アクティブな要求の数が最も少ないパスを使用します。<li><li>**重み付け**-最も低い重みのパスを使用します (各パスに重み付けを割り当てる必要があります)。</li><li>最小**stblock** -ブロックが最も少ないパスを使用します。</li><li>**VENDORSPECIFIC** -ベンダー固有のポリシーを使用します。</li></ul> |
| パス | パスが**プライマリ**であるか、または特定のを持つかを指定し `<weight>` ます。 指定されていないパスは、暗黙的にバックアップとして設定されます。 一覧に表示されているパスは、現在選択されている LUN のパスのいずれかである必要があります。 |

### <a name="list"></a>list

指定した種類のオブジェクトの一覧を表示します。

#### <a name="syntax"></a>構文

```
list {hbaports | iadapters | iportals | providers | subsystems | controllers | ports | drives | LUNs | tportals | targets | tpgroups}
```

##### <a name="parameters"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| hbaports | VDS に認識されているすべての HBA ポートに関する概要情報を一覧表示します。 現在選択されている HBA ポートは、アスタリスク (*) でマークされています。 |
| iadapters | VDS に認識されているすべての iSCSI イニシエーターアダプターに関する概要情報を一覧表示します。 現在選択されているイニシエーターアダプターは、アスタリスク (*) でマークされます。 |
| iportals | 現在選択されているイニシエーターアダプターのすべての iSCSI イニシエーターポータルに関する概要情報を一覧表示します。 現在選択されているイニシエーターポータルには、アスタリスク (*) が付いています。 |
| providers | VDS に認識されている各プロバイダーに関する概要情報を一覧表示します。 現在選択されているプロバイダーは、アスタリスク (*) でマークされています。 |
| システム | システム内の各サブシステムに関する概要情報を一覧表示します。 現在選択されているサブシステムには、アスタリスク (*) が付いています。 |
| controllers | 現在選択されているサブシステム内の各コントローラーに関する概要情報を一覧表示します。 現在選択されているコントローラーは、アスタリスク (*) でマークされています。 |
| ports | 現在選択されているコントローラーの各コントローラーポートに関する概要情報を一覧表示します。 現在選択されているポートは、アスタリスク (*) でマークされています。 |
| ドライブ | 現在選択されているサブシステムの各ドライブに関する概要情報を一覧表示します。 現在選択されているドライブは、アスタリスク (*) でマークされています。 |
| lun | 現在選択されているサブシステム内の各 LUN に関する概要情報を一覧表示します。 現在選択されている LUN は、アスタリスク (*) でマークされています。 |
| tportals | 現在選択されているサブシステム内のすべての iSCSI ターゲットポータルに関する概要情報を一覧表示します。 現在選択されているターゲットポータルは、アスタリスク (*) でマークされています。 |
| ターゲット | 現在選択されているサブシステム内のすべての iSCSI ターゲットに関する概要情報を一覧表示します。 現在選択されているターゲットには、アスタリスク (*) が付いています。 |
| tpgroups | 現在選択されているターゲット内のすべての iSCSI ターゲットポータルグループに関する概要情報を一覧表示します。 現在選択されているポータルグループには、アスタリスク (*) が付いています。 |

### <a name="login"></a>ログイン (login)

指定した iSCSI イニシエーターアダプターを現在選択されている iSCSI ターゲットにログに記録します。

#### <a name="syntax"></a>構文

```
login target iadapter=<iadapter> [type={manual | persistent | boot}] [chap={none | oneway | mutual}] [iportal=<iportal>] [tportal=<tportal>] [<flag> [<flag> […]]]
```

##### <a name="parameters"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| type | 実行するログインの種類を指定します。**手動**または**永続的**です。 指定しない場合は、手動ログインが実行されます。 |
| manual | 手動でログインします。 今後の開発を目的とした**ブート**オプションもありますが、現在は使用されていません。 |
| 一貫 | コンピューターを再起動するときに、同じログインを自動的に使用します。 |
| ms-chap | 使用する CHAP 認証の種類として、 **none**、 **oneway** chap、または**相互**chap を指定します。指定されていない場合、認証は使用されません。 |
| portal 新規 | 現在選択されているサブシステムで、ログインに使用するオプションのターゲットポータルを指定します。 |
| iportal | 指定したイニシエーターアダプターで、ログインに使用するオプションのイニシエーターポータルを指定します。 |
| `<flag>` | 3文字の頭字語によって識別されます。<ul><li>**Ip** -IPsec が必要</li><li>**EMP** -マルチパスを有効にする</li><li>**Ehd** -ヘッダーダイジェストの有効化</li><li>**EDD** -データダイジェストを有効にする</li></ul> |

### <a name="logout"></a>logout

現在選択されている iSCSI ターゲットから指定された iSCSI イニシエーターアダプターをログに記録します。

#### <a name="syntax"></a>構文

```
logout target iadapter= <iadapter>
```

##### <a name="parameters"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| iadapter | ログアウトするログインセッションがあるイニシエーターアダプターを指定します。 |

### <a name="maintenance"></a>メンテナンス

指定された型の現在選択されているオブジェクトに対してメンテナンス操作を実行します。

#### <a name="syntax"></a>構文

```
maintenance <object operation> [count=<iteration>]
```

##### <a name="parameters"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| `<object>` | 操作を実行するオブジェクトの種類を指定します。 *オブジェクト*の種類には、**サブシステム**、**コントローラー**、**ポート、ドライブ、** または**LUN**を指定できます。 |
| `<operation>` | 実行するメンテナンス操作を指定します。 *操作*の種類には、 **spinup**、 **spindown**、**点滅**、**ビープ音**、または**ping**を使用できます。 *操作*を指定してください。 |
| カウント = | *操作*を繰り返す回数を指定します。 これは通常、**点滅**、**ビープ音**、または**ping**と共に使用されます。 |

### <a name="name"></a>name

現在選択されているサブシステム、LUN、または iSCSI ターゲットのフレンドリ名を指定した名前に設定します。

#### <a name="syntax"></a>Syntax

```
name {subsystem | lun | target} [<name>]
```

##### <a name="parameter"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| `<name>` | サブシステム、LUN、またはターゲットの名前を指定します。 名前の長さは64文字未満でなければなりません。 名前が指定されていない場合は、既存の名前 (存在する場合) が削除されます。 |

### <a name="offline"></a>offline

指定された種類の現在選択されているオブジェクトの状態を**オフライン**に設定します。

#### <a name="syntax"></a>Syntax

```
offline <object>
```

##### <a name="parameter"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| `<object>` | この操作を実行するオブジェクトの種類を指定します。 種類は、**サブシステム**、**コントローラー**、**ドライブ**、 **LUN**、または**portal 新規**です。 |

### <a name="online"></a>オンライン

指定された種類の選択されたオブジェクトの状態を**オンライン**に設定します。 オブジェクトが**hbaport**の場合、は、現在選択されている HBA ポートへのパスの状態を**オンライン**に変更します。

#### <a name="syntax"></a>Syntax

```
online <object>
```

##### <a name="parameter"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| `<object>` | この操作を実行するオブジェクトの種類を指定します。 種類は、 **hbaport**、 **subsystem**、 **controller**、 **drive**、 **LUN**、または**portal 新規**です。 |

### <a name="recover"></a>recover

現在選択されているフォールトトレラント LUN を修復するために必要な操作 (再同期やホットスペア処理など) を実行します。 たとえば、回復によって、障害が発生したディスクまたはその他のディスクエクステントの再割り当てがある RAID セットにホットスペアがバインドされる場合があります。

#### <a name="syntax"></a>Syntax

```
recover <lun>
```

### <a name="reenumerate"></a>reenumerate

指定された型のオブジェクトを再列挙します。 [LUN の拡張] コマンドを使用する場合は、reenumerate コマンドを使用する前に、refresh コマンドを使用してディスクサイズを更新する必要があります。

#### <a name="syntax"></a>構文

```
reenumerate {subsystems | drives}
```

##### <a name="parameters"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| システム | プロバイダーに対してクエリを行って、現在選択されているプロバイダーに追加された新しいサブシステムを検出します。 |
| ドライブ | は、現在選択されているサブシステムに追加された新しいドライブを検出するために、内部 i/o バスに対してクエリを行います。 |

### <a name="refresh"></a>更新

現在選択されているプロバイダーの内部データを更新します。

#### <a name="syntax"></a>Syntax

```
refresh provider
```

### <a name="rem"></a>rem

スクリプトのコメント化に使用します。

#### <a name="syntax"></a>Syntax

```
Rem <comment>
```

### <a name="remove"></a>remove

現在選択されているターゲットポータルグループから、指定された iSCSI ターゲットポータルを削除します。

#### <a name="syntax"></a>Syntax

```
remove tpgroup tportal=<tportal> [noerr]
```

##### <a name="parameter"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| tpgroup tportal =`<tportal>` | 削除する iSCSI ターゲットポータルを指定します。 |
| noerr | スクリプト専用です。 エラーが発生すると、エラーが発生しなかったかのように、Diskraid はコマンドの処理を続行します。 |

### <a name="replace"></a>replace

指定されたドライブを現在選択されているドライブに置き換えます。 指定されたドライブは、現在選択されているドライブではない可能性があります。

#### <a name="syntax"></a>Syntax

```
replace drive=<drive_number>
```

##### <a name="parameter"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| ドライブ = | 置き換えるドライブのを指定し `<drive_number>` ます。 |

### <a name="reset"></a>reset

現在選択されているコントローラーまたはポートをリセットします。

#### <a name="syntax"></a>構文

```
reset {controller | port}
```

##### <a name="parameters"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| コントローラー | コントローラーをリセットします。 |
| port | ポートをリセットします。 |

### <a name="select"></a>select

現在選択されているオブジェクトを表示または変更します。

#### <a name="syntax"></a>構文

```
select {hbaport | iadapter | iportal | provider | subsystem | controller | port | drive | lun | tportal | target | tpgroup } [<n>]
```

##### <a name="parameters"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| object | **プロバイダー**、**サブシステム**、**コントローラー**、**ドライブ**、 **LUN**など、選択するオブジェクトの種類を指定します。 |
| hbaport`[<n>]` | 指定されたローカル HBA ポートにフォーカスを設定します。 HBA ポートが指定されていない場合、コマンドは現在選択されている HBA ポート (存在する場合) を表示します。 無効な HBA ポートインデックスを指定すると、フォーカスがある HBA ポートは表示されません。 HBA ポートを選択すると、選択したイニシエーターアダプターとイニシエーターポータルが選択解除されます。 |
| iadapter`[<n>]` | 指定したローカル iSCSI イニシエーターアダプターにフォーカスを設定します。 イニシエーターアダプターが指定されていない場合は、現在選択されているイニシエーターアダプター (存在する場合) がコマンドによって表示されます。 無効なイニシエーターアダプターのインデックスを指定すると、インフォーカスされたイニシエーターアダプターが存在しなくなります。 イニシエーターアダプターを選択すると、選択した HBA ポートとイニシエーターポータルが選択解除されます。 |
| iportal`[<n>]` | 選択した iSCSI イニシエーターアダプター内の指定したローカル iSCSI イニシエーターポータルにフォーカスを設定します。 イニシエーターポータルが指定されていない場合は、現在選択されているイニシエーターポータル (存在する場合) が表示されます。 無効なイニシエーターポータルインデックスを指定すると、選択したイニシエーターポータルが表示されなくなります。 |
| provider`[<n>]` | 指定されたプロバイダーにフォーカスを設定します。 プロバイダーが指定されていない場合は、現在選択されているプロバイダー (存在する場合) が表示されます。 無効なプロバイダーインデックスを指定すると、インフォーカスプロバイダーは存在しません。 |
| サブ`[<n>]` | 指定したサブシステムにフォーカスを設定します。 サブシステムが指定されていない場合は、フォーカスがあるサブシステムが表示されます (存在する場合)。 無効なサブシステムインデックスを指定すると、インフォーカスサブシステムがなくなります。 サブシステムを選択すると、関連するプロバイダが暗黙的に選択されます。 |
| コントロール`[<n>]` | 現在選択されているサブシステム内の指定されたコントローラーにフォーカスを設定します。 コントローラーが指定されていない場合は、現在選択されているコントローラー (存在する場合) がコマンドによって表示されます。 無効なコントローラーインデックスを指定すると、インフォーカスコントローラーがなくなります。 コントローラーを選択すると、選択したコントローラーポート、ドライブ、Lun、ターゲットポータル、ターゲット、およびターゲットポータルグループが選択解除されます。 |
| ポート`[<n>]` | 現在選択されているコントローラー内の指定されたコントローラーポートにフォーカスを設定します。 ポートが指定されていない場合は、現在選択されているポート (存在する場合) がコマンドによって表示されます。 無効なポートインデックスを指定すると、選択したポートは表示されません。 |
| 駆動`[<n>]` | 現在選択されているサブシステム内の指定されたドライブまたは物理スピンドルにフォーカスを設定します。 ドライブが指定されていない場合は、現在選択されているドライブ (存在する場合) が表示されます。 無効なドライブインデックスを指定すると、フォーカスがないドライブになります。 ドライブを選択すると、選択したコントローラー、コントローラーポート、Lun、ターゲットポータル、ターゲット、およびターゲットポータルグループの選択が解除されます。 |
| lun`[<n>]` | 現在選択されているサブシステム内の指定された LUN にフォーカスを設定します。 LUN が指定されていない場合、現在選択されている LUN (存在する場合) がコマンドによって表示されます。 無効な LUN インデックスを指定すると、LUN は選択されません。 LUN を選択すると、選択したコントローラー、コントローラーポート、ドライブ、ターゲットポータル、ターゲット、およびターゲットポータルグループが選択解除されます。 |
| portal 新規`[<n>]` | 現在選択されているサブシステム内で、指定した iSCSI ターゲットポータルにフォーカスを設定します。 ターゲットポータルが指定されていない場合は、現在選択されているターゲットポータル (存在する場合) が表示されます。 無効なターゲットポータルインデックスを指定すると、選択したターゲットポータルが表示されなくなります。 ターゲットポータルを選択すると、コントローラー、コントローラーポート、ドライブ、Lun、ターゲット、およびターゲットポータルグループの選択が解除されます。 |
| 接続`[<n>]` | 現在選択されているサブシステム内の指定された iSCSI ターゲットにフォーカスを設定します。 ターゲットが指定されていない場合は、現在選択されているターゲット (存在する場合) がコマンドによって表示されます。 無効なターゲットインデックスを指定すると、選択されたターゲットはありません。 ターゲットを選択すると、コントローラー、コントローラーポート、ドライブ、Lun、ターゲットポータル、およびターゲットポータルグループの選択が解除されます。 |
| tpgroup`[<n>]` | 現在選択されている iSCSI ターゲット内で、指定された iSCSI ターゲットポータルグループにフォーカスを設定します。 ターゲットポータルグループが指定されていない場合は、現在選択されているターゲットポータルグループ (存在する場合) がコマンドによって表示されます。 無効なターゲットポータルグループのインデックスを指定すると、対象となるターゲットポータルグループがなくなります。 |
|`[<n>]` | 選択するを指定し `<object number>` ます。 指定した `<object number>` が有効でない場合は、指定された型のオブジェクトに対する既存の選択がクリアされます。 が指定されていない場合は、 `<object number>` 現在のオブジェクトが表示されます。

### <a name="setflag"></a>setflag

現在選択されているドライブをホットスペアとして設定します。 ホットスペアは、通常の LUN バインド操作には使用できません。 これらは、エラー処理のためだけに予約されています。 現在、ドライブを既存の LUN にバインドすることはできません。

#### <a name="syntax"></a>構文

```
setflag drive hotspare={true | false}
```

##### <a name="parameters"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| true | 現在選択されているドライブをホットスペアとして選択します。 |
| false | 現在選択されているドライブをホットスペアとして選択解除します。 |

### <a name="shrink"></a>shrink

選択した LUN のサイズを小さくします。

#### <a name="syntax"></a>構文

```
shrink lun size=<n> [noerr]
```

##### <a name="parameters"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| size | LUN のサイズを小さくするために必要な領域の容量をメガバイト (MB) 単位で指定します。 他の単位を使用してサイズを指定するには、サイズの直後に次のいずれかのサフィックスを使用します。<ul><li>**B**バイト</li><li>**Kb kb**</li><li>**Mb** -メガバイト</li><li>**Gb** -ギガバイト</li><li>**Tb** -テラバイト</li><li>**Pb** ~ ペタバイト。 |
| noerr | スクリプト専用です。 エラーが発生すると、エラーが発生しなかったかのように、Diskraid はコマンドの処理を続行します。 |

### <a name="standby"></a>スタンバイ

現在選択されているホストバスアダプター (HBA) ポートへのパスの状態をスタンバイに変更します。

#### <a name="syntax"></a>構文

```
standby hbaport
```

##### <a name="parameters"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| hbaport | 現在選択されているホストバスアダプター (HBA) ポートへのパスの状態をスタンバイに変更します。 |

### <a name="unmask"></a>マスク

現在選択されている Lun に、指定したホストからアクセスできるようにします。

#### <a name="syntax"></a>構文

```
unmask lun {all | none | [add] wwn=<hexadecimal_number> [;<hexadecimal_number> [;…]] | [add] initiator=<initiator>[;<initiator>[;…]]} [uninstall]
```

##### <a name="parameters"></a>パラメーター

| パラメーター | 説明 |
| --------- | ----------- |
| all | すべてのホストから LUN にアクセスできるようにすることを指定します。 ただし、iSCSI サブシステム内のすべてのターゲットに対して LUN のマスクを解除することはできません。<P>コマンドを実行する前に、ターゲットのログアウトを行う必要があり `unmask lun all` ます。 |
| なし | どのホストからも LUN にアクセスできないように指定します。<P>コマンドを実行する前に、ターゲットのログアウトを行う必要があり `unmask lun none` ます。 |
| add | この LUN がアクセス可能なホストの既存の一覧に、指定されたホストを追加する必要があることを指定します。 このパラメーターを指定しない場合、指定されたホストの一覧によって、この LUN がアクセスできるホストの既存の一覧が置き換えられます。 |
| wwn = | LUN またはホストをアクセス可能にするワールドワイド名を表す16進数値の一覧を指定します。 ファイバーチャネルサブシステム内の特定のホストセットにマスク/マスク解除するには、対象のホストコンピューター上のポートの WWN をセミコロンで区切った一覧を入力します。 |
| 発信側 = | 現在選択されている LUN がアクセス可能になる iSCSI イニシエーターの一覧を指定します。 ISCSI サブシステム内の特定のホストセットにマスク/マスク解除するには、対象のホストコンピューター上のイニシエーターの iSCSI イニシエーター名のセミコロン区切りの一覧を入力します。 |
| uninstall | 指定されている場合、LUN がマスクされる前に、ローカルシステム上の LUN に関連付けられているディスクをアンインストールします。 |

## <a name="scripting-diskraid"></a>Diskraid のスクリプト作成

サポートされているバージョンの Windows Server を実行している任意のコンピューターで、関連する VDS ハードウェアプロバイダーを使用して、Diskraid をスクリプト化できます。 Diskraid スクリプトを呼び出すには、コマンドプロンプトで次のように入力します。

```
diskraid /s <script.txt>
```

既定では、Diskraid はコマンドの処理を停止し、スクリプトに問題がある場合はエラーコードを返します。 スクリプトの実行を続行し、エラーを無視するには、コマンドに**noerr**パラメーターを含めます。 これにより、Lun の合計数に関係なく、1つのスクリプトを使用してサブシステム内のすべての Lun を削除するなどの便利な方法が可能になります。 すべてのコマンドで**noerr**パラメーターがサポートされているわけではありません。 エラーは、 **noerr**パラメーターを含めたかどうかに関係なく、コマンド構文エラーに対して常に返されます。

## <a name="diskraid-error-codes"></a>Diskraid エラーコード

| エラー コード | エラーの説明 |
| ---------- | ----------------- |
| 0 | エラーは発生していません。 スクリプト全体が失敗せずに実行されました。 |
| 1 | 重大な例外が発生しました。 |
| 2 | Diskraid コマンドラインで指定された引数が正しくありません。 |
| 3 | Diskraid は、指定されたスクリプトまたは出力ファイルを開くことができませんでした。 |
| 4 | Diskraid が使用するサービスの1つでエラーが返されました。 |
| 5 | コマンド構文エラーが発生しました。 オブジェクトが正しく選択されていないか、または選択したオブジェクトがこのコマンドでは無効であるために、スクリプトが失敗しました。 |

## <a name="example"></a>例

コンピューターのサブシステム0の状態を表示するには、次のように入力します。

```
diskraid
```

Enter キーを押すと、次のような出力が表示されます。

```
Microsoft Diskraid version 5.2.xxxx
Copyright (©) 2003 Microsoft Corporation
On computer: COMPUTER_NAME
```

サブシステム0を選択するには、Diskraid プロンプトで次のように入力します。

```
select subsystem 0
```

Enter キーを押すと、次のような出力が表示されます。

```
Subsystem 0 is now the selected subsystem.

DISKRAID> list drives

  Drive ###  Status      Health          Size      Free    Bus  Slot  Flags
  ---------  ----------  ------------  --------  --------  ---  ----  -----
  Drive 0    Online      Healthy         107 GB    107 GB    0     1
  Drive 1    Offline     Healthy          29 GB     29 GB    1     0
  Drive 2    Online      Healthy         107 GB    107 GB    0     2
  Drive 3    Not Ready   Healthy          19 GB     19 GB    1     1
```

Diskraid を終了するには、Diskraid プロンプトで次のように入力します。

```
exit
```

## <a name="additional-references"></a>その他の参照情報

- [コマンド ライン構文の記号](command-line-syntax-key.md)