---
title: klist
description: 'Windows コマンドに関するトピック * * * *- '
ms.custom: na
ms.prod: windows-server
ms.reviewer: na
ms.suite: na
ms.technology: manage-windows-commands
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 4689b4a9-1740-47dd-9240-02105efca428
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/16/2017
ms.openlocfilehash: 4b35069faa835b59f2655262f640ddb18068702f
ms.sourcegitcommit: 6aff3d88ff22ea141a6ea6572a5ad8dd6321f199
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/27/2019
ms.locfileid: "71375310"
---
# <a name="klist"></a>klist



現在キャッシュされている Kerberos チケットの一覧を表示します。 この情報は、Windows Server 2012 に適用されます。 このコマンドの使用方法の例については、次を参照してください。 [例](#BKMK_Examples)します。

## <a name="syntax"></a>構文

```
klist [-lh <LogonId.HighPart>] [-li <LogonId.LowPart>] tickets | tgt | purge | sessions | kcd_cache | get | add_bind | query_bind | purge_bind
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------|-----------|
|-lh|ユーザーのローカル一意識別子 (LUID) の大部分を16進数で表したものを示します。 – Lh も– li も存在しない場合、コマンドの既定値は、現在サインインしているユーザーの LUID です。|
|-li|ユーザーのローカル一意識別子 (LUID) の下位部分 (16 進数で表される) を表します。 – Lh も– li も存在しない場合、コマンドの既定値は、現在サインインしているユーザーの LUID です。|
|券|現在キャッシュされているチケット付与チケット (Tgt)、および指定したログオンセッションのサービスチケットが一覧表示されます。 既定のオプションです。|
|tgt|最初の Kerberos TGT を表示します。|
|削除|指定されたログオンセッションのすべてのチケットを削除できます。|
|Sessions|このコンピューターのログオンセッションの一覧を表示します。|
|kcd_cache|Kerberos の制約付き委任キャッシュ情報を表示します。|
|get|サービスプリンシパル名 (SPN) によって指定されたターゲットコンピューターにチケットを要求できます。|
|add_bind|Kerberos 認証に優先するドメインコントローラーを指定できます。|
|query_bind|Kerberos が接続している各ドメインについて、キャッシュされた優先ドメインコントローラーの一覧を表示します。|
|purge_bind|指定したドメインのキャッシュされた優先ドメインコントローラーを削除します。|
|kdcoptions|RFC 4120 で指定されているキー配布センター (KDC) オプションを表示します。|
|/?|このコマンドのヘルプを表示します。|

## <a name="remarks"></a>コメント

このコマンドのすべてのパラメーターを実行するには、 **Domain Admins**のメンバーシップ、またはそれと同等のメンバーシップが最低限必要です。

パラメーターが指定されていない場合、Klist は、現在ログオンしているユーザーのすべてのチケットを取得します。

パラメーターには、次の情報が表示されます。
-   **券**

    ログオン以降に認証されたサービスの現在のキャッシュチケットを一覧表示します。 キャッシュされたすべてのチケットの次の属性を表示します。  
    -   LogonID:LUID
    -   クライアント:クライアント名とクライアントのドメイン名を連結したものです。
    -   サーバー: サービス名とサービスのドメイン名を連結したものです。
    -   KerbTicket の暗号化の種類:Kerberos チケットの暗号化に使用される暗号化の種類
    -   チケットのフラグ:Kerberos チケットフラグ
    -   開始時刻:チケットが有効になる時刻。
    -   終了時刻:チケットが有効でなくなった時刻。 チケットがこの時間を過ぎている場合、サービスへの認証や更新に使用することはできなくなります。
    -   更新時刻:新しい初期認証が必要になるまでの時間
    -   セッションキーの種類:セッションキーに使用される暗号化アルゴリズム
-   **tgt**

    最初の Kerberos TGT と、現在キャッシュされているチケットの次の属性を一覧表示します。  
    -   LogonID:16進数で識別
    -   ServiceName: krbtgt
    -   TargetName \<SPN >: krbtgt
    -   TapiTGT を発行するドメインの名前
    -   TargetDomainName:TGT が発行されるドメイン
    -   AltTargetDomainName:TGT が発行されるドメイン
    -   チケットのフラグ:アドレスとターゲットのアクションと種類
    -   セッションキー:キーの長さと暗号化アルゴリズム
    -   /Stチケットが要求されたローカルコンピューターの時刻
    -   EndTimeチケットが有効でなくなった時刻。 チケットがこの時間を過ぎている場合は、サービスに対する認証に使用できなくなります。
    -   RenewUntil:チケット更新の期限
    -   TimeSkew:キー配布センター (KDC) との時差
    -   エンコードチケット:エンコードされたチケット
-   **済み**

    特定のチケットを削除できます。 チケットを削除すると、キャッシュされているすべてのチケットが破棄されるため、この属性は注意して使用してください。 リソースに対して認証できなくなる可能性があります。 この問題が発生した場合は、いったんログオフしてから再度ログオンする必要があります。  
    -   LogonID:16進数で識別
-   **sessions**

    このコンピューターのすべてのログオンセッションの情報を一覧表示し、表示することができます。  
    -   LogonID:指定した場合、指定した値によってのみログオンセッションが表示されます。 指定しない場合、このコンピューターのすべてのログオンセッションが表示されます。
-   **kcd_cache**

    Kerberos の制約付き委任キャッシュ情報を表示できます。  
    -   LogonID:指定した場合は、指定された値までにログオンセッションのキャッシュ情報が表示されます。 指定しない場合、現在のユーザーのログオンセッションのキャッシュ情報が表示されます。
-   **取得**

    SPN によって指定されたターゲットにチケットを要求できます。  
    -   LogonID:指定した場合、指定された値でログオンセッションを使用してチケットを要求します。 指定しない場合、現在のユーザーのログオンセッションを使用してチケットを要求します。
    -   kdcoptions:指定された KDC オプションでチケットを要求します
-   **add_bind**

    Kerberos 認証に優先するドメインコントローラーを指定できます。
-   **query_bind**

    ドメインのキャッシュされた優先ドメインコントローラーを表示できます。
-   **purge_bind**

    ドメインのキャッシュされた優先ドメインコントローラーを削除できます。
-   **kdcoptions**

    現在のオプションの一覧とその説明については、 [RFC 4120](http://www.ietf.org/rfc/rfc4120.txt)を参照してください。

**その他の考慮事項**
-   Klist は、Windows Server 2012 および Windows 8 で使用でき、特別なインストールは必要ありません。

## <a name="BKMK_Examples"></a>例

1. 対象サーバーのチケット保証サービス (TGS) 要求の処理中にイベント ID 27 を診断するときに、アカウントに Kerberos チケットを生成するための適切なキーがありませんでした。 Klist を使用して Kerberos チケットキャッシュを照会し、チケットが不足しているかどうか、対象サーバーまたはアカウントにエラーがあるかどうか、または暗号化の種類がサポートされていないかどうかを確認できます。  
   ```
   klist 
   ```  
   ```
   klist –li 0x3e7
   ```  
2. エラーを診断し、ログオンセッションのためにコンピューターにキャッシュされている各チケット付与チケットの詳細を知りたい場合は、Klist を使用して TGT 情報を表示できます。  
   ```
   klist tgt
   ```  
3. 接続を確立できず、診断に時間がかかりすぎる場合は、Kerberos チケットのキャッシュを消去し、ログオフしてから再度ログオンすることができます。  
   ```
   klist purge
   ```  
   ```
   klist purge –li 0x3e7
   ```  
4. ユーザーまたはサービスのログオンセッションを診断する場合は、次のコマンドを使用して、他の Klist コマンドで使用されている LogonID を見つけることができます。  
   ```
   klist sessions
   ```  
5. Kerberos の制約付き委任エラーを診断するには、次のコマンドを使用して、発生した最後のエラーを確認します。  
   ```
   klist kcd_cache
   ```  
6. ユーザーまたはサービスがサーバーにチケットを取得できるかどうかを診断するには、このコマンドを使用して特定の SPN のチケットを要求します。  
   ```
   klist get host/%computername%
   ```  
7. ドメインコントローラー間のレプリケーションの問題を診断する場合は、通常、特定のドメインコントローラーを対象とするクライアントコンピューターが必要です。 このような場合は、次のコマンドを使用して、クライアントコンピューターをその特定のドメインコントローラーに対してターゲットにすることができます。  
   ```
   klist add_bind CONTOSO KDC.CONTOSO.COM
   ```  
   ```
   klist add_bind CONTOSO.COM KDC.CONTOSO.COM
   ```  
8. このコンピューターが最近接続したドメインコントローラーに対してクエリを実行するには、次のコマンドを使用します。  
   ```
   klist query_bind
   ```  
9. Kerberos でドメインコントローラーを再検出する場合は、次のコマンドを使用できます。 このコマンドは、klist add_bind を使用して新しいドメインコントローラーバインドを作成する前に、キャッシュをフラッシュするためにも使用できます。  
   ```
   klist purge_bind
   ```

#### <a name="additional-references"></a>その他の参照情報

-   [コマンド ライン構文の記号](command-line-syntax-key.md)