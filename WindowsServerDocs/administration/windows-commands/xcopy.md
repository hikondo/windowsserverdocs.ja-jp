---
title: xcopy
description: ファイルとディレクトリ (サブディレクトリを含む) をコピーする xcopy のリファレンストピックです。
ms.prod: windows-server
ms.technology: manage-windows-commands
ms.topic: article
ms.assetid: 76a310d7-9925-4571-a252-0e28960d5f89
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 01/05/2019
ms.openlocfilehash: c55d6ae5ff701555eb9bfb7135ffa28692bd4391
ms.sourcegitcommit: 4894649cc47dfa535306cc334871f81155198f76
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/01/2020
ms.locfileid: "84254725"
---
# <a name="xcopy"></a>xcopy

サブディレクトリを含むファイルとディレクトリをコピーします。

このコマンドを使用する方法の例については、[例](#examples)を参照してください。

## <a name="syntax"></a>構文

```
Xcopy <Source> [<Destination>] [/w] [/p] [/c] [/v] [/q] [/f] [/l] [/g] [/d [:MM-DD-YYYY]] [/u] [/i] [/s [/e]] [/t] [/k] [/r] [/h] [{/a | /m}] [/n] [/o] [/x] [/exclude:FileName1[+[FileName2]][+[FileName3]] [{/y | /-y}] [/z] [/b] [/j]
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------|-----------|
|\<Source>|必須です。 コピーするファイルの場所と名前を指定します。 このパラメーターには、ドライブまたはパスを含める必要があります。|
|[\<Destination>]|コピーするファイルの保存先を指定します。 このパラメーターには、ドライブ文字とコロン、ディレクトリ名、ファイル名、またはこれらの組み合わせを含めることができます。|
|/w|次のメッセージを表示し、応答を待機してから、ファイルのコピーを開始します。</br>**任意のキーを押して、ファイルのコピーを開始します**|
|/p|各対象ファイルを作成するかどうかを確認するメッセージが表示されます。|
|/c|エラーを無視します。|
|/v|コピー先ファイルに書き込まれるたびに、各ファイルがソースファイルと同一であることを確認します。|
|/q|**Xcopy**メッセージの表示を抑制します。|
|/f|コピー中にソースとターゲットのファイル名を表示します。|
|/l|コピーするファイルの一覧を表示します。|
|/g|転送先が暗号化をサポートしていない場合に、復号化された*対象*ファイルを作成します。|
|/d [: MM-DD]|指定した日付以降に変更されたソースファイルをコピーします。 *MM-DD-YYYY*値を指定しない場合、 **xcopy**では、既存の*コピー先*ファイルよりも新しいすべての*ソース*ファイルがコピーされます。 このコマンドラインオプションを使用すると、変更されたファイルを更新できます。|
|/U|*転送先*のみに存在する*ソース*からファイルをコピーします。|
|/i|*Source*がディレクトリであるか、またはワイルドカードを含んでおり、 *destination*が存在しない場合、 **xcopy**は*destination*としてディレクトリ名を指定し、新しいディレクトリを作成します。 次に、 **xcopy**は、指定されたすべてのファイルを新しいディレクトリにコピーします。 既定では、 **xcopy**は、 *Destination*がファイルまたはディレクトリのどちらであるかを指定するように求めます。|
|/s|空の場合を除き、ディレクトリとサブディレクトリをコピーします。 **/S**を省略した場合、 **xcopy**は1つのディレクトリ内で機能します。|
|/e|空の場合でも、すべてのサブディレクトリをコピーします。 **/S**および **/t**コマンドラインオプションと共に **/e**を使用します。|
|/t|ファイルではなく、サブディレクトリ構造 (つまり、ツリー) のみをコピーします。 空のディレクトリをコピーするには、 **/e**コマンドラインオプションを指定する必要があります。|
|/k|ファイルをコピーし、*ソース*ファイル上に存在する場合は、*対象*のファイルに読み取り専用属性を保持します。 既定では、 **xcopy**は読み取り専用属性を削除します。|
|/r|読み取り専用のファイルをコピーします。|
|/h|隠しファイルとシステムファイルの属性を持つファイルをコピーします。 既定では、 **xcopy**は隠しファイルまたはシステムファイルをコピーしません。|
|/a|アーカイブファイルの属性が設定されている*ソース*ファイルのみをコピーします。 **/a**では、ソースファイルの archive file 属性は変更されません。 **Attrib**を使用してアーカイブファイルの属性を設定する方法については、「[その他の参照](#additional-references)情報」を参照してください。|
|/m|アーカイブファイルの属性が設定されている*ソース*ファイルをコピーします。 **/A**とは異なり、 **/m**は、ソースで指定されているファイルのアーカイブファイルの属性をオフにします。 **Attrib**を使用してアーカイブファイルの属性を設定する方法については、「[その他の参照](#additional-references)情報」を参照してください。|
|/n|NTFS 短いファイル名またはディレクトリ名を使用してコピーを作成します。 **/n**は、ファイルまたはディレクトリを NTFS ボリュームから fat ボリュームにコピーする場合、または fat ファイルシステムの命名規則 (つまり、8.3 文字) が*対象*のファイルシステムに必要な場合に必要です。 *コピー先*のファイルシステムには、FAT または NTFS を使用できます。|
|/o|ファイルの所有権と随意アクセス制御リスト (DACL) 情報をコピーします。|
|/x|ファイルの監査設定とシステムアクセス制御リスト (SACL) 情報をコピーします ( **/o**を意味します)。|
|/除外: FileName1 [+ [FileName2] [+ [FileName3] ( \) ]|ファイルの一覧を指定します。 少なくとも1つのファイルを指定する必要があります。 各ファイルには、ファイル内の個別の行に各文字列を含む検索文字列が含まれます。</br>コピーするファイルの絶対パスの任意の部分に一致する文字列がある場合、そのファイルはコピーされません。 たとえば、文字列**obj**を指定すると、ディレクトリ**obj**の下にあるすべてのファイル、または拡張子が **.obj**のすべてのファイルが除外されます。|
|/y|既存の対象ファイルを上書きするかどうかを確認するメッセージを表示しません。|
|/-y|既存の対象ファイルを上書きするかどうかを確認するメッセージが表示されます。|
|/z|再起動可能モードでネットワーク経由でコピーします。|
|/b|ファイルではなく、シンボリックリンクをコピーします。 このパラメーターは、Windows Vista®で導入されました。|
|/j|バッファリングせずにファイルをコピーします。 非常に大きなファイルに推奨されます。 このパラメーターは、Windows Server 2008 R2 で追加されました。|
|/?|コマンド プロンプトにヘルプを表示します。|

## <a name="remarks"></a>注釈

- **/Z**の使用

  コピーフェーズ中に接続が切断された場合 (たとえば、オフラインになっているサーバーが接続を切断した場合)、接続を再確立した後に再開されます。 **/z**は、各ファイルに対して完了したコピー操作の割合も表示します。

- COPYCMD 環境変数で **/y**を使用します。

  **/Y**は、copycmd 環境変数で使用できます。 このコマンドは、コマンドラインで **/-y**を使用してオーバーライドできます。 既定では、を上書きするように求められます。

- 暗号化されたファイルのコピー

  EFS をサポートしていないボリュームに暗号化されたファイルをコピーすると、エラーが発生します。 最初にファイルの暗号化を解除するか、EFS をサポートしているボリュームにファイルをコピーします。

- 追加 (ファイルを)

  ファイルを追加するには、変換先に対して1つのファイルを指定しますが、ソースには複数のファイルを指定します (つまり、ワイルドカードまたは file1 + file2 + file3 形式を使用します)。

- *Destination*の既定値

  *Destination*を省略した場合、 **xcopy**コマンドを実行すると、ファイルが現在のディレクトリにコピーされます。

- *Destination*がファイルまたはディレクトリであるかどうかを指定する

  *保存先*に既存のディレクトリが含まれておらず、末尾に円記号が付いていない場合は \) 、次のメッセージが表示されます。

  ```
  Does <Destination> specify a file name or directory name on the target(F = file, D = directory)?
  ```

ファイルをファイルにコピーする場合は、F キーを押します。 ファイルをディレクトリにコピーする場合は、D キーを押します。

  **/I**コマンドラインオプションを使用すると、このメッセージが表示されないようにすることができます。これにより、ソースが複数のファイルまたはディレクトリである場合、 **xcopy**は宛先がディレクトリであると想定します。
- **Xcopy**コマンドを使用して、*コピー先*ファイルのアーカイブ属性を設定する

  **Xcopy**コマンドは、ソースファイルにこの属性が設定されているかどうかにかかわらず、archive 属性が設定されたファイルを作成します。 ファイル属性と**attrib**の詳細については、「[その他の参照](#additional-references)情報」を参照してください。

- **Xcopy**と**diskcopy**の比較

  サブディレクトリにファイルが格納されているディスクがあり、別の形式のディスクにコピーする場合は、 **diskcopy**ではなく、 **xcopy**コマンドを使用します。 **Diskcopy**コマンドを使用すると、ディスクトラックがトラックによってコピーされるため、コピー元とコピー先のディスクの形式は同じである必要があります。 **Xcopy**コマンドには、この要件はありません。 ディスクイメージの完全コピーが必要な場合以外は、 **xcopy**を使用してください。

- **Xcopy**の終了コード

  **Xcopy**によって返される終了コードを処理するには、バッチプログラムの**if**コマンドラインで**ErrorLevel**パラメーターを使用します。 **If**を使用して終了コードを処理するバッチプログラムの例については、「[その他の参照情報](#additional-references)」を参照してください。 次の表は、各終了コードと説明を示しています。

  |終了コード|説明|
  |---------|-----------|
  |0|ファイルはエラーなしでコピーされました。|
  |1|コピーするファイルが見つかりませんでした。|
  |2|ユーザーが CTRL + C キーを押して、 **xcopy**を終了しました。|
  |4|初期化エラーが発生しました。 メモリまたはディスク領域が不足しているか、コマンドラインで無効なドライブ名または無効な構文を入力しました。|
  |5|ディスク書き込みエラーが発生しました。|

## <a name="examples"></a>例

**1.** ドライブ a からドライブ B にすべてのファイルとサブディレクトリ (空のサブディレクトリを含む) をコピーするには、次のように入力します。

```
xcopy a: b: /s /e
```

**2.** 前の例でシステムファイルまたは隠しファイルを含めるには、次のように<strong>/h</strong>コマンドラインオプションを追加します。

```
xcopy a: b: /s /e /h
```

**3.** 1993 年12月29日以降に変更された \Rawdata ディレクトリ内のファイルで、\Reports ディレクトリ内のファイルを更新するには、次のように入力します。

```
xcopy \rawdata \reports /d:12-29-1993
```

**4.** 日付に関係なく、前の例の \Reports に存在するすべてのファイルを更新するには、次のように入力します。

```
xcopy \rawdata \reports /u
```

**5.** 前のコマンドでコピーされるファイルの一覧を取得するには (つまり、実際にファイルをコピーせずに)、次のように入力します。

```
xcopy \rawdata \reports /d:12-29-1993 /l > xcopy.out
```

Xcopy ファイルには、コピーするすべてのファイルが一覧表示されます。

**6.** \ Customer ディレクトリとすべてのサブディレクトリをネットワークドライブ H: のディレクトリの Public\ アドレスにコピーするには、読み取り専用の \\ \\ 属性を保持し、H: のように新しいファイルが作成されたときに、次のように入力します。

```
xcopy \customer h:\public\address /s /e /k /p
```

**7.** 前のコマンドを実行するには、 **xcopy**で \ アドレスディレクトリが存在しない場合は作成し、新しいディレクトリを作成するときに表示されるメッセージを抑制して、次のように **/i**コマンドラインオプションを追加します。

```
xcopy \customer h:\public\address /s /e /k /p /i
```

**8.** **xcopy**操作を実行するバッチプログラムを作成し、エラーが発生した場合にバッチ**if**コマンドを使用して終了コードを処理することができます。 たとえば、次のバッチプログラムでは、 **xcopy**の source パラメーターと destination パラメーターに置き換え可能なパラメーターが使用されています。

```
@echo off
rem COPYIT.BAT transfers all files in all subdirectories of
rem the source drive or directory (%1) to the destination
rem drive or directory (%2)
xcopy %1 %2 /s /e
if errorlevel 4 goto lowmemory
if errorlevel 2 goto abort
if errorlevel 0 goto exit
:lowmemory
echo Insufficient memory to copy files or
echo invalid drive or command-line syntax.
goto exit
:abort
echo You pressed CTRL+C to end the copy operation.
goto exit
:exit
```

上記の batch プログラムを使用して、C:\Prgmcode ディレクトリ内のすべてのファイルとそのサブディレクトリをドライブ B にコピーするには、次のように入力します。

```
copyit c:\prgmcode b:
```

コマンドインタープリターにより、 *%1*と**B**の**C:\Prgmcode**が% *2*に置き換えられます。その後、 **/e**と **/s**のコマンドラインオプションを使用して**xcopy**を使用します。 **Xcopy**でエラーが検出された場合、バッチプログラムは終了コードを読み取り、適切な**IF ERRORLEVEL**ステートメントで示されているラベルに移動し、適切なメッセージを表示してバッチプログラムから終了します。

**9.** この例では、空ではないすべてのディレクトリと、その名前がアスタリスク記号で指定されたパターンに一致するファイルをコピーします。

```
xcopy .\toc*.yml ..\..\Copy-To\ /S /Y

rem Output example.
rem  .\d1\toc.yml
rem  .\d1\d12\toc.yml
rem  .\d2\toc.yml
rem  3 File(s) copied
```

前の例では、この特定のソースパラメーター値を使用**しています。 \\\*.yml**は、2つの**パス文字 \\ が**削除された場合でも、同じ3つのファイルをコピーします。 ただし、source パラメーターからアスタリスクのワイルドカードが削除された場合、ファイルはコピーされません **。 \\.yml**。

## <a name="additional-references"></a>その他のリファレンス

- [コピー](copy.md)
- [移動](move.md)
- [エイリアス](dir.md)
- [Attrib](attrib.md)
- [Diskcopy](diskcopy.md)
- [もし](if.md)
- [コマンド ライン構文の記号](command-line-syntax-key.md)
