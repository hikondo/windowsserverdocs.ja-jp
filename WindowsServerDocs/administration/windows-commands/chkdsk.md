---
title: chkdsk
description: ボリュームのファイルシステムおよびファイルシステムメタデータで論理エラーと物理エラーをチェックする、chkdsk の Windows コマンドに関するトピック。
ms.prod: windows-server
ms.technology: manage-windows-commands
ms.topic: article
ms.assetid: 62912a3c-d2cc-4ef6-9679-43709a286035
author: jasongerend
ms.author: jgerend
manager: lizapo
ms.date: 10/09/2019
ms.openlocfilehash: 130b51e472ebf3d900186d6d63e318c88a340579
ms.sourcegitcommit: e2964a803cba1b8037e10d065a076819d61e8dbe
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/10/2019
ms.locfileid: "72252352"
---
# <a name="chkdsk"></a>chkdsk

ボリュームのファイルシステムおよびファイルシステムメタデータで論理エラーと物理エラーを確認します。 パラメーターを指定せずに使用した場合、 **chkdsk**ではボリュームの状態のみが表示され、エラーは修正されません。 **/F**、 **/r**、 **/x**、または **/b**パラメーターと共に使用すると、ボリューム上のエラーが修正されます。

> [!IMPORTANT]
> **Chkdsk**を実行するには、ローカルの**Administrators**グループのメンバーシップ、またはそれと同等のメンバーシップが最低限必要です。 管理者としてコマンドプロンプトウィンドウを開くには、スタート メニューの **コマンドプロンプト** を右クリックし、**管理者として実行** をクリックします。

> [!IMPORTANT]
> **Chkdsk**を中断することは推奨されません。 ただし、chkdsk をキャンセルまた**は中断し**ても、 **chkdsk**が実行される前と比べて、ボリュームが破損することはありません。 **Chkdsk**を再実行すると、ボリュームの残りの破損を確認して修復します。

> [!IMPORTANT]
> **注:** Chkdsk は、ローカルディスクに対してのみ使用できます。 ネットワーク経由でリダイレクトされたローカルドライブ文字と共にコマンドを使用することはできません。

このコマンドを使用する方法の例については、[例](#examples)を参照してください。

## <a name="syntax"></a>構文

```
chkdsk [<Volume>[[<Path>]<FileName>]] [/f] [/v] [/r] [/x] [/i] [/c] [/l[:<Size>]] [/b]  
```

## <a name="parameters"></a>パラメーター

|      パラメーター       |                  説明                                    |
| -------------------- | ------------------------------------------------------------------------ |
|      \<ボリューム >      | ドライブ文字 (後ろにコロンを付ける)、マウントポイント、またはボリューム名を指定します。  |
| [\<パス >]<FileName> | ファイルアロケーションテーブル (FAT) および FAT32 でのみ使用します。 **Chkdsk**で断片化をチェックするファイルまたはファイルのセットの場所と名前を指定します。 使用することができ**ますか?** 複数 **&#42;** のファイルを指定するワイルドカード文字です。 |
|         /f          | ディスク上のエラーを修正します。 ディスクをロックする必要があります。 **Chkdsk**でドライブをロックできない場合は、次回コンピューターを再起動したときにドライブを確認するかどうかを確認するメッセージが表示されます。 |
|         /v          | ディスクがチェックされるたびに、各ディレクトリ内の各ファイルの名前が表示されます。     |
|         /r          | 不良セクターを特定し、読み取り可能な情報を回復します。 ディスクをロックする必要があります。 **/r**には **/f**の機能が含まれており、物理ディスクエラーの分析も追加されています。                                   |
|         /x          | 必要に応じて、最初にボリュームを強制的にマウント解除します。 ドライブに対して開いているハンドルはすべて無効になります。 **/x**には、 **/f**の機能も含まれています。  |
|         /i          | NTFS でのみ使用します。 では、インデックスエントリのより単純なチェックが実行されるため、 **chkdsk**の実行に必要な時間が短縮されます。  |
|         /c          | NTFS でのみ使用します。 では、フォルダー構造内の循環がチェックされないため、 **chkdsk**の実行に必要な時間が短縮されます。  |
|    /l [:\<サイズ >]     | NTFS でのみ使用します。 ログファイルのサイズを入力したサイズに変更します。 Size パラメーターを省略すると、 **/l**によって現在のサイズが表示されます。 |
|         /b          | NTFS のみ: ボリューム上の不良クラスターの一覧を消去し、割り当てられているすべてのクラスターと空きクラスターを再スキャンしてエラーを発生させることができます。 **/b**には、 **/r**の機能が含まれています。 ボリュームを新しいハードディスクドライブにイメージ化した後に、このパラメーターを使用します。            |
| /scan               | NTFS のみ: ボリュームに対してオンラインスキャンを実行します。 |
| /forceofflinefix    | NTFS のみ: ("/scan" と共に使用する必要があります)。 オンライン修復をすべてバイパスする。検出されたすべての障害は、オフライン修復のためにキューに入れられます (つまり、"chkdsk/spotfix")。 |
| /パフォーマンス               | NTFS のみ: ("/scan" と共に使用する必要があります)。 は、高速 aspossible としてスキャンを完了するために、より多くのシステムリソースを使用します。 これにより、システムで実行されている他のタスクのパフォーマンスが低下する可能性があります。|
| /spotfix            | NTFS のみ: ボリューム上でスポット修正を実行します。 |
| /sdcleanup          | NTFS のみ: 不要なセキュリティ記述子データをガベージコレクトします (/F を意味します)。 |
| /offlinescanandfix  | オフラインスキャンを実行し、ボリュームを修正します。 |
| /freeorphanedchains | FAT/FAT32/exFAT のみ: 孤立したクラスターチェーンは、その内容を回復するのではなく、解放します。 |
| /markclean          | FAT/FAT32/exFAT only:/F が指定されていない場合でも、破損が検出されなかった場合にボリュームをクリーンにマークします。 |
|         /?          | コマンド プロンプトにヘルプを表示します。                       |

## <a name="remarks"></a>注釈

- ボリュームチェックのスキップ

  **/I**または **/c**スイッチを指定すると、特定のボリュームチェックをスキップすることで、 **chkdsk**の実行に必要な時間を短縮できます。
- 再起動時にロックされたドライブを確認しています

  **Chkdsk**でディスクエラーを修正する場合は、ドライブ上に開いているファイルを使用することはできません。 ファイルが開いている場合は、次のエラーメッセージが表示されます。

  ```
  Chkdsk cannot run because the volume is in use by another process. Would you like to schedule this volume to be checked the next time the system restarts? (Y/N)  
  ``` 

  次回コンピューターを再起動したときにドライブを確認することを選択した場合、 **chkdsk**はドライブを確認し、コンピューターを再起動するとエラーを自動的に修正します。 ドライブパーティションがブートパーティションの場合、ドライブのチェック後に、 **chkdsk**によってコンピューターが自動的に再起動されます。

  また、 **chkntfs/c**コマンドを使用して、次回コンピューターを再起動したときに確認するボリュームのスケジュールを設定することもできます。 **Fsutil dirty set**コマンドを使用して、ボリュームのダーティビット (破損を示す) を設定します。これにより、コンピューターの再起動時に Windows によって**chkdsk**が実行されます。
- ディスクエラーの報告

  ディスクエラーをチェックするには、FAT および NTFS ファイルシステムで**chkdsk**を使用することをお勧めします。 **Chkdsk**は、ディスク領域とディスク使用量を調べ、各ファイルシステムに固有の状態レポートを提供します。 状態レポートには、ファイルシステムで検出されたエラーが表示されます。 アクティブなパーティションで **/f**パラメーターを指定せずに**chkdsk**を実行すると、ドライブをロックできないため、誤ったエラーが報告されることがあります。
- 論理ディスクエラーの修復

  **Chkdsk**では、 **/f**パラメーターを指定した場合にのみ、論理ディスクのエラーが修正されます。 **Chkdsk**では、エラーを修正するためにドライブをロックできる必要があります。

  通常、FAT ファイルシステムでの修復によってディスクのファイルアロケーションテーブルが変更され、データが失われることがあるため、 **chkdsk**では次のような確認メッセージが表示されることがあります。

  ```
  10 lost allocation units found in 3 chains.  
  Convert lost chains to files?  
  ``` 

  **Y**キーを押すと、ルートディレクトリ内の各失われたチェーンがファイルとして保存されます。このファイルの名前は、形式ファイル\<nnnn > .chk になります。 **Chkdsk**が完了したら、これらのファイルに必要なデータが含まれているかどうかを確認できます。 **N**キーを押すと、Windows によってディスクが修正されますが、失われたアロケーションユニットの内容は保存されません。

  **/F**パラメーターを使用しない場合、ファイルを修正する必要があることを示すメッセージが**chkdsk**によって表示されますが、エラーは修正されません。

  非常に大きなディスクまたは膨大な数のファイル (何百万ものファイルなど) のディスクで**chkdsk/f**を使用すると、 **chkdsk**の完了に時間がかかることがあります。

- 物理ディスクエラーの検出

  **/R**パラメーターを使用して、ファイルシステムの物理ディスクエラーを検出し、影響を受けたディスクセクターからデータを回復します。

- 開いているファイルで**chkdsk**を使用する

  **/F**パラメーターを指定した場合、ディスク上に開いているファイルがあると、 **chkdsk**によってエラーメッセージが表示されます。 **/F**パラメーターを指定せず、開いているファイルが存在する場合、 **chkdsk**はディスク上の失われたアロケーションユニットを報告する場合があります。 これは、ファイルアロケーションテーブルに開いているファイルがまだ記録されていない場合に発生する可能性があります。 **Chkdsk**で大量のアロケーションユニットの損失が報告された場合は、ディスクの修復を検討してください。

- 共有フォルダーのシャドウコピーでの**chkdsk**の使用

  共有フォルダーのシャドウコピーが有効になっている間は共有フォルダーのシャドウコピーソースボリュームをロックできないため、ソースボリュームに対して**chkdsk**を実行すると、誤ったエラーが報告されるか、 **chkdsk**が予期せず終了する可能性があります。 ただし、読み取り専用モード (パラメーターなし) で**chkdsk**を実行して共有フォルダーのシャドウコピーの記憶域ボリュームを確認することで、エラーのシャドウコピーを確認できます。

- 終了コードについて

  次の表に、 **chkdsk**が完了した後に報告する終了コードを示します。  

  | 終了コード |                                                   説明                                                    |
  |-----------|------------------------------------------------------------------------------------------------------------------|
  |     0     |                                              エラーは見つかりませんでした。                                               |
  |     1     |                                           エラーが見つかり、修正されました。                                           |
  |     2     | **/F**が指定されていないため、ディスククリーンアップ (ガベージコレクションなど) が実行されたか、クリーンアップが実行されませんでした。 |
  |     3     | ディスクを確認できなかったか、エラーを修正できなかったか、または **/f**が指定されていないため、エラーは修正されませんでした。  |


- **Chkdsk**コマンドは異なるパラメーターを使用して、回復コンソールから使用できます。
- 再起動頻度の低いサーバーでは、 **chkntfs**または**fsutil dirty query**コマンドを使用して、chkdsk を実行する前にボリュームのダーティビットが既に設定されているかどうかを確認することができます。

## <a name="examples"></a>例

ドライブ D のディスクを確認し、Windows 修正エラーが発生している場合は、次のように入力します。

```
chkdsk d: /f  
```

エラーが発生した場合、 **chkdsk**は一時停止し、メッセージを表示します。 **Chkdsk**は、ディスクの状態を一覧表示するレポートを表示することによって終了します。 **Chkdsk**が終了するまで、指定されたドライブ上のファイルを開くことはできません。

現在のディレクトリの FAT ディスクにあるすべてのファイルで、連続していないブロックを確認するには、次のように入力します。

```
chkdsk *.*  
```

**Chkdsk**によって状態レポートが表示され、連続しないブロックを含むファイルの仕様に一致するファイルが一覧表示されます。

## <a name="additional-references"></a>その他の参照情報

[コマンド ライン構文の記号](command-line-syntax-key.md)
