---
title: at
description: Windows コマンドに関するトピック**で**は、指定した日時にコンピューター上で実行するスケジュールされたコマンドとプログラムについて説明します。
ms.custom: na
ms.prod: windows-server
ms.reviewer: na
ms.suite: na
ms.technology: manage-windows-commands
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: ff18fd16-9437-4c53-8794-bfc67f5256b3
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/16/2017
ms.openlocfilehash: 6c8a7497b1276cf46177fa72824afb8ed238776a
ms.sourcegitcommit: 6aff3d88ff22ea141a6ea6572a5ad8dd6321f199
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/27/2019
ms.locfileid: "71382620"
---
# <a name="at"></a>at

>適用対象: Windows Server (半期チャネル)、Windows Server 2016、Windows Server 2012 R2、Windows Server 2012

指定した日時にコンピューター上で実行するコマンドとプログラムをスケジュールします。 は、Schedule サービスが実行されている場合**にのみ使用**できます。 パラメーターを指定せ**ずに使用**します。スケジュールされたコマンドを一覧表示します。
## <a name="syntax"></a>構文
```
at [\\computername] [[id] [/delete] | /delete [/yes]]
at [\\computername] <time> [/interactive] [/every:date[,...] | /next:date[,...]] <command>
```
## <a name="parameters"></a>パラメーター

|      パラメーター       |                                                                                                                                                                                                               説明                                                                                                                                                                                                                |
|----------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| \\\\\<computerName\> |                                                                                                                                                        リモート コンピューターを指定します。 このパラメーターを省略すると、 **at**はローカルコンピューター上のコマンドとプログラムをスケジュールします。                                                                                                                                                        |
|        \<id\>        |                                                                                                                                                                                   スケジュールされたコマンドに割り当てられた識別番号を指定します。                                                                                                                                                                                   |
|       /delete        |                                                                                                                                                                スケジュールされたコマンドをキャンセルします。 *ID*を省略すると、コンピューター上のスケジュールされたすべてのコマンドが取り消されます。                                                                                                                                                                |
|         /yes         |                                                                                                                                                                               スケジュールされたイベントを削除するときに、システムからのすべてのクエリに対して [はい] を回答します。                                                                                                                                                                               |
|       \<time\>       |                                                                                                                                          コマンドを実行する時刻を指定します。 時刻は、時間: 分で24時間表記で表されます (つまり、00:00 [深夜] ~ 23:59)。                                                                                                                                          |
|     /interactive     |                                                                                                                                                                  *コマンドの実行時*にログオンしたユーザーのデスクトップとの対話を*コマンド*に許可します。                                                                                                                                                                  |
|       /every        |                                                                                                                                                    指定したすべての曜日または曜日 (たとえば、毎週の木曜日、3日目など) に対して*コマンド*を実行します。                                                                                                                                                    |
|       \<date\>       |                                                  コマンドを実行する日付を指定します。 1つまたは複数の曜日を指定できます (つまり、「 **M**」、「**T** **」、「** **Th**」、「**F** **」、「** **Su**」、または「1 ~ 31」と入力します)。 複数の日付エントリをコンマで区切ります。 *日付*を省略した場合、 **at**は月の現在の日付を使用します。                                                  |
|        前後        |                                                                                                                                                                              次の日の発生時に*コマンド*を実行します (次の木曜日など)。                                                                                                                                                                              |
|     \<command\>      | 実行する Windows コマンド、プログラム (.exe または .com ファイル)、またはバッチプログラム (つまり、.bat または .cmd ファイル) を指定してください。 コマンドが引数としてパスを必要とする場合は、絶対パス (つまり、ドライブ文字で始まるパス全体) を使用します。 コマンドがリモートコンピューター上にある場合は、リモートドライブ文字ではなく、サーバーと共有名に汎用名前付け規則 (UNC) 表記を指定します。 |
|          /?          |                                                                                                                                                                                                   コマンド プロンプトにヘルプを表示します。                                                                                                                                                                                                   |

## <a name="remarks"></a>注釈
- **schtasks**は、スケジュールされたタスクを作成および管理するために使用できる、別のコマンドラインスケジューリングツールです。 **Schtasks**の詳細については、関連項目を参照してください。
- 使用 ( **at** )  
  **で**を使用するには、ローカルの Administrators グループのメンバーである必要があります。
- Cmd.exe を読み込んでいます  
  は自動的に読み込むことができません、Cmd.exe、コマンド インタープリターのコマンドを実行する前にします。 実行可能ファイル (.exe) を実行していない場合は、次のように、コマンドの先頭に Cmd.exe を明示的に読み込む必要があります。 **cmd/c dir > c:\test.out**
- スケジュールされたコマンドの表示  
  コマンドラインオプションを指定せず**に at**を使用すると、スケジュールされたタスクは次のように書式設定されたテーブルに表示されます。
  ```
  Status  ID   Day        time        Command Line
  OK      1    Each F     4:30 PM     net send group leads status due
  OK      2    Each M     12:00 AM    chkstor > check.file
  OK      3    Each F     11:59 PM    backup2.bat
  ```
- 識別番号 (*id*) を含む  
  コマンドプロンプトでで id (*id*) を**に含める**と、1つのエントリの情報が次のような形式で表示されます。  
  ```
  Task ID:      1
  Status:       OK
  Schedule:     Each  F
  time of Day:  4:30 PM
  Command:      net send group leads status due
  ```
  **で**コマンドのスケジュールを設定した後、コマンドラインオプションを含むコマンドを実行した後、コマンドラインオプションを指定せず**に**「」と入力して、コマンドの構文が正しいことを確認します。 [コマンドライン] 列の情報が正しくない場合は、コマンドを削除して再入力します。 それでも間違っている場合は、コマンドをもう一度入力します。コマンドラインオプションを減らすこともできます。
- 結果の表示  
  でスケジュールさ**れたコマンドをバックグラウンド**プロセスとして実行します。 出力はコンピューター画面に表示されません。 出力をファイルにリダイレクトするには、リダイレクトシンボル (>) を使用します。 出力をファイルにリダイレクトする場合は、コマンドラインまたはバッチファイルでを使用**している**かどうかにかかわらず、リダイレクトシンボルの前にエスケープ記号 (^) を使用する必要があります。 たとえば、出力を出力にリダイレクトするには、次のように入力します。  
  `at 14:45 c:\test.bat ^>c:\output.txt`  
  実行中のコマンドの現在のディレクトリは、systemroot フォルダーです。
- システム時刻の変更  
  **で**実行するコマンドをスケジュールした後で、コンピューターのシステム時刻を変更する場合は、コマンドラインオプションを指定せず**に**「」と入力して、スケジューラ**で**を、変更されたシステム時刻と同期します。
- コマンドの格納  
  スケジュールされたコマンドはレジストリに格納されます。 その結果、スケジュールサービスを再起動した場合、スケジュールされたタスクが失われることはありません。
- ネットワークドライブへの接続  
  ネットワークにアクセスするスケジュールされたジョブには、リダイレクトされたドライブを使用しないでください。 スケジュールサービスは、リダイレクトされたドライブにアクセスできない可能性があります。または、スケジュールされたタスクの実行時に別のユーザーがログオンしている場合は、リダイレクトされたドライブが存在しない可能性があります。 代わりに、スケジュールされたジョブに UNC パスを使用します。 次に、例を示します。  
  `at 1:00pm my_backup \\\server\share`  
  次の構文は使用しないでください。 **x:** はユーザーによって作成された接続です。  
  `at 1:00pm my_backup x:`  
  ドライブ文字を使用して共有ディレクトリに接続する**at**コマンドをスケジュールする場合は、ドライブの使用が終了したときにドライブを切断する**at**コマンドを追加します。 ドライブが切断されていない場合は、割り当てられたドライブ文字をコマンドプロンプトで使用できません。
- 72時間後に停止するタスク  
  既定では、at コマンドを使用してスケジュールされたタスクは、72時間後**に**停止します。 レジストリを変更して、この既定値を変更できます。
  1.  レジストリエディター (regedit.exe) を起動します。
  2.  レジストリで次のキーを見つけてクリックします: **HKEY_LOCAL_MACHINE \system\currentcontrolset\services\schedule**
  3.  [編集] メニューの [値の追加] をクリックし、次のレジストリ値を追加します。値の名前: atTaskMaxHours データ型: reg_DWOrd Radix: Decimal 値 Data: 0。 値のデータフィールドの値が0の場合は、制限がないことを示します。 1 ~ 99 の値は、時間数を示します。
  **注意**
- レジストリを正しく編集しないと、システムが正常に動作しなくなる場合があります。 レジストリを変更する前に、コンピューター上の重要なデータのバックアップを作成する必要があります。
- タスクスケジューラと**at**コマンド  
  [スケジュールされたタスク] フォルダーを使用して、 **at**コマンドを使用して作成されたタスクの設定を表示または変更できます。 **At**コマンドを使用してタスクをスケジュールすると、タスクが [スケジュールされたタスク] フォルダーに、次のような名前で表示されます:**at3478**。 ただし、[スケジュールされたタスク] フォルダーを使用して at タスクを変更すると、通常のスケジュールされたタスクにアップグレードされます。 **At**コマンドからタスクが見えなくなり、at アカウントの設定が適用されなくなりました。 タスクのユーザーアカウントとパスワードを明示的に入力する必要があります。
  ## <a name="examples"></a>例
  マーケティングサーバーでスケジュールされているコマンドの一覧を表示するには、次のように入力します。

`at \\marketing`

Corp サーバーの id 番号が3のコマンドの詳細については、次のように入力してください。

`at \\corp 3`

Corp サーバーで実行されるように net share コマンドをスケジュールするには (午前 8:00) 次のように、リストをメンテナンスサーバー、Reports 共有ディレクトリ、および Corp .txt ファイルにリダイレクトします。

`at \\corp 08:00 cmd /c "net share reports=d:\marketing\reports >> \\maintenance\reports\corp.txt"`

マーケティングサーバーのハードドライブを5日おきに午前0時にテープドライブにバックアップするには、backup コマンドを含む Archive という名前の batch プログラムを作成し、実行するバッチプログラムをスケジュールします。次に、次のように入力します。

`at \\marketing 00:00 /every:5,10,15,20,25,30 archive`

現在のサーバーでスケジュールされているすべてのコマンドを取り消すには、 **at**スケジュール情報を次のようにオフにします。

`at /delete`

実行可能ファイル (.exe) ではないコマンドを実行するには、コマンドの前に**cmd/c**を使用して、次のように cmd.exe を読み込みます。

`cmd /c dir > c:\test.out`
