---
title: AD パフォーマンスチューニングにおけるハードウェアの考慮事項
description: AD パフォーマンスチューニングにおけるハードウェアの考慮事項
ms.topic: article
ms.author: timwi; chrisrob; herbertm; kenbrumf;  mleary; shawnrab
author: phstee
ms.date: 10/16/2017
ms.openlocfilehash: 0ec22e4c85dab5e76e61cea8a68d88d7fd37b14e
ms.sourcegitcommit: 53d526bfeddb89d28af44210a23ba417f6ce0ecf
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/06/2020
ms.locfileid: "87896250"
---
# <a name="hardware-considerations-in-adds-performance-tuning"></a>のハードウェアの考慮事項により、パフォーマンスチューニングが追加されます。

>[!Important]
> 以下は、 [Active Directory Domain Services の容量計画](https://go.microsoft.com/fwlink/?LinkId=324566)に関する記事で詳しく説明されている Active Directory ワークロードのために、サーバーハードウェアを最適化するための主な推奨事項と考慮事項の概要を示しています。 リーダーは、 [Active Directory Domain Services のキャパシティプランニング](https://go.microsoft.com/fwlink/?LinkId=324566)を検討して、これらの推奨事項に関する技術的な理解と影響を高めます。

## <a name="avoid-going-to-disk"></a>ディスクへの移動を避ける

Active Directory は、メモリと同じくらいの量のデータベースをキャッシュできます。 メモリからのページのフェッチは、メディアがスピンドルベースか SSD ベースかにかかわらず、物理メディアに移動するよりもはるかに高速です。 ディスク i/o を最小限に抑えるために、メモリを追加します。

-   Active Directory ベストプラクティスでは、DIT 全体をメモリに読み込むために十分な RAM を確保し、オペレーティングシステムやその他のインストールされているアプリケーション (ウイルス対策、バックアップソフトウェア、監視など) に対応することをお勧めします。

    -   レガシプラットフォームの制限事項については、「 [Windows server 2003 または windows 2000 server を実行しているドメインコントローラーでの Lsass.exe プロセスによるメモリ使用量](https://support.microsoft.com/kb/308356)」を参照してください。

    -   メモリの \\ 長期的な平均スタンバイキャッシュ有効期間 ( &gt; 30 分) パフォーマンスカウンターを使用します。

-   オペレーティングシステム、ログ、およびデータベースを別のボリュームに配置します。 DIT のすべてまたは大部分がキャッシュされた場合、キャッシュが安定した状態になると、これは関連性が低くなり、ストレージレイアウトの柔軟性が多少向上します。 DIT 全体がキャッシュされないシナリオでは、オペレーティングシステム、ログ、およびデータベースを別のボリュームに分割することが重要になります。

-   通常、DIT に対する i/o 比は、約90% の読み取りと書き込みの10% です。 書き込み i/o ボリュームが 10%-20% を大幅に超えるシナリオは、書き込みが多いと見なされます。 書き込みが多いシナリオでは、Active Directory キャッシュを活用することはできません。 ディレクトリに書き込まれるデータのトランザクションの持続性を保証するために、Active Directory ではディスク書き込みキャッシュは実行されません。 その代わりに、この操作を行わない明示的な要求がない限り、すべての書き込み操作がディスクにコミットされてから、操作の正常完了状態が返されます。 したがって、高速ディスク i/o は、Active Directory への書き込み操作のパフォーマンスにとって重要です。 これらのシナリオのパフォーマンスを向上させる可能性のあるハードウェアの推奨事項を次に示します。

    -   ハードウェア RAID コントローラー

    -   DIT およびログファイルをホストする低待機時間/高 RPM ディスクの数を増やします。

    -   コントローラーでの書き込みキャッシュ

-   ディスクサブシステムのパフォーマンスは、ボリュームごとに個別に確認してください。 ほとんどの Active Directory シナリオは主に読み取りに基づいているため、DIT をホストするボリュームの統計情報は検査するのが最も重要です。 ただし、オペレーティングシステムやログファイルのドライブを含め、残りのドライブの監視を見落とさないようにしてください。 記憶域がパフォーマンスのボトルネックにならないようにドメインコントローラーが適切に構成されているかどうかを判断するには、「記憶域サブシステムの標準ストレージに関する推奨事項」を参照してください。 多くの環境では、負荷の急激な増加や急増に対応できる十分なヘッドルームがあることを保証することが理念です。 これらのしきい値は警告しきい値であり、負荷の急激な増加や急増に対応するヘッドルームが制限され、クライアントの応答性が低下します。 簡単に言うと、これらのしきい値を超えても、短期間 (5 ~ 15 分) では悪くありません。ただし、これらの統計情報を使用して継続して実行されているシステムはデータベースを完全にキャッシュしておらず、過剰に調査する必要があります。

    -   Database = = &gt; Instances (lsass/ntdsa.dll) \\ I/o データベース読み取り平均待機時間 &lt; 15ms 秒

    -   Database = = &gt; Instances (lsass/ntdsa.dll) \\ I/o データベース読み取り数 &lt; 10

    -   Database = = &gt; Instances (lsass/ntdsa.dll) \\ I/o ログ書き込み平均待機時間 &lt; 10 ミリ秒

    -   Database = = &gt; Instances (lsass/ntdsa.dll) \\ i/o ログの書き込み数/秒–情報提供のみ。

        データの一貫性を維持するには、すべての変更をログに書き込む必要があります。 ここでは、適切な番号も不適切な数値もありません。これは、ストレージがサポートしている量の尺度にすぎません。

-   非ピーク時の負荷期間に対して、バックアップやウイルス対策スキャンなど、非コアディスク i/o 負荷を計画します。 また、Windows Server 2008 で導入された低優先度の i/o 機能をサポートするバックアップとウイルス対策ソリューションを使用して、Active Directory の i/o ニーズに対する競合を軽減します。

## <a name="dont-over-tax-the-processors"></a>プロセッサを消費しないようにする

十分な空きサイクルがないプロセッサは、実行のためにスレッドをプロセッサに取得するのに長い待機時間が発生する可能性があります。 多くの環境では、このようなシナリオでのクライアントの応答性への影響を最小限に抑えるために、負荷の急激な増加やスパイクに対応できる十分なヘッドルームがあることを保証することが理念となっています。 簡単に言うと、以下のしきい値を超えても、短期間 (5 ~ 15 分) には問題ありません。ただし、これらの統計を使用して継続的に実行されるシステムでは、異常な負荷に対応するためのヘッドルームは提供されず、過剰に課税されるシナリオに簡単に組み込むことができます。 しきい値を超えて一定期間使用されているシステムは、プロセッサの負荷を軽減する方法について調査する必要があります。

-   プロセッサを選択する方法の詳細については、「[サーバーハードウェアのパフォーマンスチューニング](../../hardware/index.md)」を参照してください。

-   CPU 負荷を軽減するために、ハードウェアの追加、負荷の最適化、クライアントの他の場所への接続、または環境からの負荷の削除を行います。

-   プロセッサ情報 ( \_ Total) \\ % Processor 使用率 &lt; 60% パフォーマンスカウンタを使用してください。

## <a name="avoid-overloading-the-network-adapter"></a>ネットワークアダプターの過負荷を回避する

プロセッサの場合と同様に、ネットワークアダプターが過剰に使用されると、送信トラフィックがネットワークに到達するまでの待機時間が長くなります。 Active Directory は、小さな受信要求を行い、クライアントシステムに返されるデータ量が比較的大きくなる傾向があります。 送信されたデータは、受信したデータを超えています。 多くの環境では、負荷の急激な増加や急増に対応できる十分なヘッドルームがあることを保証することが理念です。 このしきい値は、負荷の急激な増加や急増に対応するヘッドルームが制限され、クライアントの応答性が低下する警告しきい値です。 簡単に言うと、これらのしきい値を超えることは短時間 (5 ~ 15 分) では悪くありません。ただし、これらの統計情報を使用して継続的に実行されるシステムは過剰に課税されるため、調査する必要があります。

-   ネットワークサブシステムを調整する方法の詳細については、「[ネットワークサブシステムのパフォーマンスチューニング](../../../../networking/technologies/network-subsystem/net-sub-performance-top.md)」を参照してください。

-   Compare NetworkInterface ( \* ) \\ Bytes Sent/Sec with NetworkInterface ( \* ) \\ Current 帯域幅パフォーマンスカウンタを使用します。 比率は、使用率が60% 未満である必要があります。

## <a name="additional-references"></a>その他の参照情報
- [Active Directory サーバーのパフォーマンス チューニング](index.md)
- [LDAP に関する考慮事項](ldap-considerations.md)
- [ドメイン コントローラーとサイトの適切な配置に関する考慮事項](site-definition-considerations.md)
- [ADDS パフォーマンスのトラブルシューティング](troubleshoot.md)
- [Active Directory Domain Services のキャパシティ プランニング](https://go.microsoft.com/fwlink/?LinkId=324566)