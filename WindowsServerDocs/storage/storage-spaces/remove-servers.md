---
title: 記憶域スペース ダイレクトでのサーバーの削除
ms.assetid: 9d8499a7-1307-473d-9f00-8a051164fad2
ms.author: cosdar
manager: eldenc
ms.topic: article
author: cosmosdarwin
description: Windows Server で記憶域スペース ダイレクト クラスターからサーバーを削除する方法。
ms.date: 2/5/2017
ms.localizationpriority: medium
ms.openlocfilehash: cc6ca368be71b24b8a552051c6edc2b7220dd57b
ms.sourcegitcommit: dfa48f77b751dbc34409aced628eb2f17c912f08
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/07/2020
ms.locfileid: "87971069"
---
# <a name="removing-servers-in-storage-spaces-direct"></a>記憶域スペース ダイレクトでのサーバーの削除

>適用先:Windows Server 2019、Windows Server 2016

このトピックでは、PowerShell を使って[記憶域スペース ダイレクト](storage-spaces-direct-overview.md)でサーバーを削除する方法について説明します。

## <a name="remove-a-server-but-leave-its-drives"></a>ドライブを残したままのサーバーの削除

サーバーをすぐにクラスターに戻す場合や、そのドライブを別のサーバーに移動して保持する場合、ドライブを記憶域プールから削除*せずに*サーバーをクラスターから削除できます。 フェールオーバー クラスター マネージャーを使ってサーバーを削除する場合、これは既定の動作です。

PowerShell で [Remove-ClusterNode](/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/hh831694(v=ws.11)) コマンドレットを使います。

```PowerShell
Remove-ClusterNode <Name>
```

記憶域プールは削除されたドライブを "記憶" し、戻ってくることを予期しているため、このコマンドレットは容量の考慮事項に関係なくすぐに成功します。 削除されたドライブからなくなるデータはありません。 削除されたままですが、**OperationalStatus** を実行すると "通信の切断" と表示され、ボリュームは "不完全" と表示されます。

ドライブが戻ると、新しいサーバーに移動した場合でも自動的に検出されてプールに再度関連付けられます。

   >[!WARNING]
   > プール データを含むドライブを 1 つのサーバーから他の複数のサーバーに分散しないでください。 たとえば、ドライブを 10 台搭載する 1 台のサーバーで障害が発生した場合 (マザーボードやブート ドライブで障害が発生した場合など)、10 台のドライブすべてを新しいサーバーに移動することが**できます**が、各ドライブを異なるサーバーに別個に移動することは**できません**。

## <a name="remove-a-server-and-its-drives"></a>サーバーとそのドライブの削除

クラスターからサーバーを完全に削除する場合 (スケール インと呼ばれることがあります)、サーバーをクラスターから削除し、*かつ*そのドライブを記憶域プールから削除することができます。

オプションの **-CleanUpDisks** フラグを設定して **Remove-ClusterNode** コマンドレットを使います。

```PowerShell
Remove-ClusterNode <Name> -CleanUpDisks
```

Windows はそのサーバーに保存されたデータをすべてクラスター内の他のサーバーに移動する必要があるため、このコマンドレットの実行には時間がかかることがあります (場合によっては数時間)。 この処理が完了すると、ドライブは記憶域プールから完全に削除され、影響を受けるボリュームが正常な状態に戻ります。

### <a name="requirements"></a>要件

完全にスケール イン (サーバー*と*そのドライブを削除) するには、クラスターが次の 2 つの要件を満たしている必要があります。 満たしていない場合、**Remove-ClusterNode -CleanUpDisks** コマンドレットは、中断を最小限に抑えるため、データ移動を開始する前にすぐにエラーを返します。

#### <a name="enough-capacity"></a>十分な容量

まず、すべてのボリュームに対応するために、残りのサーバーに十分な記憶域容量が必要です。

たとえば、サーバーが 4 台 (それぞれ 1 TB のドライブを 10 台搭載) ある場合、物理的な記憶域の合計容量は 40 TB です。 1 台のサーバーとそのドライブをすべて削除すると、残りの容量は 30 TB になります。 ボリュームのフットプリントが合計で 30 TB を超える場合、残りのサーバーに収まらないため、コマンドレットによりエラーが返され、データは削除されません。

#### <a name="enough-fault-domains"></a>十分な障害ドメイン

次に、ボリュームの回復性を実現するのに十分な障害ドメイン (通常はサーバー) が必要です。

たとえば、ボリュームが回復性のためにサーバー レベルで 3 方向ミラーリングを使っている場合、サーバーが 3 台以上ないと完全に正常な状態にはなりません。 サーバーがちょうど 3 台の場合に、1 台のサーバーとそのドライブをすべて削除しようとすると、コマンドレットによりエラーが返され、データは削除されません。

次の表に、回復性の種類ごとに必要な障害ドメインの最小数を示します。

|    回復性          |    最低限必要な障害ドメイン   |
|------------------------|-------------------------------------|
|    双方向ミラー      |    2                                |
|    3 方向ミラー    |    3                                |
|    デュアル パリティ         |    4                                |

   >[!NOTE]
   > 障害発生時やメンテナンス時など、短期的にサーバーが減ってもかまいません。 しかし、ボリュームが完全に正常な状態に戻るには、上に示したサーバーの最小数が必要です。

## <a name="additional-references"></a>その他の参照情報

- [記憶域スペース ダイレクトの概要](storage-spaces-direct-overview.md)
