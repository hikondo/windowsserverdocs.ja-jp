---
title: フォルダー リダイレクトと移動ユーザー プロファイル用のプライマリ コンピューターを展開する
description: フォルダー リダイレクトと移動ユーザー プロファイルで、プライマリ コンピューターのサポートを有効にし、ユーザーのプライマリ コンピューターを指定する方法。
ms.topic: article
author: JasonGerend
ms.author: jgerend
ms.date: 06/06/2019
ms.localizationpriority: medium
ms.openlocfilehash: 488a82d7ea4081acbca07f2f699e001f0945d6ce
ms.sourcegitcommit: 5344adcf9c0462561a4f9d47d80afc1d095a5b13
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/18/2020
ms.locfileid: "90766655"
---
# <a name="deploy-primary-computers-for-folder-redirection-and-roaming-user-profiles"></a>フォルダー リダイレクトと移動ユーザー プロファイル用のプライマリ コンピューターを展開する

>適用先:Windows 10、Windows 8、Windows 8.1、Windows Server 2019、Windows Server 2016、Windows Server 2012、Windows Server 2012 R2

このトピックでは、プライマリ コンピューターのサポートを有効にし、ユーザーのプライマリ コンピューターを指定する方法について説明します。 これを行うと、フォルダー リダイレクトと移動ユーザー プロファイルを使用するコンピューターを制御できるようになります。

> [!IMPORTANT]
> 移動ユーザー プロファイルに対してプライマリ コンピューターのサポートを有効にする場合は、必ずフォルダー リダイレクトでもプライマリ コンピューターのサポートを有効にしてください。 これで、ドキュメントやその他のユーザー ファイルがユーザー プロファイルから除外されます。こうすると、プロファイルが小さいままとなり、高速なサインオンが維持されます。

## <a name="prerequisites"></a>前提条件

## <a name="software-requirements"></a>ソフトウェア要件

プライマリ コンピューターのサポートには、次の要件があります。

- Windows Server 2012 スキーマを追加できるように、Active Directory Domain Services (AD DS) スキーマを更新する必要があります (このスキーマは、Windows Server 2012 ドメイン コントローラーをインストールすると自動的に更新されます)。 AD DS スキーマの更新については、「[Adprep.exe の統合](</previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/hh472161(v=ws.11)#adprepexe-integration>)」と「[Adprep.exe の実行](</previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/dd464018(v=ws.10)>)」を参照してください。
- クライアント コンピューターでは、Windows 10、Windows 8.1、Windows 8、Windows Server 2019、Windows Server 2016、Wndows Server 2012 R2、または Windows Server 2012 を実行している必要があります。

> [!TIP]
> プライマリ コンピューターのサポートにはフォルダー リダイレクトまたは移動ユーザー プロファイル (あるいはその両方) が必要ですが、これらのテクノロジを初めて採用する場合は、フォルダー リダイレクトと移動ユーザー プロファイルを構成する GPO を有効にする前に、プライマリ コンピューターのサポートを設定するのが最良の方法です。 これにより、プライマリ コンピューターのサポートが有効にされる前に、ユーザー データがプライマリでないコンピューターにコピーされることを防ぎます。 構成情報については、[フォルダー リダイレクトの展開](deploy-folder-redirection.md)に関する記事と「[移動ユーザー プロファイルを展開する](deploy-roaming-user-profiles.md)」を参照してください。

## <a name="step-1-designate-primary-computers-for-users"></a>手順 1:ユーザーのプライマリ コンピューターを指定する

プライマリ コンピューターのサポートを展開する際の最初の手順は、各ユーザーのプライマリ コンピューターを指定することです。 これを行うには、Active Directory 管理センターを使用して、関連するコンピューターの識別名を取得し、**msDs-PrimaryComputer** 属性を設定します。

> [!TIP]
> Windows PowerShell を使用してプライマリ コンピューターを操作する場合は、ブログ投稿「[Windows 8 のプライマリ コンピューターをもう少し深く掘り下げる](/archive/blogs/askds/digging-a-little-deeper-into-windows-8-primary-computer)」を参照してください。

ユーザーのプライマリ コンピューターを指定する方法を次に示します。

1. Active Directory 管理センターがインストールされているコンピューターで、サーバー マネージャーを開きます。
2. **[ツール]** メニューの **[Active Directory Administration Center]\(Active Directory 管理センター\)** を選択します。 Active Directory 管理センターが表示されます。
3. 適切なドメインの **[コンピューター]** コンテナーに移動します。
4. プライマリ コンピューターとして指定するコンピューターを右クリックし、 **[プロパティ]** を選択します。
5. ナビゲーション ウィンドウで、 **[拡張機能]** を選択します。
6. **[属性エディター]** タブを選択して、 **[distinguishedName]** までスクロールし、 **[表示]** を選択して、示された値を右クリックし、 **[コピー]** を選択して、 **[OK]** を選択してから、 **[キャンセル]** を選択します。
7. 適切なドメインの **[ユーザー]** コンテナーに移動し、コンピューターに割り当てるユーザーを右クリックして **[プロパティ]** を選択します。
8. ナビゲーション ウィンドウで、 **[拡張機能]** を選択します。
9. **[属性エディター]** タブを選択して、 **[msDs-PrimaryComputer]** を選択し、 **[編集]** を選択します。 [複数値の文字列エディター] ダイアログ ボックスが表示されます。
10. テキスト ボックスを右クリックして、 **[貼り付け]** を選択し、 **[追加]** を選択して、 **[OK]** を選択してから、再度 **[OK]** を選択します。

## <a name="step-2-optionally-enable-primary-computers-for-folder-redirection-in-group-policy"></a>手順 2:必要に応じてグループ ポリシーでフォルダー リダイレクトに対してプライマリ コンピューターを有効にする

次の手順では、必要に応じてグループ ポリシーを構成して、フォルダー リダイレクトに対してプライマリ コンピューターのサポートを有効にします。 これにより、他のコンピューター上ではなく、ユーザーのプライマリ コンピューターとして指定されているコンピューター上で、ユーザーのフォルダーをリダイレクトできるようになります。 コンピューターまたはユーザーごとに、フォルダー リダイレクトのプライマリ コンピューターを制御できます。

フォルダー リダイレクトに対してプライマリ コンピューターを有効にする方法を次に示します。

1. グループ ポリシーの管理で、フォルダー リダイレクトまたは移動ユーザー プロファイル (あるいはその両方) の初期構成を行ったときに作成した GPO (たとえば、**Folder Redirection Settings** や **Roaming User Profiles Settings**) を右クリックし、 **[編集]** を選択します。
2. コンピューターベースのグループ ポリシーを使用してプライマリ コンピューターのサポートを有効にするには、 **[コンピューターの構成]** に移動します。 ユーザーベースのグループ ポリシーの場合は、 **[ユーザーの構成]** に移動します。
    - コンピューターベースのグループ ポリシーは、GPO が適用されるすべてのコンピューターにプライマリ コンピューターの処理を適用し、それらのコンピューターのすべてのユーザーに影響を与えます。
    - ユーザーベースのグループ ポリシーは、GPO が適用されるすべてのユーザー アカウントにプライマリ コンピューターの処理を適用し、それらのユーザーがサインオンするすべてのコンピューターに影響を与えます。
3. **[コンピューターの構成]** または **[ユーザーの構成]** で、 **[ポリシー]** 、 **[管理用テンプレート]** 、 **[システム]** 、 **[フォルダー リダイレクト]** の順に移動します。
4. **[プライマリ コンピューターでのみフォルダーをリダイレクトする]** を右クリックし、 **[編集]** を選択します。
5. **[有効]** を選択し、 **[OK]** を選択します。

## <a name="step-3-optionally-enable-primary-computers-for-roaming-user-profiles-in-group-policy"></a>手順 3:必要に応じてグループ ポリシーで移動ユーザー プロファイルに対してプライマリ コンピューターを有効にする

次の手順では、必要に応じてグループ ポリシーを構成して、移動ユーザー プロファイルに対してプライマリ コンピューターのサポートを有効にします。 これにより、他のコンピューター上ではなく、ユーザーのプライマリ コンピューターとして指定されているコンピューター上で、ユーザーのプロファイルがローミングできるようになります。

移動ユーザー プロファイルに対してプライマリ コンピューターを有効にする方法を次に示します。

1. フォルダー リダイレクトに対してプライマリ コンピューターのサポートをまだ有効にしていない場合は、有効にします。<br>これで、ドキュメントやその他のユーザー ファイルがユーザー プロファイルから除外されます。こうすると、プロファイルが小さいままとなり、高速なサインオンが維持されます。
2. グループ ポリシーの管理で、作成した GPO (たとえば、**Folder Redirection and Roaming User Profiles Settings**) を右クリックし、 **[編集]** を選択します。
3. **[コンピューターの構成]** 、 **[ポリシー]** 、 **[管理用テンプレート]** 、 **[システム]** 、 **[ユーザー プロファイル]** の順に移動します。
4. **[プライマリ コンピューターにのみ移動プロファイルをダウンロードする]** を右クリックし、 **[編集]** を選択します。
5. **[有効]** を選択し、 **[OK]** を選択します。

## <a name="step-4-enable-the-gpo"></a>手順 4:GPO を有効にする

フォルダー リダイレクトと移動ユーザー プロファイルの構成が完了したら、GPO をまだ有効にしていなければ、有効にします。 これにより、影響を受けるユーザーとコンピューターへの適用が許可されます。

フォルダー リダイレクトと移動ユーザー プロファイルの GPO を有効にする方法を次に示します。

1. [グループ ポリシーの管理] を開きます。
2. 作成した GPO を右クリックし、 **[リンクの有効化]** を選択します。 このメニュー項目の横にチェック ボックスが表示されます。

## <a name="step-5-test-primary-computer-function"></a>手順 5:プライマリ コンピューターの機能をテストする

プライマリ コンピューターのサポートをテストするには、プライマリ コンピューターにサインインし、そのフォルダーとプロファイルがリダイレクトされていることを確認してから、プライマリでないコンピューターにサインインして、そのフォルダーとプロファイルがリダイレクトされていないことを確認します。

プライマリ コンピューターの機能をテストする方法を次に示します。

1. フォルダー リダイレクトまたは移動ユーザー プロファイル (あるいはその両方) を有効にしたユーザー アカウントで、指定されたプライマリ コンピューターにサインインします。
2. ユーザー アカウントが以前にコンピューターにサインオンしている場合は、管理者として Windows PowerShell セッションまたはコマンド プロンプト ウィンドウを開き、次のコマンドを入力して、最新のグループ ポリシー設定がクライアント コンピューターに適用されることを確認するメッセージが表示されたら、サインオフします。

    ```PowerShell
    Gpupdate /force
    ```

3. エクスプローラーを開きます。
1. リダイレクトされたフォルダー (ドキュメント ライブラリの [マイ ドキュメント] フォルダーなど) を右クリックし、 **[プロパティ]** を選択します。
1. **[場所]** タブを選択し、パスにローカル パスではなく、自分が指定したファイル共有が表示されていることを確認します。 ユーザー プロファイルが移動であることを確認するには、 **[コントロール パネル]** を開き、 **[システムとセキュリティ]** 、 **[システム]** 、 **[システムの詳細設定]** の順に選択し、[ユーザー プロファイル] セクションの **[設定]** を選択して、 **[種類]** 列で **[移動]** を探します。
1. ユーザーのプライマリ コンピューターとして指定されていないコンピューターに、同じユーザー アカウントでサインインします。
1. 手順 2 から 5 を繰り返しますが、ローカル パスと、プロファイルの種類 **[ローカル]** を探します。

> [!NOTE]
> プライマリ コンピューターのサポートを有効にする前にコンピューターでフォルダーがリダイレクトされていた場合、そのフォルダーは、各フォルダーのフォルダー リダイレクト ポリシー設定で次の設定が構成されない限り、リダイレクトされたままになります: **[ポリシーが削除されたとき、フォルダーをローカルのユーザー プロファイルにリダイレクトする]** 。 同様に、特定のコンピューターで以前にローミングされていたプロファイルは、 **[種類]** 列に **[移動]** と表示されます。ただし、 **[状態]** 列は **[ローカル]** と表示されます。

## <a name="more-information"></a>説明を見る

- [オフライン ファイルを使用してフォルダー リダイレクトを展開する](deploy-folder-redirection.md)
- [移動ユーザー プロファイルを展開する](deploy-roaming-user-profiles.md)
- [フォルダー リダイレクト、オフライン ファイル、移動ユーザー プロファイルの概要](folder-redirection-rup-overview.md)
- [Windows 8 のプライマリ コンピューターをもう少し深く掘り下げる](/archive/blogs/askds/digging-a-little-deeper-into-windows-8-primary-computer)