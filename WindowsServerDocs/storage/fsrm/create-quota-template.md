---
title: クォータ テンプレートを作成する
description: この記事では、記憶領域の制限を定義するクォータ テンプレートを作成する方法を説明します。
ms.date: 7/7/2017
ms.prod: windows-server
ms.technology: storage
ms.topic: article
author: JasonGerend
manager: brianlic
ms.author: jgerend
ms.openlocfilehash: ad05d72098851e39bc245711b73e5ad721c5a784
ms.sourcegitcommit: 771db070a3a924c8265944e21bf9bd85350dd93c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/27/2020
ms.locfileid: "85473559"
---
# <a name="create-a-quota-template"></a>クォータ テンプレートを作成する

> 適用対象: Windows Server (半期チャネル)、Windows Server 2016、Windows Server 2012 R2、Windows Server 2012、Windows Server 2008 R2

*クォータ テンプレート*では、領域の制限、クォータの種類 (ハードまたはソフト)、および (任意で) クォータの使用率が定義されているしきい値のレベルに近づいたときに自動的に生成される通知のセットを定義します。

テンプレートからのみクォータを作成すると、個々のクォータで変更を繰り返し行うのではなく、テンプレートを更新することで、クォータを集中管理できます。 この機能は、すべての更新を 1 か所で集中して実行できるようにして、記憶域ポリシーの変更の実装を簡素化します。

## <a name="to-create-a-quota-template"></a>クォータ テンプレートを作成するには

1.  **[クォータの管理]** で、**[クォータのテンプレート]** ノードをクリックします。

2.  **[クォータのテンプレート]** を右クリックして **[クォータ テンプレートの作成]** をクリックするか、**[操作]** ウィンドウの **[クォータ テンプレートの作成]** をクリックします。 **[クォータ テンプレートの作成]** ダイアログ ボックスが表示されます。

3.  既存のテンプレートのプロパティをコピーし、それに基づいて新しいテンプレートを作成する場合は、**[クォータ テンプレートからのプロパティのコピー]** ドロップダウン リストから任意のテンプレートを選択します。 次に、**[コピー]** をクリックします。

    既存テンプレートのプロパティを使用する場合も、新しいテンプレートを作成する場合も、**[設定]** タブで次の値を変更または設定します。

4.  **[テンプレート名]** ボックスに、新しいテンプレートの名前を入力します。

5.  **[ラベル]** テキスト ボックスに、このテンプレートから取得されたクォータの横に表示する説明のラベルを入力します (省略可能)。

6.  **[空き領域の制限]** で、次の操作を行います。

    -   **[制限]** テキスト ボックスに数値を入力し、単位 (KB、MB、GB、または TB) を選択して、クォータの領域の制限を指定します。
    -   **[ハード クォータ]** または **[ソフト クォータ]** をクリックします (ハード クォータに設定した場合、領域の上限に到達すると、ユーザーがファイルを保存できなくなります。また、データの大きさが構成済みの各しきい値に達すると、通知が生成されます。 ソフト クォータは、クォータ制限を強制しませんが、構成済みのすべての通知を生成します)。

7.  次の手順で説明するように、クォータ テンプレートに対して 1 つ以上のしきい値の通知を構成できます (省略可能)。 使用するクォータ テンプレートのプロパティをすべて選択したら、**[OK]** をクリックしてテンプレートを保存します。

## <a name="setting-optional-notification-thresholds"></a>通知のしきい値を設定する (省略可能)

ファイル サーバー リソース マネージャーでは、ボリュームまたはフォルダーの記憶域が、定義されているしきい値レベルに到達したときに、管理者や特定のユーザーへの電子メール メッセージの送信、イベントの記録、コマンドやスクリプトの実行、レポートの生成を行うように設定できます。 各しきい値に対して 1 種類以上の通知を構成できます。また、任意のクォータ (またはクォータ テンプレート) に対して複数のしきい値を定義できます。 既定では、通知は生成されません。

たとえば、しきい値を構成して、フォルダーがそのクォータ制限の 85% に到達したときに 1 回、さらにクォータ制限に到達したときに 1 回、管理者とこれらの通知が必要であると思われるユーザーに電子メール メッセージを送信できます。 また、**dirquota.exe** コマンドを使用したスクリプトを実行して、しきい値に達した時点で自動的にクォータ制限の値を増やすこともできます。

> [!Important]
> 電子メール通知を送信して、実際のサーバー環境に適したパラメーターで記憶域レポートを構成するには、まずファイル サーバー リソース マネージャーの全般的なオプションを設定する必要があります 詳細については、「[ファイル サーバー リソース マネージャーのオプションを設定する](setting-file-server-resource-manager-options.md)」を参照してください。

**クォータしきい値到達時にファイル サーバー リソース マネージャーが生成する通知を構成するには**

1. **[クォータ テンプレートの作成]** ダイアログ ボックスの **[通知のしきい値]** で **[追加]** をクリックします。 **[しきい値の追加]** ダイアログ ボックスが表示されます。

2. 通知を生成するクォータ制限に対する使用率 (%) を設定するには

   **[使用率 (%) が次に達したら、通知を生成する]** テキスト ボックスに、通知のしきい値をクォータ制限に対する使用率 (% 単位) で入力します。 1 回目の通知のしきい値は、既定で 85% です。

3. 電子メール通知を構成するには

   **[電子メール メッセージ]** タブで、次のオプションを設定します。

   - しきい値に達したときに管理者に通知するには、**[次の管理者に電子メールを送信する]** チェック ボックスをオンにし、通知を受け取る管理者のアカウント名を入力します。 形式を使用 <em>account@domain</em> し、複数のアカウントを区切るにはセミコロンを使用します。
   - ファイルを保存してクォータのしきい値に達したユーザーに電子メールを送信するには、**[しきい値を超えたユーザーに電子メールを送信する]** チェック ボックスをオンにします。
   - メッセージを構成するには、用意されている既定の件名行とメッセージ本文を編集します。 角かっこで囲まれたテキストには、通知の原因となったクォータ イベントに関する変数情報が挿入されます。 たとえば、 ** \[ Source Io Owner \] **変数は、クォータしきい値に達したファイルを保存したユーザーの名前を挿入します。 テキストに追加の変数を挿入するには、**[変数の挿入]** をクリックします。
   - 追加のヘッダー ([差出人]、[Cc]、[Bcc]、[返信先] など) を構成するには、**[追加電子メール ヘッダー]** をクリックします。

4. イベントをログに記録するには

   **[イベント ログ]** タブで **[イベント ログへ警告を送信]** チェック ボックスをオンにし、既定のログ エントリを編集します。

5. コマンドまたはスクリプトを実行するには

   **[コマンド]** タブで、**[コマンドまたはスクリプトの実行]** チェック ボックスをオンにします。 次に、コマンドを入力するか、**[参照]** をクリックして、スクリプトが格納されている場所を指定します。 必要に応じて、コマンドの引数の入力、コマンドやスクリプト用の作業ディレクトリの選択、コマンド セキュリティ設定の変更を行うこともできます。

6. 1 つ以上の記憶域レポートを生成するには

   **[レポート]** タブで、**[レポートの生成]** チェック ボックスをオンにし、生成するレポートを選択します。 レポートの管理者向け電子メール受信者を 1 人以上選択したり、しきい値に達したユーザーにレポートを電子メールで送信したりすることもできます。

   レポートは、インシデント レポート用の既定の場所に保存されます。これは、**[ファイル サーバー リソース マネージャーのオプション]** ダイアログ ボックスで変更できます。

7. **[OK]** をクリックして通知のしきい値を保存します。

8. クォータ テンプレートに追加の通知のしきい値を構成する場合は、上の手順を繰り返します。

## <a name="additional-references"></a>その他のリファレンス

-   [クォータの管理](quota-management.md)
-    [ファイル サーバー リソース マネージャーのオプションを設定する](setting-file-server-resource-manager-options.md)
-   [クォータ テンプレートのプロパティを編集する](edit-quota-template-properties.md)
-   [コマンドライン ツール](command-line-tools.md)


