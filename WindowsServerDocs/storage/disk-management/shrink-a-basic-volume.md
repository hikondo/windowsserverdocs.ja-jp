---
title: ベーシック ボリュームを圧縮する
description: この記事では、ベーシック ボリュームを圧縮する方法について説明します。
ms.date: 06/07/2019
ms.prod: windows-server
ms.technology: storage
ms.topic: article
author: JasonGerend
manager: brianlic
ms.author: jgerend
ms.openlocfilehash: 2baf24ed656ef06d44dff93180701d25e6852500
ms.sourcegitcommit: 6aff3d88ff22ea141a6ea6572a5ad8dd6321f199
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/27/2019
ms.locfileid: "71385860"
---
# <a name="shrink-a-basic-volume"></a>ベーシック ボリュームを圧縮する

> **適用対象:** Windows 10、Windows 8.1、Windows Server (半期チャネル)、Windows Server 2019、Windows Server 2016、Windows Server 2012 R2、Windows Server 2012

プライマリ パーティションと論理ドライブが使用する領域は、同じディスク上の隣接する連続した領域に圧縮することによって減らすことができます。 たとえば、追加のパーティションが必要だが追加のディスクがない場合に、既存のパーティションをボリュームの最後から圧縮し、新しいパーティションとして使用できる新しい未割り当ての領域を作成することができます。 圧縮操作は、特定の種類のファイルがあるとブロックされる場合があります。 詳細については、「[その他の考慮事項](#additional-considerations)」をご覧ください。 

パーティションを圧縮する場合、新しい未割り当て領域を作成するために、ディスク上の通常のファイルは自動的に再配置されます。 パーティションを圧縮するためにディスクを再フォーマットする必要はありません。

> [!CAUTION]
> パーティションが、データ（データベース ファイルなど）を含む未処理のパーティション (つまり、ファイル システムがないパーティション) である場合、パーティションを圧縮すると、データが壊れる可能性があります。

## <a name="shrinking-a-basic-volume"></a>ベーシック ボリュームを圧縮する

> [!NOTE]
> 以下の手順を実行するには、少なくとも **Backup Operators** または **Administrators** グループのメンバーである必要があります。

#### <a name="to-shrink-a-basic-volume-using-the-windows-interface"></a>Windows インターフェイスを使用してベーシック ボリュームを圧縮するには

1.  ディスク マネージャーで、圧縮するベーシック ボリュームを右クリックします。

2.  **[ボリュームの圧縮]** をクリックします。

3.  画面に表示される手順に従って操作します。


> [!NOTE]
> 圧縮できるのは、ファイル システムがないベーシック ボリュームまたは NTFS ファイル システムを使用するベーシック ボリュームのみです。

#### <a name="to-shrink-a-basic-volume-using-a-command-line"></a>コマンド ラインを使用してベーシック ボリュームを圧縮するには

1.  コマンド プロンプトを開き、「`diskpart`」と入力します。

2.  **DISKPART** プロンプトで、「`list volume`」と入力します。 圧縮するシンプル ボリュームの番号を書き留めておきます。

3.  **DISKPART** プロンプトで、「`select volume <volumenumber>`」と入力します。 圧縮するシンプル ボリュームの*ボリューム番号*を選択します。

4.  **DISKPART** プロンプトで、「`shrink [desired=<desiredsize>] [minimum=<minimumsize>]`」と入力します。 選択したボリュームを、可能であればメガバイト (MB) 単位で *desiredsize* のサイズに圧縮します。*desiredsize* が大きすぎる場合は、*minimumsize* に圧縮します。

| Value             | 説明 |
| ---               | ----------- |
| **list volume** | すべてのディスク上のベーシック ボリュームとダイナミック ボリュームの一覧を表示します。 |
| **select volume** | <em>volumenumber</em> がボリューム番号である指定されたボリュームを選択し、そのボリュームにフォーカスを移動します。 ボリュームが指定されていない場合、**select** コマンドは、フォーカスがある現在のボリュームを一覧表示します。 番号、ドライブ文字、マウント ポイント パスでボリュームを指定できます。 ベーシック ディスクでボリュームを選択すると、対応するパーティションにフォーカスが移動します。 |
| **shrink** | フォーカスのあるボリュームを圧縮して、未割り当て領域を作成します。 データの損失は発生しません。 パーティションに移動できないファイル (ページ ファイルやシャドウ コピーの記憶域など) が含まれている場合は、そのボリュームは、移動できないファイルが配置されている位置まで圧縮されます。 |
| **desired=** <em>desiredsize</em> | 現在のパーティションに回復する領域の容量をメガバイト単位で指定します。 |
| **minimum=** <em>minimumsize</em> | 現在のパーティションに回復する領域の最小容量をメガバイト単位で指定します。 必要なサイズや最小サイズを指定しない場合、このコマンドはできる限り最大容量の領域を解放します。 |

## <a name="additional-considerations"></a>その他の考慮事項

-   パーティションを圧縮して特定のファイル (ページング ファイルやシャドウ コピーの記憶域など) を自動的に再配置することはできません、移動できないファイルが配置されている位置を越えて、割り当てられた領域を減らすことはできません。 圧縮操作に失敗した場合は、アプリケーション ログでイベント 259 を確認すると、移動できないファイルを特定できます。 圧縮操作を妨げているファイルに関連付けられているクラスターがわかっている場合は、コマンド プロンプトで **fsutil** コマンド を使用することもできます (「**fsutil volume querycluster /?** 」と入力すると、 使い方がわかります)。 **querycluster** パラメーターを指定した場合、このコマンドの出力で、圧縮操作の正常な実行を妨げている、移動できないファイルが識別されます。
場合によっては、ファイルを一時的に移動することができます。 たとえば、さらにパーティションを縮小する必要がある場合、コントロール パネルを使用して、ページング ファイルまたは保存されたシャドウ コピーを別のディスクに移動し、保存されているシャドウ コピーを削除できます。ボリュームを圧縮した後、ページング ファイルをディスクに戻します。 動的不良クラスターの再マッピングによって検出された不良クラスターの数が多すぎる場合、パーティションを圧縮することはできません。 このような場合は、データの移動とディスクの交換を検討してください。

-  データ転送にブロック レベルのコピーは使用されません。 これを行うと、不良セクター テーブルがコピーされ、新しいディスクでは、不良セクターと同じセクターが正常であっても、不良セクターとして処理されます。

-   プライマリ パーティションと、未処理のパーティション (ファイル システムがないパーティション) または NTFS ファイル システムを使用するパーティション上の論理ドライブを圧縮できます。

## <a name="see-also"></a>参照

-   [ベーシック ボリュームを管理する](manage-basic-volumes.md)