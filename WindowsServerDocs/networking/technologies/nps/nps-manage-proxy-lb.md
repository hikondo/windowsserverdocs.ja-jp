---
title: NPS プロキシサーバーの負荷分散
description: このトピックでは、Windows Server 2016 と Windows 10 VPN の機能について説明します。
ms.topic: article
ms.assetid: 528280e6-b47e-489f-b310-b257d434aa0d
manager: brianlic
ms.author: lizross
author: eross-msft
ms.openlocfilehash: ee552c0202bff26cdcc58411b64cb342a4c7409e
ms.sourcegitcommit: 68444968565667f86ee0586ed4c43da4ab24aaed
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/07/2020
ms.locfileid: "87996458"
---
# <a name="nps-proxy-server-load-balancing"></a>NPS プロキシサーバーの負荷分散

適用先:Windows Server 2016

仮想プライベートネットワーク (VPN) サーバーやワイヤレスアクセスポイントなどのネットワークアクセスサーバーであるリモート認証ダイヤルインユーザーサービス (RADIUS) クライアントは、接続要求を作成し、NPS などの RADIUS サーバーに送信します。 場合によっては、NPS が一度に受信する接続要求が多すぎると、パフォーマンスが低下したり、過負荷になったりすることがあります。 NPS が過負荷になっている場合は、ネットワークに NPSs を追加し、負荷分散を構成することをお勧めします。 着信接続要求を複数の NPSs に均等に分散して、1つ以上の NPSs の過負荷を回避する場合は、負荷分散と呼ばれます。

負荷分散は、次の場合に特に便利です。

- 拡張認証プロトコル-トランスポート層セキュリティ (eap-tls \( \) または保護された拡張認証プロトコル) を使用して \( \) 認証を行う組織。 これらの認証方法では、サーバー認証に証明書が使用され、ユーザーまたはクライアントコンピューターの認証には、パスワードベースの認証方法よりも負荷が高くなります。
- 継続的なサービスの可用性を維持する必要がある組織。
- \( \) 他の組織の VPN アクセスをアウトソーシングするインターネットサービスプロバイダーの isp。 外部 VPN サービスでは、大量の認証トラフィックが発生する可能性があります。

NPSs に送信される接続要求の負荷を分散するには、次の2つの方法を使用できます。

- 複数の RADIUS サーバーに接続要求を送信するようにネットワークアクセスサーバーを構成します。 たとえば、20個のワイヤレスアクセスポイントと2台の RADIUS サーバーがある場合、両方の RADIUS サーバーに接続要求を送信するように各アクセスポイントを構成します。 各ネットワークアクセスサーバーで、複数の RADIUS サーバーに接続要求を送信するように、指定した優先順位でアクセスサーバーを構成することにより、負荷分散とフェールオーバーを行うことができます。 この負荷分散の方法は、通常、多数の RADIUS クライアントを展開しない小規模な組織に最適です。
- RADIUS プロキシとして構成された NPS を使用して、複数の NPSs または他の RADIUS サーバー間の接続要求を負荷分散します。 たとえば、100のワイヤレスアクセスポイント、1つの NPS プロキシ、および3台の RADIUS サーバーがある場合、すべてのトラフィックを NPS プロキシに送信するようにアクセスポイントを構成できます。 NPS プロキシで、プロキシが3つの RADIUS サーバー間の接続要求を均等に分散するように、負荷分散を構成します。 この負荷分散方法は、RADIUS クライアントとサーバーが多数ある中規模および大規模な組織に最適です。

多くの場合、負荷分散に最適な方法は、RADIUS クライアントが2つの NPS プロキシサーバーに接続要求を送信するように構成してから、RADIUS サーバー間で負荷を分散するように NPS プロキシを構成することです。 この方法では、NPS プロキシと RADIUS サーバーのフェールオーバーと負荷分散の両方が可能です。

## <a name="radius-server-priority-and-weight"></a>RADIUS サーバーの優先度と重み

NPS プロキシの構成プロセス中に、リモート RADIUS サーバーグループを作成し、各グループに RADIUS サーバーを追加することができます。 負荷分散を構成するには、リモート RADIUS サーバーグループごとに複数の RADIUS サーバーが必要です。 グループメンバーを追加するとき、またはグループメンバーとして RADIUS サーバーを作成した後で、[RADIUS サーバーの追加] ダイアログボックスにアクセスして、[負荷分散] タブで次の項目を構成できます。

- **優先順位**。 Priority RADIUS サーバーと NPS プロキシサーバーの重要度の順序を指定します。 優先度レベルには、1、2、3などの整数の値を割り当てる必要があります。 数値が小さいほど、NPS プロキシが RADIUS サーバーに与える優先順位が高くなります。 たとえば、RADIUS サーバーに優先順位1の最高値が割り当てられている場合、NPS プロキシはまず RADIUS サーバーに接続要求を送信します。優先順位1のサーバーが使用できない場合、NPS は、優先度2の RADIUS サーバーに接続要求を送信します。 同じ優先順位を複数の RADIUS サーバーに割り当ててから、[重み] 設定を使用してそれらの間で負荷を分散することができます。

- **Weight**。 NPS はこの重み設定を使用して、グループメンバーの優先順位が同じである場合に、各グループメンバーに送信する接続要求の数を決定します。 重みの設定には、1 ~ 100 の範囲の値を指定する必要があります。また、値は100% の比率を表します。 たとえば、リモート RADIUS サーバーグループに、優先度レベルが1で重みが50の2つのメンバーが含まれている場合、NPS プロキシは、接続要求の50% を各 RADIUS サーバーに転送します。

- **詳細設定**。 これらのフェールオーバー設定は、NPS がリモート RADIUS サーバーを使用できないかどうかを判断するための方法を提供します。 NPS が RADIUS サーバーを使用できないと判断した場合は、他のグループメンバーへの接続要求の送信を開始できます。 これらの設定を使用して、NPS プロキシが要求を破棄したと見なす前に RADIUS サーバーからの応答を待機する秒数を構成できます。NPS プロキシが RADIUS サーバーを使用不可と識別するまでに削除された要求の最大数。また、NPS プロキシが RADIUS サーバーを使用不可と識別する前に、要求の間に経過する秒数。

## <a name="configure-nps-proxy-load-balancing"></a>NPS プロキシの負荷分散を構成する

負荷分散を構成する前に、必要なリモート RADIUS サーバーグループの数、各グループのメンバーであるサーバー、および各サーバーの優先度と重みの設定を含む展開計画を作成します。

>[!NOTE]
>次の手順では、既に RADIUS サーバーを展開および構成していることを前提としています。

NPS をプロキシサーバーとして動作し、RADIUS クライアントからリモート RADIUS サーバーに接続要求を転送するように構成するには、次の操作を行う必要があります。

1. RADIUS クライアントの \( VPN サーバー、ダイヤルアップサーバー、ターミナルサービスゲートウェイサーバー、802.1 x 認証スイッチ、および 802.1 x ワイヤレスアクセスポイントを展開 \) し、NPS プロキシサーバーに接続要求を送信するように構成します。

2. NPS プロキシで、ネットワークアクセスサーバーを RADIUS クライアントとして構成します。 詳細については、「 [CONFIGURE RADIUS Clients](./nps-radius-clients-configure.md)」を参照してください。

3. NPS プロキシで、1つまたは複数のリモート RADIUS サーバーグループを作成します。 このプロセスでは、RADIUS サーバーをリモート RADIUS サーバーグループに追加します。 詳細については、「[リモート RADIUS サーバーグループの構成](./nps-crp-rrsg-configure.md)」を参照してください。

4. NPS プロキシで、リモート RADIUS サーバーグループに追加する RADIUS サーバーごとに、[RADIUS サーバーの**負荷分散**] タブをクリックし、[**優先順位**]、[**重み**]、[**詳細設定**] を構成します。

5. NPS プロキシで、リモート RADIUS サーバーグループに認証要求およびアカウンティング要求を転送するように接続要求ポリシーを構成します。 リモート RADIUS サーバーグループごとに1つの接続要求ポリシーを作成する必要があります。 詳細については、「[接続要求ポリシーの構成](./nps-crp-configure.md)」を参照してください。