---
title: ネットワーク ポリシー サーバーのベスト プラクティス
description: このトピックでは、Windows Server 2016 でネットワークポリシーサーバーを展開および管理するためのベストプラクティスについて説明します。
manager: brianlic
ms.prod: windows-server-threshold
ms.technology: networking
ms.topic: article
ms.assetid: 90e544bd-e826-4093-8c3b-6a6fc2dfd1d6
ms.author: pashort
author: shortpatti
ms.openlocfilehash: a0bfa96e5fb3b562c23904ebef096d06e0c2d3c8
ms.sourcegitcommit: 0467b8e69de66e3184a42440dd55cccca584ba95
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/16/2019
ms.locfileid: "69546544"
---
# <a name="network-policy-server-best-practices"></a>ネットワーク ポリシー サーバーのベスト プラクティス

>適用対象:Windows Server (半期チャネル)、Windows Server 2016

このトピックでは、ネットワークポリシーサーバー \(NPS\)を展開および管理するためのベストプラクティスについて説明します。

以下のセクションでは、NPS の展開のさまざまな側面に関するベストプラクティスについて説明します。

## <a name="accounting"></a>アカウンティング

NPS のログ記録のベストプラクティスを次に示します。

NPS には、次の2種類のアカウンティング (ログ記録) があります。

- NPS のイベントログ。 イベントログを使用して、システムおよびセキュリティイベントログに NPS イベントを記録できます。 これは主に、接続試行の監査とトラブルシューティングに使用されます。

- ユーザー認証およびアカウンティング要求をログに記録します。 ユーザー認証およびアカウンティング要求をテキスト形式またはデータベース形式でログファイルに記録することも、SQL Server 2000 データベースのストアドプロシージャにログを記録することもできます。 要求ログは、主に接続分析と課金の目的で使用されます。また、セキュリティ調査ツールとしても役立ち、攻撃者のアクティビティを追跡する方法を提供します。

NPS のログ記録を最も効果的に使用するには、次のようにします。

- 認証レコードと\(アカウンティング\)レコードの両方について、最初にログ記録をオンにします。 環境に適した設定を決定したら、これらの選択を変更します。

- イベントログが、ログを保持するのに十分な容量で構成されていることを確認します。

- すべてのログファイルを定期的にバックアップします。これらのファイルは、破損または削除されたときに再作成することはできません。

- RADIUS クラス属性を使用して、使用状況を追跡し、使用量に対して課金する部署またはユーザーの識別を簡略化します。 自動的に生成されたクラス属性は要求ごとに一意ですが、アクセスサーバーへの応答が失われ、要求が再送信される場合、重複するレコードが存在する可能性があります。 使用状況を正確に追跡するには、ログから重複する要求を削除する必要がある場合があります。

- ネットワークアクセスサーバーと RADIUS プロキシサーバーが、nps がオンラインであることを確認するために、架空の接続要求メッセージを NPS に定期的に送信する場合は、 **ping ユーザー名**レジストリ設定を使用します。 この設定は、NPS がこれらの偽の接続要求を処理せずに自動的に拒否するように構成します。 さらに、NPS は、架空のユーザー名を含むトランザクションをログファイルに記録しないため、イベントログの解釈が容易になります。

- NAS の通知転送を無効にします。 ネットワークアクセスサーバー (Nas) から、NPS で構成されているリモート RADIUS サーバーグループのメンバーへの開始および停止メッセージの転送を無効にすることができます。 詳細については、「 [DISABLE NAS Notification フォワーディング](nps-disable-nas-notifications.md)」を参照してください。

詳細については、「[ネットワークポリシーサーバーアカウンティングの構成](nps-accounting-configure.md)」を参照してください。

- SQL Server のログ記録を使用してフェールオーバーと冗長性を実現するには、SQL Server を実行する2台のコンピューターを別々のサブネットに配置します。 **パブリケーションの作成ウィザード**を使用して、2つのサーバー間のデータベースのレプリケーションを設定 SQL Server ます。 詳細については、 [SQL Server 技術ドキュメント](https://msdn.microsoft.com/library/ms130214.aspx)と[SQL Server レプリケーション](https://msdn.microsoft.com/library/ms151198.aspx)を参照してください。

## <a name="authentication"></a>認証

認証のベストプラクティスを次に示します。

- 強力な認証には、保護された拡張認証\(プロトコル\)の PEAP および拡張\(認証\)プロトコル EAP などの証明書ベースの認証方法を使用します。 パスワードのみの認証方法は、さまざまな攻撃に対して脆弱であり、セキュリティで保護されていないため、使用しないでください。 セキュリティで保護されたワイヤレス\-認証\-の場合、NPS はサーバー証明書を使用してワイヤレスクライアントに対して id を証明し、ユーザーはユーザー名とパスワードを使用して身元を証明するため、PEAP MS CHAP v2 を使用することをお勧めします。  ワイヤレス展開での NPS の使用の詳細については、「[パスワードベースの 802.1 x 認証ワイヤレスアクセスの展開](https://technet.microsoft.com/windows-server-docs/networking/core-network-guide/cncg/wireless/a-deploy-8021x-wireless-access)」を参照してください。
- PEAP や EAP などの\(強力な証明&reg;書ベースの認証方法を使用する場合は、Active Directory 証明書サービス\(AD CS\)を使用して独自の証明機関 CA\)を展開します。NPSs でサーバー証明書を使用する必要があります。 また、CA を使用して、コンピューター証明書とユーザー証明書を登録することもできます。 NPS とリモートアクセスサーバーにサーバー証明書を展開する方法の詳細については、「 [802.1 x ワイヤードおよびワイヤレス展開用のサーバー証明書の展開](https://technet.microsoft.com/windows-server-docs/networking/core-network-guide/cncg/server-certs/deploy-server-certificates-for-802.1x-wired-and-wireless-deployments)」を参照してください。

> [!IMPORTANT]
> ネットワークポリシーサーバー (NPS) では、パスワード内の拡張 ASCII 文字の使用はサポートされていません。

## <a name="client-computer-configuration"></a>クライアントコンピューターの構成

クライアントコンピューターの構成のベストプラクティスを次に示します。

- グループポリシーを使用して、すべてのドメインメンバー 802.1 X クライアントコンピューターを自動的に構成します。 詳細については、「[ワイヤレスアクセスの展開](https://technet.microsoft.com/windows-server-docs/networking/core-network-guide/cncg/wireless/e-wireless-access-deployment#bkmk_policies)」の「ワイヤレスネットワーク (IEEE 802.11) ポリシーの構成」セクションを参照してください。

## <a name="installation-suggestions"></a>インストールの推奨事項

次に、NPS をインストールするためのベストプラクティスを示します。

- NPS をインストールする前に、ローカル認証方法を使用して各ネットワークアクセスサーバーをインストールし、テストしてから、NPS で RADIUS クライアントとして構成します。

- NPS をインストールして構成した後、Windows PowerShell コマンド[Export-NpsConfiguration](https://technet.microsoft.com/library/jj872749.aspx)を使用して構成を保存します。 Nps を再構成するたびに、このコマンドを使用して NPS 構成を保存します。

>[!CAUTION]
>- エクスポートされた NPS 構成ファイルには、RADIUS クライアントおよびリモート RADIUS サーバーグループのメンバー用の暗号化されていない共有シークレットが含まれています。 このため、ファイルを安全な場所に保存してください。
>- エクスポートプロセスには、エクスポートされたファイルの Microsoft SQL Server のログ設定は含まれません。 エクスポートしたファイルを別の NPS にインポートする場合は、新しいサーバーで SQL Server ログを手動で構成する必要があります。

## <a name="performance-tuning-nps"></a>NPS のパフォーマンスチューニング

NPS のパフォーマンスチューニングのベストプラクティスを次に示します。

- NPS の認証と承認の応答時間を最適化し、ネットワークトラフィックを最小限に抑えるには、ドメインコントローラーに NPS をインストールします。

- ユニバーサルプリンシパル名\(upn\)または windows server 2008 および windows server 2003 ドメインが使用されている場合、NPS はグローバルカタログを使用してユーザーを認証します。 この処理にかかる時間を最小限に抑えるには、グローバルカタログサーバーまたはグローバルカタログサーバーと同じサブネット上にあるサーバーのどちらかに NPS をインストールします。

- リモート RADIUS サーバーグループを構成し、NPS の接続要求ポリシーで [**次のリモート radius サーバーグループのサーバーのアカウンティング情報を記録**する] チェックボックスをオフにした場合、これらのグループには引き続きネットワークアクセスが送信されます。サーバー \(NAS\)の通知メッセージを開始および停止します。 これにより、不要なネットワークトラフィックが作成されます。 このトラフィックを排除するには、 **[このサーバーへの通知を開始および停止する]** チェックボックスをオフにして、各リモート RADIUS サーバーグループ内の個々のサーバーの NAS 通知転送を無効にします。

## <a name="using-nps-in-large-organizations"></a>大規模な組織での NPS の使用

大規模な組織で NPS を使用する場合のベストプラクティスを次に示します。

- ネットワークポリシーを使用して、特定のグループに限定してアクセスを制限する場合は、アクセスを許可するすべてのユーザーに対してユニバーサルグループを作成し、このユニバーサルグループにアクセス権を付与するネットワークポリシーを作成します。 すべてのユーザーをユニバーサルグループに直接配置することは避けてください。ネットワーク上に多数のユーザーがいる場合は特にそうです。 代わりに、ユニバーサルグループのメンバーである個別のグループを作成し、それらのグループにユーザーを追加します。

- ユーザープリンシパル名を使用して、可能な限りユーザーを参照します。 ユーザーは、ドメインのメンバーシップに関係なく、同じユーザープリンシパル名を持つことができます。 これにより、多数のドメインを持つ組織で必要となるスケーラビリティが提供されます。

- ネットワークポリシーサーバー \(nps\)をドメインコントローラー以外のコンピューターにインストールし、nps が1秒あたりに多数の認証要求を受信している場合は、次の数を増やすことで nps のパフォーマンスを向上させることができます。NPS とドメインコントローラーの間で許可される同時認証。 詳細については、「 

## <a name="security-issues"></a>セキュリティの問題

セキュリティの問題を軽減するためのベストプラクティスを次に示します。

NPS をリモートで管理している場合は、機密データ (共有シークレットやパスワードなど) をプレーンテキストでネットワーク経由で送信しないでください。 NPSs のリモート管理には、次の2つの方法をお勧めします。

- リモートデスクトップサービスを使用して NPS にアクセスします。 リモートデスクトップサービスを使用すると、クライアントとサーバーの間でデータが送信されません。 サーバーのユーザーインターフェイス (オペレーティングシステムデスクトップ、NPS コンソールイメージなど) のみがリモートデスクトップサービスクライアントに送信されます。このクライアントには、Windows&reg; 10 でリモートデスクトップ接続という名前が付けられています。 クライアントは、リモートデスクトップサービス有効になっているサーバーによってローカルで処理される、キーボード入力とマウス入力を送信します。 リモートデスクトップサービスユーザーがログオンすると、サーバーによって管理され、互いに独立している個々のクライアントセッションのみを表示できます。 さらに、リモートデスクトップ接続は、クライアントとサーバーの間で128ビットの暗号化を提供します。

- インターネットプロトコルセキュリティ (IPsec) を使用して、機密データを暗号化します。 IPsec を使用すると、nps と nps の管理に使用しているリモートクライアントコンピューター間の通信を暗号化できます。 サーバーをリモートで管理するには、クライアントコンピューターに[Windows 10 用のリモートサーバー管理ツール](https://www.microsoft.com/download/details.aspx?id=45520)をインストールします。 インストール後、Microsoft 管理コンソール (MMC) を使用して、NPS スナップインをコンソールに追加します。

>[!IMPORTANT]
>Windows 10 Professional または Windows 10 Enterprise の完全リリースでのみ、Windows 10 のリモートサーバー管理ツールをインストールできます。

NPS の詳細については、「[ネットワークポリシーサーバー (nps)](nps-top.md)」を参照してください。

