---
title: PEAP と EAP の要件に合わせて証明書テンプレートを構成する
description: このトピックでは、Windows Server 2016 のネットワークポリシーサーバーとリモートアクセスで証明書を使用する方法について説明します。
manager: brianlic
ms.topic: article
ms.assetid: 2af0a1df-5c44-496b-ab11-5bc340dc96f0
ms.author: lizross
author: eross-msft
ms.openlocfilehash: 114b64b7bdcaae0643ee03ecc2ee0a67c3e24fba
ms.sourcegitcommit: 68444968565667f86ee0586ed4c43da4ab24aaed
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/07/2020
ms.locfileid: "87992684"
---
# <a name="configure-certificate-templates-for-peap-and-eap-requirements"></a>PEAP と EAP の要件に合わせて証明書テンプレートを構成する

>適用先:Windows Server (半期チャネル)、Windows Server 2016

拡張認証プロトコル \- トランスポート層セキュリティ \( \- (EAP TLS \) )、保護された拡張認証プロトコル \- トランスポート層セキュリティ \( Peap TLS、および PEAP Microsoft チャレンジハンドシェイク認証プロトコルバージョン 2 MS CHAP v2 を使用するネットワークアクセス認証に使用されるすべての証明書は、 \- \) \- \( \- \) X.509 証明書の要件を満たし、Secure Socket Layer/Transport Level security (SSL/TLS) を使用する接続で動作する必要 サーバーとクライアントの両方の証明書には、他の要件もあります。

>[!IMPORTANT]
>このトピックでは、証明書テンプレートを構成する手順について説明します。 これらの手順を使用するには、 \( \) Active Directory 証明書サービス AD CS を使用して、独自の公開キー基盤 PKI をデプロイしておく必要があり \( \) ます。

## <a name="minimum-server-certificate-requirements"></a>サーバー証明書の最小要件

\- \- 認証方法としての peap MS CHAP V2、peap \- tls、または EAP TLS を使用 \- する場合、NPS はサーバー証明書の最小要件を満たすサーバー証明書を使用する必要があります。

クライアントコンピューターは、クライアントコンピューターまたはグループポリシーで [**サーバー証明書の検証**] オプションを使用して、サーバー証明書を検証するように構成できます。

サーバー証明書が次の要件を満たしている場合、クライアントコンピューターはサーバーの認証試行を受け入れます。

- サブジェクト名に値が指定されていること。 空のサブジェクト名を持つネットワークポリシーサーバー (NPS) を実行しているサーバーに証明書を発行する場合、その証明書を使用して NPS を認証することはできません。 サブジェクト名を指定して証明書テンプレートを構成するには、次の手順に従います。

    1. [証明書テンプレート] を開きます。
    2. 詳細ウィンドウで、変更する証明書テンプレートを右クリックし、[**プロパティ**] をクリックします。
    3. [**サブジェクト名**] タブをクリックし、[**この Active Directory の情報から構築**する] をクリックします。
    4. [**サブジェクト名の形式**] で、[**なし**] 以外の値を選択します。

- サーバー上のコンピューター証明書は、信頼されたルート証明機関 (CA) にチェーンされており、CryptoAPI によって実行され、リモートアクセスポリシーまたはネットワークポリシーで指定されているチェックには失敗しません。

- NPS または VPN サーバーのコンピューター証明書は、拡張キー使用法 (EKU) の拡張機能でサーバー認証の目的で構成されています。 (サーバー認証のオブジェクト識別子は1.3.6.1.5.5.7.3.1 です)。

- 必要な暗号化設定を使用して、サーバー証明書を構成します。

    1. [証明書テンプレート] を開きます。
    2. 詳細ウィンドウで、変更する証明書テンプレートを右クリックし、[**プロパティ**] をクリックします。
    3. [**暗号化**] タブをクリックし、次の構成を行っていることを確認します。
       - **プロバイダーのカテゴリ:** キー記憶域プロバイダー
       - **アルゴリズム名:** おける
       - **プロバイダー:** Microsoft プラットフォーム暗号化プロバイダー
       - **最小キーサイズ:** 2048
       - **ハッシュアルゴリズム:** SHA2
    4. **[次へ]** をクリックします。

- サブジェクトの別名 (SubjectAltName) 拡張が使用されている場合は、これにサーバーの DNS 名が含まれていること。 登録サーバーのドメインネームシステム (DNS) 名を使用して証明書テンプレートを構成するには、次のようにします。

    1. [証明書テンプレート] を開きます。
    2. 詳細ウィンドウで、変更する証明書テンプレートを右クリックし、[**プロパティ**] をクリックします。
    3. [**サブジェクト名**] タブをクリックし、[**この Active Directory の情報から構築**する] をクリックします。
    4. [**代替サブジェクト名に次の情報を含める**] で、[ **DNS 名**] を選択します。

PEAP と EAP-TLS を使用する場合、NPSs には、コンピューターの証明書ストアにインストールされているすべての証明書の一覧が表示されます。ただし、次の例外があります。

- EKU 拡張にサーバー認証目的が含まれていない証明書は表示されません。

- サブジェクト名が指定されていない証明書は表示されません。

- レジストリ ベースの証明書と、スマート カードによるログオンの証明書は表示されません。

詳細については、「 [802.1 x ワイヤード (有線) およびワイヤレス展開用のサーバー証明書の展開](../../core-network-guide/cncg/server-certs/deploy-server-certificates-for-802.1x-wired-and-wireless-deployments.md)」を参照してください。

## <a name="minimum-client-certificate-requirements"></a>クライアント証明書の最小要件

EAP-TLS または PEAP-TLS を使用している場合、サーバーは、証明書が次の要件を満たしていると、クライアントによる認証の試みを受け入れます。

- クライアント証明書は、エンタープライズ CA によって発行されるか、Active Directory Domain Services AD DS のユーザーまたはコンピューターアカウントにマップされ \( \) ます。

- クライアントが信頼されたルート CA にチェーンしているユーザーまたはコンピューターの証明書には、EKU 拡張機能にクライアント認証が含まれています \( 。クライアント認証のオブジェクト識別子は 1.3.6.1.5.5.7.3.2 \) で、CryptoAPI によって実行されるチェックと、リモートアクセスポリシーまたはネットワークポリシーで指定されているチェックと、NPS ネットワークポリシーで指定されている

- 802.1X クライアントが、スマート カードによるログオンの証明書またはパスワードで保護された証明書のいずれかであるレジストリ ベースの証明書を使用していないこと。

- ユーザー証明書の場合、証明書のサブジェクト代替名 \( SubjectAltName 拡張機能には、 \) ユーザープリンシパル名 UPN が含まれ \( \) ます。 証明書テンプレートに UPN を構成するには、次の手順に従います。

    1. [証明書テンプレート] を開きます。
    2. 詳細ウィンドウで、変更する証明書テンプレートを右クリックし、[**プロパティ**] をクリックします。
    3. [**サブジェクト名**] タブをクリックし、[**この Active Directory の情報から構築**する] をクリックします。
    4. [**代替サブジェクト名に次の情報を含める**] で、[**ユーザープリンシパル名 \( UPN \) **] を選択します。

- コンピューター証明書の場合、証明書のサブジェクト代替名 \( SubjectAltName 拡張機能には、 \) クライアントの完全修飾ドメイン名 \( FQDN \) ( *DNS 名*とも呼ばれます) が含まれている必要があります。 証明書テンプレートにこの名前を構成するには、次の手順に従います。

    1. [証明書テンプレート] を開きます。
    2. 詳細ウィンドウで、変更する証明書テンプレートを右クリックし、[**プロパティ**] をクリックします。
    3. [**サブジェクト名**] タブをクリックし、[**この Active Directory の情報から構築**する] をクリックします。
    4. [**代替サブジェクト名に次の情報を含める**] で、[ **DNS 名**] を選択します。

PEAP \- tls および EAP TLS では、 \- クライアントは証明書スナップインにインストールされているすべての証明書の一覧を表示しますが、次の例外があります。

- ワイヤレス クライアントでは、レジストリ ベースの証明書とスマート カードによるログオンの証明書は表示されません。

- ワイヤレス クライアントと VPN クライアントでは、パスワードで保護された証明書は表示されません。

- EKU 拡張にクライアント認証目的が含まれていない証明書は表示されません。


NPS の詳細については、「[ネットワークポリシーサーバー (nps)](nps-top.md)」を参照してください。