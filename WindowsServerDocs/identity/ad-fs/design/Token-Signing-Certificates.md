---
ms.assetid: 98c5ef45-2bcb-4f87-86c8-5ac6c16a6097
title: トークン署名証明書
description: ''
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server
ms.technology: identity-adfs
ms.openlocfilehash: 02c126fe0792872298a5512abf850af41e1db826
ms.sourcegitcommit: 6aff3d88ff22ea141a6ea6572a5ad8dd6321f199
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/27/2019
ms.locfileid: "71407916"
---
# <a name="token-signing-certificates"></a>トークン署名証明書

フェデレーションサーバーでは\-、攻撃者によるフェデレーションリソースへの不正アクセスを防ぐために、トークン署名証明書が必要です。 \/トークン\-署名証明書で使用されるプライベート公開キーの組み合わせは、フェデレーションパートナーシップの最も重要な検証メカニズムです。これらのキーは、セキュリティトークンが有効なパートナーによって発行されたことを確認するためです。フェデレーションサーバーと、トークンが転送中に変更されていないこと。  
  
## <a name="token-signing-certificate-requirements"></a>トークン\-署名証明書の要件  
AD FS を\-操作するには、トークン署名証明書が次の要件を満たしている必要があります。  
  
-   トークン\-署名証明書がセキュリティトークンに正常に署名するには\-、トークン署名証明書に秘密キーが含まれている必要があります。  
  
-   AD FS サービスアカウントは、ローカルコンピューターの個人用ストア\-にあるトークン署名証明書の秘密キーにアクセスできる必要があります。 この処理は、セットアップによって行われます。 また、AD FS 管理スナップイン\-を使用して、後でトークン\-署名証明書を変更した場合にこのアクセスを確認することもできます。  
  
> [!NOTE]  
> これは、秘密キーを\(複数\)の目的で共有しないようにするための公開キー基盤 PKI のベストプラクティスです。 そのため、トークン\-署名証明書としてフェデレーションサーバーにインストールしたサービス通信証明書は使用しないでください。  
  
## <a name="how-token-signing-certificates-are-used-across-partners"></a>パートナー間\-でトークン署名証明書を使用する方法  
すべての\-トークン署名証明書には、秘密キー\)によるデジタル署名\(に使用される暗号化秘密キーと公開キーが含まれています。セキュリティトークンです。 後で、パートナーフェデレーションサーバーによって受信された後、これらの\(キーは、暗号化され\)たセキュリティトークンの公開キーを使って信頼性を検証します。  
  
各セキュリティトークンはアカウントパートナーによってデジタル署名されているため、リソースパートナーは、セキュリティトークンが実際にはアカウントパートナーによって発行されたものであり、変更されていないことを確認できます。 デジタル署名は、パートナーのトークン\-署名証明書の公開キー部分によって検証されます。 署名が検証されると、リソースフェデレーションサーバーはその組織に対して独自のセキュリティトークンを生成し、独自のトークン\-署名証明書を使用してセキュリティトークンに署名します。  
  
フェデレーションパートナー環境では、トークン\-署名証明書が CA によって発行されている場合は、次のことを確認してください。  
  
1.  証明書失効リスト\(に\)は、証明書利用者と、フェデレーションサーバーを信頼する Web サーバーが証明書の crl が表示されます。  
  
2.  ルート CA 証明書は、フェデレーションサーバーを信頼する証明書利用者と Web サーバーによって信頼されています。  
  
リソースパートナーの Web サーバーは、トークン\-署名証明書の公開キーを使用して、セキュリティトークンがリソースフェデレーションサーバーによって署名されていることを確認します。 その後、Web サーバーがクライアントに適切にアクセスできるようになります。  
  
## <a name="deployment-considerations-for-token-signing-certificates"></a>トークン\-署名証明書の展開に関する考慮事項  
新しい AD FS のインストールで最初のフェデレーションサーバーを展開する場合は、トークン\-署名証明書を取得し、そのフェデレーションサーバーのローカルコンピューターの個人証明書ストアにインストールする必要があります。 トークン\-署名証明書を取得するには、エンタープライズ ca またはパブリック ca から要求するか、自己\-署名証明書を作成します。  
  
AD FS ファームを展開するときに、\-サーバーファームの作成方法に応じて、トークン署名証明書のインストール方法が異なります。  
  
デプロイのトークン\-署名証明書を取得するときに考慮できるサーバーファームオプションは2つあります。  
  
-   1つのトークン\-署名証明書の秘密キーは、ファーム内のすべてのフェデレーションサーバー間で共有されます。  
  
    フェデレーションサーバーファーム環境では、すべてのフェデレーションサーバーが同じトークン\(\-署名証明\)書を共有または再利用することをお勧めします。 発行された証明書\-がエクスポート可能としてマークされている限り、1つのトークン署名証明書をフェデレーションサーバーの CA からインストールし、秘密キーをエクスポートすることができます。  
  
    次の図に示すように、1つのトークン\-署名証明書の秘密キーをファーム内のすべてのフェデレーションサーバーに共有できます。 このオプションは、次の [一意のトークン\-署名証明書] オプションと比較して、パブリック CA からトークン\-署名証明書を取得する予定の場合にコストを削減します。  
  
![トークン署名](media/adfs2_fedserver_certstory_3.gif)  
  
-   ファーム内のフェデレーションサーバー\-ごとに一意のトークン署名証明書があります。  
  
    ファーム全体で一意の証明書を複数使用する場合、ファーム内の各サーバーは独自の一意の秘密キーを使用してトークンに署名します。  
  
    次の図に示すように、ファーム内の1つ\-のフェデレーションサーバーごとに個別のトークン署名証明書を取得できます。 パブリック CA からトークン\-署名証明書を取得する場合は、このオプションの方がコストが高くなります。  
  
![トークン署名](media/adfs2_fedserver_certstory_4.gif)  
  
Microsoft 証明書サービスをエンタープライズ CA として使用する場合の証明書のインストール[の詳細については、「IIS 7.0:IIS 7.0](https://go.microsoft.com/fwlink/?LinkId=108548)でドメインサーバー証明書を作成します。  
  
パブリック CA から証明書をインストールする方法の詳細に[ついては、「IIS 7.0:インターネットサーバー証明書](https://go.microsoft.com/fwlink/?LinkId=108549)を要求します。  
  
自己\-署名証明書のインストールの詳細につい[ては、「IIS 7.0:IIS 7.0\-](https://go.microsoft.com/fwlink/?LinkID=108271)で自己署名サーバー証明書を作成します。  
  
## <a name="see-also"></a>関連項目
[Windows Server 2012 での AD FS 設計ガイド](AD-FS-Design-Guide-in-Windows-Server-2012.md)
