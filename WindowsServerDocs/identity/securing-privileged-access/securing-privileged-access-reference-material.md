---
title: 特権アクセスのセキュリティ保護に関する参考資料
description: Windows Server Active Directory ドメインの運用上のセキュリティ制御
ms.topic: article
ms.assetid: 22ee9a77-4872-4c54-82d9-98fc73a378c0
ms.date: 02/14/2019
ms.author: joflore
author: MicrosoftGuyJFlo
manager: daveba
ms.reviewer: mas
ms.openlocfilehash: d2e7d7a064806646ccc075c96fff2ba20acfe005
ms.sourcegitcommit: 5344adcf9c0462561a4f9d47d80afc1d095a5b13
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/18/2020
ms.locfileid: "90766215"
---
# <a name="active-directory-administrative-tier-model"></a>Active Directory 管理階層モデル

>適用先:Windows Server

この階層モデルの目的は、環境のフル コントロール (階層 0) と攻撃者が頻繁に侵害するリスクが高いワークステーション資産の間で、一連のバッファー ゾーンを使用して ID システムを保護することです。

![階層モデルの 3 つの階層を示す図](../media/securing-privileged-access-reference-material/PAW_RM_Fig1.JPG)

階層モデルは 3 つのレベルで構成され、管理者アカウントのみが含まれ、標準ユーザー アカウントは含まれません。

- **階層 0**: 環境内のエンタープライズ ID を直接管理します。 階層 0 には、Active Directory フォレスト、ドメイン、ドメイン コントローラー、それに含まれるすべての資産を直接的または間接的に管理するアカウント、グループ、その他の資産が含まれます。 階層 0 のすべての資産は、事実上相互に管理しあっているため、セキュリティの機密性は同じです。
- **階層 1**: エンタープライズ サーバーとアプリケーションを管理します。 階層 1 の資産には、サーバーのオペレーティング システム、クラウド サービス、エンタープライズ アプリケーションが含まれます。 階層 1 の管理者アカウントによって、これらの資産でホストされている多くのビジネス価値を管理します。 一般的なロールの例として、すべてのエンタープライズ サービスに影響する機能を持つこれらのオペレーティング システムを管理しているサーバー管理者があります。
- **階層 2**: - ユーザーのワークステーションとデバイスを管理します。 階層 2 の管理者アカウントによって、ユーザーのワークステーションやデバイスでホストされている多くのビジネス価値を管理します。 例としては、ヘルプ デスクやコンピューター サポートの管理者が挙げられます。ほとんどのユーザー データの整合性に影響を及ぼす可能性があるためです。

> [!NOTE]
> これらの階層は、管理用の資産を保護するための基本的な優先順位付けメカニズムとしても機能しますが、任意の階層にあるすべての資産の制御を奪った攻撃者は、ほとんどまたはすべてのビジネス資産にアクセスできることに注意してください。 階層が基本的な優先順位付けのメカニズムとして便利である理由は、攻撃者の難易度とコストです。 攻撃者がユーザーの組織のデータを取得する際に、すべての ID (階層 0) またはサーバーやクラウド サービス (階層 1) のフル コントロールを使用して操作する場合の方が、個々のワークステーションやユーザー デバイス (階層 2) にアクセスする必要がある場合よりも容易です。

## <a name="containment-and-security-zones"></a>封じ込めとセキュリティ ゾーン

各階層は、特定のセキュリティ ゾーンに対応しています。 セキュリティ ゾーンは、さまざまな名称で呼ばれてきましたが、ゾーン間のネットワーク層の分離によってセキュリティ上の脅威を封じ込める、広く確立しているアプローチです。 階層モデルでは、ネットワークの分離が有効ではないセキュリティ ゾーン内で敵対者の封じ込めを提供することにより、分離を補完します。 セキュリティ ゾーンは、オンプレミスとクラウドの両方のインフラストラクチャにまたがる場合があります。たとえば、同じドメイン内のドメイン コントローラーとドメイン メンバーがオンプレミスと Azure でホストされるような場合です。

![オンプレミスとクラウドのインフラストラクチャにまたがることができるセキュリティ ゾーンを示す図](../media/securing-privileged-access-reference-material/PAW_RM_Fig2.JPG)

階層モデルでは、管理者が制御できる対象と、ログオンできる場所を制限することによって、特権のエスカレーションを禁止しています (コンピューターにログオンすることにより、それらの資格情報と、それらの資格情報によって管理されるすべての資産の制御を許可することになるためです)。

### <a name="control-restrictions"></a>制御の制限

制御の制限を次の図に示します。

![制御の制限の図](../media/securing-privileged-access-reference-material/PAW_RM_Fig3.JPG)

### <a name="primary-responsibilities-and-critical-restrictions"></a>主な責務と重要な制限

**階層 0 の管理者**: ID ストアと、現実には ID ストアを制御している少数のシステムを管理し、次の作業を行うことができます。

- 必要に応じて、任意のレベルで資産を管理および制御できる
- 対話形式でのみログオンするか、階層 0 レベルで信頼されている資産にアクセスできる

**階層 1 の管理者**: 企業内のサーバー、サービス、およびアプリケーションを管理し、次の作業を行うことができます。

- 階層 1 または階層 2 のレベルでのみ資産を管理および制御できる
- 階層 1 または階層 0 のレベルで信頼されている資産にのみ (ネットワーク ログオンによって) アクセスできる
- 階層 1 レベルで信頼されている資産に対話形式でのみログオンできる

**階層 2 の管理者**: 企業内のデスクトップ、ノート PC、プリンター、その他のユーザー デバイスを管理し、次の作業を行うことができます。

- 階層 2 のレベルでのみ資産を管理および制御できる
- 必要に応じて任意のレベルで資産に (ネットワーク ログオンによって) アクセスできる
- 階層 2 レベルで信頼されている資産に対話形式でのみログオンできる

### <a name="logon-restrictions"></a>ログオンの制限

ログオンの制限を次の図に示します。

![ログオンの制限の図](../media/securing-privileged-access-reference-material/PAW_RM_Fig4.JPG)

> [!NOTE]
> 一部の資産は、階層 0 で環境の可用性に影響する場合がありますが、資産の機密性や整合性には直接影響しないことに注意してください。 これには、DNS サーバー サービスや、インターネット プロキシなどの重要なネットワーク デバイスが含まれます。

## <a name="clean-source-principle"></a>クリーン ソースの原則

クリーン ソースの原則では、すべてのセキュリティの依存関係がセキュリティ保護されているオブジェクトと同様に信頼できる必要があります。

![オブジェクトを制御しているサブジェクトがそのオブジェクトのセキュリティ依存関係であることを示す図](../media/securing-privileged-access-reference-material/PAW_RM_Fig5.JPG)

オブジェクトを制御しているサブジェクトとは、そのオブジェクトのセキュリティ依存関係のことです。 敵対者は、ターゲット オブジェクトが事実上制御している対象を制御できる場合、そのターゲット オブジェクトを制御できます。 このため、すべてのセキュリティの依存関係において、オブジェクト自体の目的のセキュリティ レベル以上の設定が保証されていることを確認する必要があります。

原則としては単純ですが、これを適用するには、目的の資産 (オブジェクト) の制御の関係を理解し、資産の依存関係を分析して、すべてセキュリティの依存関係 (サブジェクト) を検出する必要があります。

制御は推移的であり、この原則を再帰的に繰り返す必要があります。 たとえば、A が B を制御し、B が C を制御する場合、A は間接的に C も制御します。

![A が B を制御し、B が C を制御する場合、A が間接的に C も制御することを示す図](../media/securing-privileged-access-reference-material/PAW_RM_Fig6.JPG)

A に侵入した攻撃者は、A が制御するすべて (B を含む) と、B が制御するすべて (Cを含む) にアクセスできます。 この同じ例をセキュリティの依存関係の用語を使って説明すると、B と A はいずれも C のセキュリティの依存関係であり、C が目的の保証レベルであるためには、B と A が C で必要な保証レベルのセキュリティで保護されている必要があります。

IT インフラストラクチャと ID システムの場合、最も一般的な制御の手段にこの原則が適用されている必要があります。つまり、システムがインストールされているハードウェア、システムのインストール メディア、システムのアーキテクチャや構成、日常の操作などです。

## <a name="clean-source-for-installation-media"></a>インストール メディアのクリーン ソース

![インストール メディアのクリーン ソースを示す図](../media/securing-privileged-access-reference-material/PAW_RM_CSIM.JPG)

インストール メディアにクリーン ソースの原則を適用するには、インストール メディアが、製造元からのリリース以降に改ざんされていないことを (できる限り) 確認する必要があります。 次の図は、このパスを使用してコンピューターのセキュリティを侵害しようとする攻撃者を示しています。

![パスを使用してコンピューターのセキュリティを侵害しようとする攻撃者を示す図](../media/securing-privileged-access-reference-material/PAW_RM_Fig8.JPG)

インストール メディアにクリーン ソースの原則を適用するには、インストール メディアの取得、保存、転送から使用まで、保有している間のサイクル全体でソフトウェアの整合性を検証する必要があります。

### <a name="software-acquisition"></a>ソフトウェアの取得

ソフトウェアのソースは、次のいずれかの方法で検証する必要があります。

- ソフトウェアは、製造元または信頼できるソースから入手したことがわかっている物理メディア (通常、ベンダーによって製造および出荷されたメディア) から取得されている。
- ソフトウェアは、インターネットから取得され、ベンダーから提供されるファイル ハッシュを使用して検証されている。
- ソフトウェアは、インターネットから取得され、2 つの独立したコピーをダウンロードして比較することにより検証されている。
   - セキュリティ関係がない 2 つのホスト (同じドメインではなく、同じツールで管理されていない) に、できれば別のインターネット接続を使ってダウンロードします。
   - certutil などのユーティリティを使用して、ダウンロードしたファイルを比較します。`certutil -hashfile <filename>`

可能であれば、すべてのアプリケーション ソフトウェア (アプリケーションのインストーラーやツールなど) がデジタル署名されていることを確認し、Windows Authenticode と [Windows Sysinternal](https://www.microsoft.com/sysinternals)s ツール *sigcheck.exe* を使って失効確認を行います。 ベンダーがこの種類のデジタル署名を提供していない場合は、特定のソフトウェアが必要になる可能性があります。

### <a name="software-storage-and-transfer"></a>ソフトウェアの保存と転送

ソフトウェアを入手した後、変更から保護されている場所にソフトウェアを保存する必要があります。特に、インターネットに接続されたホストや、ソフトウェアやオペレーティング システムがインストールされるシステムよりも信頼レベルの低い担当者によって変更されない場所に保存する必要があります。 このストレージには、物理メディアまたはセキュリティで保護された電子的な場所を指定できます。

### <a name="software-usage"></a>ソフトウェアの使用

可能であれば、ソフトウェアは使用するときに検証してください。たとえば、手動でインストールするとき、構成管理ツール用にパッケージ化するとき、構成管理ツールにインポートするときなどです。

## <a name="clean-source-for-architecture-and-design"></a>アーキテクチャと設計のクリーン ソース

システムのアーキテクチャにクリーン ソースの原則を適用するには、システムが下位の信頼システムに依存していないことを確認する必要があります。 システムは上位の信頼システムに依存することはできますが、セキュリティ基準の低い、下位の信頼システムに依存することはできません。

たとえば、Active Directory で標準ユーザーのデスクトップを制御することは許容されますが、標準ユーザーのデスクトップで Active Directory を制御することには、重大な特権エスカレーションのリスクを伴います。

![システムは上位の信頼システムに依存することはできるがセキュリティ基準の低い、下位の信頼システムに依存することはできないことを示す図](../media/securing-privileged-access-reference-material/PAW_RM_Fig09.JPG)

制御の関係は多くの方法で導入できます。たとえば、ファイル システムなどのオブジェクトに対するセキュリティのアクセス制御リスト (ACL)、コンピューターのローカル Administrators グループのメンバーシップ、システムとして実行されるコンピューターにインストールされたエージェント (任意のコードやスクリプトを実行する機能を持つ) などの方法です。

しばしば見過ごされる例として、ログオンによる公開があります。別のシステムにシステムの管理者の資格情報を公開することで制御の関係が作成されます。 これは、Pass-the-Hash などの資格情報を盗む攻撃が非常に強力である理由です。 管理者が階層 0 の資格情報を使用して標準ユーザーのデスクトップにログインすると、それらの資格情報がそのデスクトップに公開され、AD で制御されるようになり、AD への特権のエスカレーション パスが作成されます。 このような攻撃の詳細については、[このページ](/previous-versions/dn785092(v=msdn.10))を参照してください。

Active Directory などの ID システムに依存する資産の数は多いため、Active Directory とドメイン コントローラーが依存するシステムの数を最小限に抑える必要があります。

![Active Directory とドメイン コントローラーが依存するシステムの数を最小限に抑える必要があることを示す図](../media/securing-privileged-access-reference-material/PAW_RM_Fig010.JPG)

Active Directory の上位のリスクに対するセキュリティ強化の詳細については、[このページ](../ad-ds/plan/security-best-practices/reducing-the-active-directory-attack-surface.md)を参照してください。

## <a name="operational-standards-based-on-clean-source-principle"></a>クリーン ソースの原則に基づく運用基準

このセクションでは、管理者の運用基準と管理者に期待されることについて説明します。 これらの基準は、運用方法やプロセスによって発生するリスクに対する組織の情報テクノロジ システムの管理制御をセキュリティで保護するよう設計されています。

![これらの基準は運用方法やプロセスによって発生するリスクに対する組織の情報テクノロジ システムの管理制御をセキュリティで保護するよう設計されていることを示す図](../media/securing-privileged-access-reference-material/PAW_RM_Fig11.JPG)

### <a name="integrating-the-standards"></a>基準の統合

これらの基準は、組織の全体的な基準や運用方法に統合できます。 基準は、特定の要件、使用可能なツール、組織のリスク選考度に合わせて調整できますが、リスクを軽減するために変更は最小限にとどめることをお勧めします。 理想的な終了状態のベンチマークとして、このガイドに示されている既定の設定を使用し、差がある場合は、優先順位に応じて対処される例外として管理することをお勧めします。

基準のガイダンスは、次のセクションで構成されています。

- 前提条件
- 変更諮問委員会
- 運用方法
   - 要約
   - 基準の詳細

### <a name="assumptions"></a>前提条件

このセクションで説明する基準では、組織が次のような属性を持っていることを前提としています。

- スコープ内のサーバーとワークステーションのほとんどまたはすべてが、Active Directory に参加している。
- 管理対象のすべてのサーバーが Windows Server 2008 R2 以降を実行しており、RDP RestrictedAdmin モードが有効になっている。
- 管理対象のすべてのワークステーションが Windows 7 以降を実行しており、RDP RestrictedAdmin モードが有効になっている。

   > [!NOTE]
   > RDP RestrictedAdmin モードを有効にする方法については、[このページ](https://aka.ms/RDPRA)を参照してください。

- スマート カードが使用可能であり、すべての管理アカウントに対して発行されている。
- 各ドメインの *Builtin \administrator* が、緊急用アクセス アカウントとして指定されている。
- エンタープライズ ID 管理ソリューションが展開されている。
- ローカル Administrator アカウントのパスワードを管理するために、[LAPS](https://aka.ms/laps) がサーバーやワークステーションに展開されている。
- 特権アクセス管理ソリューション (Microsoft Identity Manager など) を導入しているか、採用する計画がある。
- セキュリティ アラートを監視し、それらに対応する担当者が割り当てられている。
- Microsoft セキュリティ更新プログラムを迅速に適用するための技術的な能力がある。
- サーバー上のベースボード管理コントローラーは使用されないか、厳格なセキュリティ制御に準拠する。
- サーバーの管理者アカウントとグループ (階層 1 の管理者) とワークステーションの管理者アカウントとグループ (階層 2 の管理者) が、ドメイン管理者 (階層 0) によって管理される。
- Active Directory の変更を承認する変更諮問委員 (CAB) または別の指定された機関がある。

### <a name="change-advisory-board"></a>変更諮問委員会

変更諮問委員 (CAB) は、組織のセキュリティ プロファイルに影響を与える可能性がある変更に関するディスカッション フォーラムおよび承認機関です。 これらの基準に対する例外は、リスクの評価と正当な理由と共に CAB に提出する必要があります。

このドキュメントでは、各基準を、特定の階層レベルで基準を満たすことの重要性に応じて分類しています。

![特定の階層レベルの基準を示す図](../media/securing-privileged-access-reference-material/PAW_RM_Fig12.JPG)

必須項目 (このドキュメントでは、赤色の八角形またはオレンジ色の三角形でマークされている) に対するすべての例外は、一時的なものであると見なされ、CAB による承認が必要です。 ガイドラインは次のとおりです。

- 最初の要求には、担当者の直属の上司によって署名された正当な理由とリスク容認が必要であり、6 か月後に期限が切れます。
- 更新には、ビジネス ユニット責任者によって署名された正当な理由とリスク容認が必要であり、6 か月後に期限が切れます。

推奨項目 (このドキュメントでは、黄色の円でマークされている) に対するすべての例外は、一時的なものであると見なされ、CAB による承認が必要です。 ガイドラインは次のとおりです。

- 最初の要求には、担当者の直属の上司によって署名された正当な理由とリスク容認が必要であり、12 か月後に期限が切れます。
- 更新には、ビジネス ユニット責任者によって署名された正当な理由とリスク容認が必要であり、12 か月後に期限が切れます。

### <a name="operational-practices-standards-summary"></a>運用方法の基準の概要

次の表の階層列は、管理者アカウントの階層レベルを示しており、その制御は、通常、階層のすべての資産に影響します。

![管理者アカウントの階層レベルを示す表](../media/securing-privileged-access-reference-material/PAW_RM_Fig13.JPG)

環境のセキュリティ体制を維持するには、定期的に行われる運用上の意思決定が重要です。 これらのプロセスや作業方法の基準は、操作エラーが、環境で悪用される可能性がある操作の脆弱性を発生させないようにすることに役立ちます。

#### <a name="administrator-enablement-and-accountability"></a>管理者の有効化と説明責任

管理者には、環境をできるだけ安全に運用するための情報や権限が与えられ、そのためのトレーニングが実施されている必要があり、管理者はその責任を負う必要があります。

##### <a name="administrative-personnel-standards"></a>管理担当者の基準

任命する管理担当者が信頼できる人物であり、管理特権が必要であることを調査する必要があります。

- 管理特権を割り当てる前に担当者の背景情報を調査します。
- 四半期ごとに管理特権を調べて、どの担当者が引き続き管理アクセス権への正当なビジネス上のニーズを持っているかを特定します。

##### <a name="administrative-security-briefing-and-accountability"></a>管理者へのセキュリティ ブリーフィングと説明責任

管理者は、組織に対するリスクとそのリスクを管理する役割について、広い知識を持ち、責任を負う必要があります。 管理者は、次の項目について、毎年トレーニングを受ける必要があります。

- 一般的な脅威が生じる環境
   - 特定された敵対者
   - Pass-the-Hash や資格情報の窃盗などの攻撃の手法
- 組織固有の脅威やインシデント
- 攻撃を防御するうえでの管理者の役割
   - 階層モデルによる資格情報の公開の管理
   - 管理ワークステーションの使用
   - リモート デスクトップ プロトコルの RestrictedAdmin モード
- 組織固有の管理手順
   - この基準でのすべての運用ガイドラインの確認
   - 次の主要な規則を実装します。
      - 管理ワークステーション以外で管理者アカウントを使用しない
      - アカウントやワークステーションでセキュリティ制御 (たとえば、ログオンの制限や、スマート カードに必要な属性) を無効化したり、削除したりしない
      - 問題や異常なアクティビティの報告

説明責任を果たすために、管理者アカウントを持つすべての担当者が、管理特権に関する倫理規定ドキュメントに署名して、組織固有の管理ポリシーのプラクティスに従うことに同意する必要があります。

##### <a name="provisioning-and-deprovisioning-processes-for-administrative-accounts"></a>管理者アカウントのプロビジョニングとプロビジョニング解除のプロセス

ライフ サイクルの要件を満たすため、次の基準が満たされている必要があります。

- すべての管理者アカウントは、次の表で説明されている承認機関によって承認されている必要があります。
   - 管理特権の承認は、担当者に正当なビジネス上のニーズがある場合にのみ許可されます。
   - 管理者特権の承認は、6 か月を超えることはできません。
- 以下の場合、管理特権へのアクセスは直ちにプロビジョニング解除されます。
   - 担当者が異動になった。
   - 担当者が離職した。
- 担当者が離職した場合、アカウントを直ちに無効にする必要があります。
- 無効になったアカウントは 6 か月以内に削除する必要があり、変更承認委員会のレコードに削除のレコードを入力する必要があります。
- 不正なアクセス許可が付与されていないことを確認するために、毎月、すべての特権アカウントのメンバーシップを確認します。 これは、変更を警告する自動化されたツールに置き換えることもできます。

|アカウントの特権レベル|承認機関|メンバーシップの確認頻度|
|--------------|------------|----------------|
|階層 0 の管理者|変更承認委員会|毎月または自動|
|階層 1 の管理者|階層 0 の管理者またはセキュリティ|毎月または自動|
|階層 2 の管理者|階層 0 の管理者またはセキュリティ|毎月または自動|

#### <a name="operationalize-least-privilege"></a>最低限の特権による運用への対応

これらの基準は、ロールの管理者の数と管理者が特権を持っている時間を減らすことで最低限の特権を実現します。

> [!NOTE]
> 組織で最低限の特権を実現するには、組織のロール、ロールの要件、設計メカニズムを理解して、最低限の特権を使用して業務を遂行できることを確認する必要があります。 管理モデルで最低限の特権の状態を実現するには、通常、複数の方法を使用する必要があります。
>
> - 特権グループの管理者またはメンバーの数を制限する
> - アカウントに委任する特権を低くする
> - 期限付きの特権を必要に応じて提供する
> - 他の担当者がタスクを実行できるようにする (コンシェルジェ アプローチ)
> - 緊急アクセスやまれな使用シナリオのプロセスを提供する

##### <a name="limit-count-of-administrators"></a>管理者数の制限

ビジネス継続性を確保するために、各管理者ロールに最低 2 人の資格を持つ担当者を割り当てる必要があります。

任意のロールに割り当てられている担当者の数が 2 人を超える場合、変更承認委員会が (元の 2 人を含む) 個々のメンバーに特権を割り当てる具体的な理由を承認する必要があります。 承認の理由には以下の情報を含める必要があります。

- 管理特権を必要とする管理者によって実行される技術的なタスク
- タスクの実行頻度
- 別の管理者が代わりにタスクを実行できない具体的な理由
- 特権を付与するための既知のすべての代替アプローチと、各アプローチを許容できない理由

##### <a name="dynamically-assign-privileges"></a>特権の動的な割り当て

管理者は、アクセス許可を "ジャスト イン タイム方式" で取得し、タスクを実行するときに使用する必要があります。 アクセス許可は、管理者アカウントに永続的には割り当てられません。

> [!NOTE]
> 永続的に割り当てられた管理特権は、自然に "最大限の特権" 戦略を生成します。管理担当者は、問題があった場合に、運用の可用性を維持するためのアクセス許可に迅速にアクセスできる必要があるためです。 ジャスト イン タイムのアクセス許可によって、以下の機能が提供されます。
>
> - より細かくアクセス許可を割り当てることにより、最低限の特権に近づける
> - 特権の使用時間を短縮する
> - アクセス許可の使用を追跡することにより、不正な使用や攻撃を検出する

#### <a name="manage-risk-of-credential-exposure"></a>資格情報公開のリスクの管理

資格情報公開のリスクを適切に管理するには、次のプラクティスを使用します。

##### <a name="separate-administrative-accounts"></a>個別の管理者アカウント

管理特権が承認されたすべてのユーザーは、ユーザー アカウントとは別に、管理機能を実行するための個別のアカウントを持っている必要があります。

- **標準ユーザー アカウント**: 電子メール、Web 閲覧、基幹業務アプリケーションの使用など、標準ユーザー タスクを実行するための標準ユーザー権限が付与されます。 これらのアカウントには管理者特権を付与しないでください。
- **管理者アカウント**: 適切な管理者特権が割り当てられている担当者用に作成された個別のアカウントです。 各階層で資産を管理する必要がある管理者の場合は、階層ごとに個別のアカウントが必要です。 これらのアカウントには、電子メールまたはパブリック インターネットへのアクセスを許可しないでください。

##### <a name="administrator-logon-practices"></a>管理者ログオンのプラクティス

管理者が対話形式でホストにログオンする (標準的な RDP でローカルにログオンする場合、RunAs を使用する場合、仮想化コンソールを使用する場合など) には、ホストが管理者アカウントの階層 (またはそれより上の階層) の基準を満たすか、上回っている必要があります。

管理者が管理者アカウントを使用して管理ワークステーションにのみサインインできます。 管理者は、次のセクションで説明されている承認済みのサポート テクノロジを使用することにより、管理対象のリソースにのみログオンします。

> [!NOTE]
> 対話形式でホストにログオンすると、そのホストに資格情報の制御を与えることになるため、このような手順が必要です。
>
> ログオンの種類、一般的な管理ツール、資格情報の公開の詳細については、「[管理ツールとログオンの種類]()」を参照してください。

##### <a name="use-of-approved-support-technology-and-methods"></a>承認済みのサポート テクノロジと手法の使用

リモート システムとユーザーをサポートする管理者は、リモート コンピューターを制御している敵対者が管理者資格情報を盗むことを防ぐために、以下のガイドラインに従う必要があります。

- 利用できる場合は、プライマリ サポート オプションを使用してください。
- プライマリ サポート オプションが利用できない場合にのみ、セカンダリ サポート オプションを使用してください。
- 禁止されているサポート手法は使用しないでください。
- 管理者アカウントでは、常に、インターネットの閲覧や電子メールへのアクセスを実行しないでください。

###### <a name="tier-0-forest-domain-and-dc-administration"></a>階層 0 のフォレスト、ドメイン、DC の管理

このシナリオでは、確実に次の手順を実行してください。

- **リモート サーバーのサポート**: リモートからサーバーにアクセスする場合、階層 0 の管理者は次のガイドラインに従う必要があります。
  - **プライマリ (ツール)** : ネットワーク ログオン (タイプ 3) を使用するリモート ツール。 詳細については、「[管理ツールとログオンの種類]()」を参照してください。
  - **プライマリ (対話形式)** : ドメイン アカウントで、管理ワークステーションから RDP RestrictedAdmin または標準の RDP セッションを使用します。

    > [!NOTE]
    > 階層 0 の特権の管理ソリューションがある場合は、「特権アクセス管理ソリューションからジャスト イン タイムで取得したアクセス許可を使用する」をドメイン アカウントの前に追加します。

- **物理サーバーのサポート**: サーバー コンソールや仮想マシンのコンソール (HYPER-V や VMware ツール) で物理的に操作する場合、これらのアカウントに特定の管理ツール使用の制限はなく、電子メールやオープンなインターネットの閲覧などの標準ユーザー タスクの一般的な制限のみです。

   > [!NOTE]
   > 階層 0 の管理は他の階層の管理とは異なります。階層 0 のすべて資産は、既にすべての資産を直接的または間接的に制御しているためです。 たとえば、DC の制御を取得した攻撃者は、既にデータベース内のすべてのドメイン資格情報にアクセスできるため、ログオンしている管理者の資格情報を盗む必要はありません。

###### <a name="tier-1-server-and-enterprise-application-support"></a>階層 1 のサーバーおよびエンタープライズ アプリケーションのサポート

このシナリオでは、確実に次の手順を実行してください。

- **リモート サーバーのサポート**: リモートからサーバーにアクセスする場合、階層 1 の管理者は次のガイドラインに従う必要があります。
   - **プライマリ (ツール)** : ネットワーク ログオン (タイプ 3) を使用するリモート ツール。 詳細については、「[Mitigating Pass-the-Hash and Other Credential Theft](https://www.microsoft.com/pth)」 (Pass-the-Hash およびその他の資格情報盗難の軽減) v1 (42 ～ 47 ページ) を参照してください。
   - **プライマリ (対話形式)** : 特権アクセス管理ソリューションからジャスト イン タイムで取得したアクセス許可を使用するドメイン アカウントで、管理ワークステーションから RDP RestrictedAdmin を使用します。
   - **セカンダリ**: 管理ワークステーションから LAPS で設定されたローカル アカウントのパスワードを使用してサーバーにログオンします。
   - **禁止**: 標準の RDP は、ドメイン アカウントでは使用できません。
   - **禁止**: セッション中のドメイン アカウントの資格情報の使用 (たとえば、*RunAs* の使用や共有への認証)。 これによって、ログオン資格情報は盗難のリスクにさらされます。
- **物理サーバーのサポート**: サーバー コンソールや仮想マシンのコンソール (HYPER-V や VMware ツール) で物理的に操作する場合、階層 1 の管理者は、サーバーにアクセスする前に、LAPS からローカル アカウントのパスワードを取得する必要があります。
   - **プライマリ**: サーバーにログオンする前に、管理ワークステーションから LAPS によって設定されたローカル アカウントのパスワードを取得します。
   - **禁止**: このシナリオでは、ドメイン アカウントでのログオンは許可されません。
   - **禁止**: セッション中のドメイン アカウントの資格情報の使用 (たとえば、RunAs や共有への認証)。 これによって、ログオン資格情報は盗難のリスクにさらされます。

###### <a name="tier-2-help-desk-and-user-support"></a>階層 2 のヘルプ デスクとユーザー サポート

ヘルプ デスクおよびユーザー サポート組織は、エンドユーザーのサポート (管理特権を必要としない) とユーザーのワークステーションのサポート (管理特権が必要) を実行します。

**ユーザー サポート**: タスクには、ワークステーションへの変更を必要としないタスク (通常、アプリケーションの機能やオペレーティング システムの機能の使用方法の説明) の実行によるユーザーの支援が含まれます。

- **デスクサイドでのユーザー サポート**: 階層 2 のサポート担当者は物理的にユーザーの仕事場で作業します。
   - **プライマリ**: 「肩越し」のサポートは、ツールを使用せずに提供できます。
   - **禁止**: このシナリオでは、ドメイン アカウントの管理者資格情報でのログオンは許可されません。 管理特権が必要な場合は、デスクサイドでのワークステーションのサポートに切り替えます。
- **リモート ユーザー サポート**: 階層 2 のサポート担当者は物理的にユーザーから離れた場所にいます。
   - **プライマリ**: リモート アシスタンス、Skype for Business、または類似のユーザー画面共有を使用できます。 詳細については、[Windows リモート アシスタンス](https://windows.microsoft.com/windows/what-is-windows-remote-assistance)に関するページを参照してください。
   - **禁止**: このシナリオでは、ドメイン アカウントの管理者資格情報でのログオンは許可されません。 管理特権が必要な場合は、ワークステーションのサポートに切り替えます。
- **ワークステーションのサポート**: タスクには、ログの表示、ソフトウェアのインストール、ドライバーの更新などのためにシステムへのアクセスが必要な、ワークステーションのメンテナンスやトラブルシューティングの実行が含まれます。
   - **デスクサイドでのワークステーション サポート**: 階層 2 のサポート担当者は物理的にユーザーのワークステーションで作業します。
      - **プライマリ**: ユーザーのワークステーションに接続する前に、管理ワークステーションから LAPS によって設定されたローカル アカウントのパスワードを取得します。
      - **禁止**: このシナリオでは、ドメイン アカウントの管理者資格情報でのログオンは許可されません。
   - **リモート ワークステーション サポート**: 階層 2 のサポート担当者は物理的にワークステーションから離れた場所にいます。
      - **プライマリ**: 特権アクセス管理ソリューションからジャスト イン タイムで取得したアクセス許可を使用するドメイン アカウントで、管理ワークステーションから RDP RestrictedAdmin を使用します。
      - **セカンダリ**: ユーザーのワークステーションに接続する前に、管理ワークステーションから LAPS によって設定されたローカル アカウントのパスワードを取得します。
      - **禁止**: ドメイン アカウントでの標準 RDP の使用。

###### <a name="no-browsing-the-public-internet-with-admin-accounts-or-from-admin-workstations"></a>管理者アカウントを使用して、または管理ワークステーションから、パブリック インターネットを閲覧しない

管理担当者は、管理者アカウントを使用してログオンしているときや、管理ワークステーションにログオンしているときに、オープン インターネットを閲覧できません。 承認済みの唯一の例外は、Web ブラウザーを使用してクラウド ベースのサービスを管理する場合です。

###### <a name="no-accessing-email-with-admin-accounts-or-from-admin-workstations"></a>管理者アカウントを使用して、または管理ワークステーションから、電子メールにアクセスしない

管理担当者は、管理者アカウントを使用してログオンしているときや、管理ワークステーションにログオンしているときに、電子メールにアクセスできません。

###### <a name="store-service-and-application-account-passwords-in-a-secure-location"></a>安全な場所へのサービスおよびアプリケーション アカウントのパスワードの保存

パスワードへのアクセスを制御する物理的なセキュリティ プロセスでは、次のガイドラインを使用する必要があります。

- 物理的な金庫にサービス アカウントのパスワードを保管します。
- アカウントの階層の分類以上で信頼されている担当者のみがアカウント パスワードにアクセスできることを確認します。
- 説明責任のために、パスワードにアクセスできるユーザー数を最小限に制限します。
- パスワードに対するすべてのアクセスがログに記録、追跡され、IT 管理を行うためのトレーニングを受けていないマネージャーなど、公平な第三者によって監視されていることを確認します。

##### <a name="strong-authentication"></a>強力な認証

強力な認証を適切に構成するには、次のプラクティスを使用します。

###### <a name="enforce-smartcard-multi-factor-authentication-mfa-for-all-admin-accounts"></a>すべての管理者アカウントへのスマート カードの多要素認証 (MFA) の適用

管理者アカウントでは認証にパスワードを使用することは許可されません。 承認済みの唯一の例外は、適切なプロセスで保護されている緊急のアクセス アカウントです。

スマート カードにすべての管理アカウントをリンクし、 **[Smart Card Required for Interactive Logon]** (対話型ログオンにはスマート カードが必要) 属性を有効にします。

**[Smart Card Required for Interactive Logon]** (対話型ログオンにはスマート カードが必要) 属性を無効にし、すぐに再び有効にすることによって、定期的に自動でランダムなパスワード ハッシュ値をリセットするスクリプトを実装する必要があります。

緊急時のアクセス アカウント以外の担当者によって使用されるアカウントに例外を許可しないでください。

###### <a name="enforce-multi-factor-authentication-for-all-cloud-admin-accounts"></a>すべてのクラウド管理者アカウントへの多要素認証の適用

Microsoft Azure や Office 365 などのクラウド サービスで管理特権を持つすべてのアカウントでは、多要素認証を使用する必要があります。

##### <a name="rare-use-emergency-procedures"></a>まれに使用される緊急時の手順

運用手順では、次の基準をサポートしている必要があります。

- 機能の停止を迅速に解決できることを確認します。
- 必要に応じて、まれな高い権限のタスクを完了できることを確認します。
- 資格情報および特権を保護する安全な手順が使用されることを確認します。
- 適切な追跡および承認プロセスに従っていることを確認します。

###### <a name="correctly-follow-appropriate-processes-for-all-emergency-access-accounts"></a>すべての緊急アクセス アカウントの適切なプロセスに正しく従います。

各緊急アクセス アカウントの追跡のシートが安全な場所にあることを確認します。

パスワード追跡シートに記載されている手順を、各アカウントについて実行します。これには、使用後のパスワードの変更や、完了後の使用したワークステーションやサーバーからのログアウトなどが含まれます。

緊急アクセス アカウントのすべての使用は、変更承認委員会によって事前に承認されるか、承認済みの緊急使用として事後に承認される必要があります。

###### <a name="restrict-and-monitor-usage-of-emergency-access-accounts"></a>緊急アクセス アカウントの使用の制限と監視

緊急アクセス アカウントのすべての使用について、次のことが当てはまります。

- 権限のあるドメイン管理者のみが、ドメイン管理特権を使って緊急アクセス アカウントにアクセスできます。
- 緊急アクセス アカウントは、ドメイン コントローラーとその他の階層 0 のホストによってのみ使用できます。
- このアカウントは、次の目的にのみに使用する必要があります。
  - 適切な管理者アカウントの使用を妨げている技術的な問題のトラブルシューティングと修正を実行する。
  - 次のようなまれなタスクを実行する。
    - スキーマ管理
    - エンタープライズ管理者特権を必要とするフォレスト全体のタスク

      > [!NOTE]
      > Active Directory サイトとサブネットの管理などのトポロジ管理は、これらの特権の使用を制限するために委任されることに注意してください。

- これらのアカウントのいずれかを使用する場合は、常に、セキュリティ グループのリーダーによる書面での承認が必要です。
- 各緊急アクセス アカウントの追跡シート上の手順では、パスワードを使用するたびに変更する必要があります。 セキュリティ チームのメンバーは、これが正しく実行されていることを検証する必要があります。

###### <a name="temporarily-assign-enterprise-admin-and-schema-admin-membership"></a>一時的にエンタープライズ管理者やスキーマ管理者のメンバーシップを割り当てる

特権は、必要に応じて追加し、使用後に削除する必要があります。 緊急時のアカウントでは、タスクを完了するための期間だけ、最大 10 時間、これらの特権が割り当てられる必要があります。 これらの特権のすべての使用状況と使用期間は、タスクの完了後、変更承認委員会のレコードにキャプチャする必要があります。

## <a name="esae-administrative-forest-design-approach"></a>ESAE 管理フォレスト設計のアプローチ

このセクションでは、サイバーセキュリティ攻撃からユーザーを保護するために、Microsoft のサイバーセキュリティ プロフェッショナル サービス チームが展開している、Enhanced Security Administrative Environment (ESAE) 参照アーキテクチャに基づく管理フォレストに対するアプローチについて説明します。

専用管理フォレストによって、組織は、運用環境よりもセキュリティ制御が強化された環境で、管理アカウント、ワークステーション、グループをホストすることができます。

このアーキテクチャでは、単一のフォレスト アーキテクチャでは不可能な、または簡単に構成できないさまざまなセキュリティ制御が可能になります。Privileged Access Workstation (PAW) によって管理されるセキュリティ制御も実現できます。 この手法では、運用環境で高い権限が設定された管理フォレストで、特権のない標準ユーザーとしてアカウントをプロビジョニングできるため、より優れた技術で管理を実施できます。 また、このアーキテクチャでは、承認済みホストのみに対してログオン (と資格情報の公開) を制限するための手段として、認証を選択する機能を使用することもできます。 コストや完全な再構築の複雑性が発生することなく、高いレベルの保証が運用フォレストに必要とされる場合に、管理フォレストは運用環境の保証レベルを高める環境を提供できます。

このアプローチでは、Active Directory 環境にフォレストが追加されますが、コストと複雑さは、固定の設計、小規模なハードウェア/ソフトウェア フット プリント、少数のユーザーによって制限されます。

> [!NOTE]
> このアプローチは Active Directory の管理に適していますが、多くのアプリケーションは、標準的な信頼を使用する外部フォレストからのアカウントで管理されている場合、互換性がありません。

次の図は、階層 0 の資産と Microsoft Identity Manager の Privileged Access Management 機能で使用するために構成された PRIV フォレストの管理に使用される ESAE フォレストを示しています。 MIM PAM インスタンスを展開する方法の詳細については、「[Active Directory ドメイン サービスの Privileged Access Management](/microsoft-identity-manager/pam/privileged-identity-management-for-active-directory-domain-services)」を参照してください。

![階層 0 の資産と Microsoft Identity Manager の Privileged Access Management 機能で使用するために構成された PRIV フォレストの管理に使用される ESAE フォレストを示す図](../media/securing-privileged-access-reference-material/PAW_RM_Fig14.JPG)

専用管理フォレストとは、Active Directory 管理機能専用の標準シングル ドメイン Active Directory フォレストのことです。 管理フォレストと管理ドメインは、使用事例が限定されるため、運用フォレストより厳重にセキュリティ強化されることがあります。

管理フォレスト設計では、次の考慮事項を含める必要があります。

- **制限された範囲** – 管理フォレストの主な価値は、高いレベルのセキュリティ保証と、攻撃される面が少ないために残存リスクが低いことにあります。 フォレストは追加の管理機能と管理アプリケーションの格納に使用できますが、それぞれの範囲が広がると、それだけフォレストとそのリソースに攻撃される面が増えます。 その目的は、フォレストとその中の管理ユーザーの機能を制限し、攻撃される面を最小に押さえることです。そのため、範囲を広げる場合、そのたびに慎重に考慮する必要があります。
- **信頼の構成** – 信頼は「管理対象のフォレストまたはドメインから管理フォレストへ」の方向で構成されます。
   - 1 方向の信頼は、「運用環境から管理フォレストへ」の方向で必要となります。 これにはドメイン信頼またはフォレスト信頼があります。 管理フォレストのドメインは管理対象のドメインやフォレストを信頼しなくても Active Directory を管理できます。ただし、アプリケーションを追加する場合、2 方向の信頼関係、セキュリティ検証、試験が必要になることがあります。
   - 管理フォレストのアカウントを適切な運用ホストへのログオンのみに制限するには、認証の選択を使用する必要があります。 ドメイン コントローラーを維持し、Active Directory の権限を委任する場合は通常、管理フォレストの指定の階層 0 管理アカウントにドメイン コントローラーの "ログオン許可" 権利を与える必要があります。 詳細については、「認証の選択設定の構成」を参照してください。
- **特権とドメインのセキュリティ強化** - 管理フォレストは、Active Directory 管理の要件に基づき、最小の特権に制限されるように構成する必要があります。
   - ドメイン コント ローラーの管理およびアクセス許可の委任の権限を付与するには、管理フォレストのアカウントを BUILTIN\Administrators ドメイン ローカル グループに追加する必要があります。 これは、Domain Admins グローバル グループには外部ドメインからのメンバーを含めることができないためです。
   - このグループを使用して権限を付与する注意点の 1 つとして、既定では新しいグループ ポリシー オブジェクトに対する管理アクセスを持たないことが挙げられます。 これは、[このサポート技術情報の記事](https://support.microsoft.com/kb/321476)で説明されている手順に従って、スキーマの既定のアクセス許可を変更することによって変更できます。
   - 運用環境を管理するための管理フォレストのアカウントには、管理フォレスト、その中のドメイン、その中のワークステーションに対する管理特権を与えてはいけません。
   - 攻撃者や悪意のある内部関係者が監査ログを消去する機会が減るように、管理フォレストの管理特権はオフライン プロセスで厳重に管理する必要があります。 その結果、運用管理者アカウントが与えられたユーザーは自分のアカウントの制約を緩和することができないため、組織に対するリスクが増えることはありません。
   - 管理フォレストは、Microsoft Security Compliance Baseline (SCB) のドメインに関する考慮事項に従う必要があります。これには、認証プロトコルの強力な構成が含まれます。
   - すべての管理者フォレスト ホストはセキュリティ更新プログラムで自動更新する必要があります。 ドメイン コントローラーの保守管理作業が中断される可能性がありますが、修正プログラムの適用されていない部分の脆弱性についてセキュリティ リスクを大幅に軽減できます。

      > [!NOTE]
      > 更新プログラムが自動で承認されるように専用の Windows Server Update Services インスタンスを構成できます。 詳細については、更新プログラムの承認に関する「更新プログラムのインストールの自動承認」セクションを参照してください。

- **ワークステーションのセキュリティ強化** - [Privileged Access Workstation](../securing-privileged-access/privileged-access-workstations.md) を使用して (フェーズ 3 を通じて) 管理ワークステーションを構築しますが、ドメインのメンバーシップを実稼働環境ではなく管理フォレストに変更します。
- **サーバーと DC のセキュリティ強化** - 管理フォレスト内のすべてのドメイン コントローラーとサーバーについて、次のことを実行します。
   - すべてのインストール メディアが、「[インストール メディアのクリーン ソース]()」のガイダンスに従って検証されていることを確認します。
   - 実稼働環境で実現できない場合でも、管理フォレストのサーバーには最新のオペレーティング システムがインストールされていることを確認します。
   - 管理者フォレスト ホストはセキュリティ更新プログラムで自動更新する必要があります。

      > [!NOTE]
      > 更新プログラムが自動で承認されるように Windows Server Update Services を構成できます。 詳細については、更新プログラムの承認に関する「更新プログラムのインストールの自動承認」セクションを参照してください。

   - 構成の開始点として、セキュリティ ベースラインを使用してください。

      > [!NOTE]
      > お客様は Microsoft Security Compliance Toolkit (SCT) を利用し、管理ホストにベースラインを構成できます。

   - セキュア ブートは、署名のないコードをブート プロセスに読み込もうとする攻撃者またはマルウェアを防ぐために役立ちます。

      > [!NOTE]
      > この機能は、Unified Extensible Firmware Interface (UEFI) を活用するために Windows 8 で導入されました。

   - ボリューム全体の暗号化によって、リモートで使用している管理用ノート PC などのコンピューターを物理的に紛失した場合のリスクを軽減します。

      > [!NOTE]
      > 詳細については、「[BitLocker](/previous-versions/windows/it-pro/windows-8.1-and-8/dn641993(v=ws.11))」を参照してください。

   - USB の制限によって、物理的なウイルス感染を防ぎます。

      > [!NOTE]
      > 詳細については、「[Control Read or Write Access to Removable Devices or Media](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc730808(v=ws.10))」 (リムーバブル デバイスまたはメディアに対する読み取りまたは書き込みアクセスの制御) を参照してください。

   - ネットワークの分離によって、ネットワーク攻撃や不注意な管理行動によるリスクを防ぎます。 ホストのファイアウォールにより、明示的に必要な接続を除き、入ってくるすべての接続をブロックし、外へのすべてのインターネット アクセスをブロックします。

   - マルウェア対策によって、既知の脅威やマルウェアを防ぎます。

   - 攻撃経路の分析は、新しいソフトウェアをインストールするときに、新しい攻撃が Windows に侵入するのを防ぎます。

      > [!NOTE]
      > [Attack Surface Analyzer (ASA)](https://www.microsoft.com/download/details.aspx?id=24487) などのツールを利用すれば、ホストの構成設定を評価したり、ソフトウェアや構成変更で侵入した攻撃を特定したりできます。

- アカウントのセキュリティ強化
   - 多要素認証は、1 つのアカウントを除く、管理フォレスト内のすべてのアカウントについて構成する必要があります。 多要素認証プロセスで障害が発生した場合にアクセスできるように、少なくとも 1 つの管理アカウントはパスワード ベースにしておいてください。 このアカウントは、物理的に厳格な管理プロセスによって保護する必要があります。
   - 多要素認証用に構成されたアカウントは、定期的に新しい NTLM ハッシュをアカウントに設定するように構成されている必要があります。 これは、アカウントの属性 [Smart Card Required for Interactive Logon] (対話型ログオンにはスマート カードが必要) を無効にして、有効にすることで実現できます。

      > [!NOTE]
      > これによって、このアカウントを使用している実行中の操作が中断される場合があるため、このプロセスは、夜間や週末など、管理者がアカウントを使用していないときにのみ開始する必要があります。

- 検出コントロール
   - 管理フォレストで異常が発生した場合、警報を出すように管理フォレストの検出コントロールを設計する必要があります。 認定シナリオまたは認定アクティビティの数を制限することで、運用環境より正確にコントロールを調整できます。

お客様の環境に対する ESAE の設計と展開に関する Microsoft サービスの詳細については、[このページ](https://www.microsoft.com/services)を参照してください。

## <a name="tier-0-equivalency"></a>階層 0 と同等のグループ

ほとんどの組織では、Administrators、Domain Admins、Enterprise Admins などの強力な階層 0 の Active Directory グループのメンバーシップを制御します。  多くの組織では、標準的な Active Directory 環境での特権と事実上同じである他のグループのリスクを見過ごしています。 これらのグループは、さまざまな攻撃手法を用いる攻撃者に対して、同じ明示的な階層 0 の特権に対する比較的簡単なエスカレーション パスを提供します。

例として、サーバー オペレーターは、ドメイン コントローラーのバックアップ メディアにアクセスすることができ、そのメディア内のファイルからすべての資格情報を抽出し、特権をエスカレーションさせるために使用できます。

組織では、次のような階層 0 のグループ (入れ子になったメンバーシップを含む) のメンバーシップを制御および監視します。

- Enterprise Admins
- Domain Admins
- Schema Admin
- BUILTIN\Administrators
- Account Operators
- Backup Operators
- 演算子を印刷します。
- Server Operators
- ドメイン コントローラー
- Read-Only Domain Controllers
- Group Policy Creator Owners
- Cryptographic Operators
- Distributed COM Users
- その他の代理グループ - ディレクトリ操作を管理するために組織で作成される可能性があり、有効な階層 0 のアクセスも持つ場合があるカスタムのグループ。

## <a name="administrative-tools-and-logon-types"></a>管理ツールとログオンの種類

これは、リモート管理にさまざまな管理ツールを使用することに関連する、資格情報公開のリスクの識別に役立つリファレンス情報です。

リモート管理のシナリオでは、資格情報は常に元のコンピューターで公開されるため、機密性の高いアカウントや影響の大きいアカウントについては、常に信頼できる Privileged Access Workstation (PAW) をお勧めします。 ターゲット (リモート) コンピューター上で資格情報が潜在的に盗まれる可能性があるかどうかは、主に、接続方法で使用される Windows ログオンの種類に依存します。

次の表に、最も一般的な管理ツールとの接続方法に関するガイダンスを示します。

|接続方法|ログオンの種類|接続先で再利用可能な資格情報|備考|
|-----------|-------|--------------------|------|
|コンソールでのログオン|Interactive (対話型)|v|ハードウェアの Remote Access/Lights-Out カードやネットワーク KVMが含まれます。|
|RUNAS|Interactive (対話型)|v||
|RUNAS /NETWORK|NewCredentials|v|ローカル アクセス用に現在の LSA セッションが複製されますが、ネットワーク リソースに接続するときには、新しい資格情報を使用します。|
|リモート デスクトップ (成功)|RemoteInteractive|v|リモート デスクトップ クライアントがローカル デバイスとリソースを共有するように構成されている場合、それらのセキュリティも侵害される可能性があります。|
|リモート デスクトップ (エラー: ログオンの種類が拒否されました)|RemoteInteractive|-|既定では、RDP ログオンが失敗した場合、資格情報は非常に短い間、格納されるだけです。 コンピューターのセキュリティが侵害されている場合、このようにならない可能性があります。|
|Net use * \\\SERVER|ネットワーク|-||
|Net use * \\\SERVER /u:user|ネットワーク|-||
|リモート コンピューターへの MMC スナップイン|ネットワーク|-|例:コンピューターの管理、イベント ビューアー、デバイス マネージャー、サービス|
|PowerShell WinRM|ネットワーク|-|例:Enter-PSSession server|
|PowerShell WinRM と CredSSP|NetworkClearText|v|New-PSSession server<br />-Authentication Credssp<br />-Credential cred|
|PsExec (明示的な資格情報なし)|ネットワーク|-|例:PsExec \\\server cmd|
|PsExec (明示的な資格情報あり)|ネットワークと対話型|v|PsExec \\\server -u user -p pwd cmd<br />複数のログオン セッションを作成します。|
|リモート レジストリ|ネットワーク|-||
|リモート デスクトップ ゲートウェイ|ネットワーク|-|リモート デスクトップ ゲートウェイへの認証。|
|スケジュールされたタスク|Batch (バッチ)|v|パスワードは LSA シークレットとしてディスクにも保存されます。|
|サービスとしてのツールの実行|サービス|v|パスワードは LSA シークレットとしてディスクにも保存されます。|
|脆弱性スキャナー|ネットワーク|-|一部のベンダーが、ネットワーク以外のログオンを実装し、資格情報の盗難のリスクが高まっていますが、ほとんどのスキャナーでは既定でネットワーク ログオンを使用します。|

Web 認証の場合、次の表のリファレンスを使用します。

|接続方法|ログオンの種類|接続先で再利用可能な資格情報|備考|
|-----------|-------|--------------------|------|
|IIS の "基本認証"|NetworkClearText<br />(IIS 6.0+)<p>Interactive (対話型)<br />(IIS 6.0 よりも前)|v||
|IIS の "統合 Windows 認証"|ネットワーク|-|NTLM および Kerberos プロバイダー。|

列の定義:

- **ログオンの種類**は、接続によって開始されたログオンの種類を識別します。
- **接続先で再利用可能な資格情報**は、指定されたアカウントにローカルにログオンする、接続先のコンピューターの LSASS プロセス メモリに、次の種類の資格情報が格納されることを示します。
   - LM および NT ハッシュ
   - Kerberos TGT
   - プレーンテキスト パスワード (該当する場合)

この表では、記号は次のように定義されています。

- (-) は資格情報が公開されないことを示します。
- (v) は資格情報が公開されることを示します。

この表に含まれていない管理アプリケーションについては、ログオン イベントの監査で、ログオンの種類フィールドからログオンの種類を特定できます。 詳細については、「[ログオン イベントの監査](/previous-versions/windows/it-pro/windows-server-2003/cc787567(v=ws.10))」を参照してください。

Windows ベースのコンピューターでは、使用する認証プロトコルや認証子に関係なく、すべての認証はいくつかのログオン種類の 1 つとして処理されます。 次の表に、最も一般的なログオンの種類と資格情報の盗難に関連する属性を示します。

|ログオンの種類|#|受け入れられる認証子|LSA セッションで再利用可能な資格情報|例|
|-------|---|--------------|--------------------|------|
|対話型 (別名、ローカルでログオン)|2 で保護されたプロセスとして起動されました|パスワード、スマートカード、<br />その他|はい|コンソールのログオン、<br />RUNAS、<br />ハードウェア リモート制御ソリューション (ネットワーク KVM やサーバー内の Remote Access/Lights-Out カードなど)<br />IIS の基本認証 (IIS 6.0 より前のバージョン)|
|ネットワーク|3|パスワード、<br />NT ハッシュ、<br />Kerberos チケット|いいえ (委任を有効にし、Kerberos チケットが存在する場合を除く)|NET USE、<br />RPC 呼び出し、<br />リモート レジストリ、<br />IIS の統合 Windows 認証、<br />SQL の Windows 認証|
|Batch (バッチ)|4|パスワード (通常、LSA シークレットとして格納される)|はい|スケジュールされたタスク|
|サービス|5|パスワード (通常、LSA シークレットとして格納される)|はい|Windows サービス|
|NetworkClearText|8|Password|はい|IIS の基本認証 (IIS 6.0 以降)、<br />Windows PowerShell と CredSSP|
|NewCredentials|9|Password|はい|RUNAS /NETWORK|
|RemoteInteractive|10|パスワード、スマートカード、<br />その他|はい|リモート デスクトップ (旧称 "ターミナル サービス")|

列の定義:

- **ログオンの種類**は、ログオン要求の種類です。
- **#** は、セキュリティ イベント ログに監査イベントで報告されるログオンの種類の数値識別子です。
- **受け入れられる認証子**は、この種類のログオンを開始できる認証子の種類を示します。
- **LSA セッションで再利用可能な資格情報**は、その種類のログオンの結果として、LSA セッションで、プレーンテキスト パスワード、NT ハッシュ、Kerberos チケットなどの資格情報が保持され、他のネットワーク リソースへの認証に使用できるかどうかを示します。
- **例**では、ログオンの種類が使用される一般的なシナリオを示します。

> [!NOTE]
> ログオンの種類の詳細については、「[SECURITY_LOGON_TYPE enumeration](/windows/win32/api/ntsecapi/ne-ntsecapi-security_logon_type)」 (SECURITY_LOGON_TYPE 列挙) を参照してください。