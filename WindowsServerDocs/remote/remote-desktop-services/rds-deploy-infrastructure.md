---
title: リモート デスクトップ環境を展開する
ms.custom: na
ms.prod: windows-server-threshold
description: リモート デスクトップ環境を展開する基本の手順。
ms.reviewer: na
ms.suite: na
ms.technology: remote-desktop-services
ms.author: elizapo
ms.date: 04/10/2017
ms.tgt_pltfrm: na
ms.topic: article
author: lizap
manager: dongill
ms.localizationpriority: medium
ms.openlocfilehash: 5b9ce1bb87a7a2ad8819235edc412fd095bc2985
ms.sourcegitcommit: 3743cf691a984e1d140a04d50924a3a0a19c3e5c
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/17/2019
ms.locfileid: "66805130"
---
# <a name="deploy-your-remote-desktop-environment"></a>リモート デスクトップ環境を展開する

>適用対象:Windows Server (半期チャネル)、Windows Server 2019、Windows Server 2016

以下の手順を使用して、環境内にリモート デスクトップ サーバーを展開します。 作成しようとしている環境が、オンプレミス、クラウド ベース、ハイブリッドのどれであるかに応じて、物理マシンまたは仮想マシンにサーバーの役割をインストールできます。 

リモート デスクトップ サービスのいずれかのサーバーに仮想マシンを使用している場合は、[それらの仮想マシンを準備](rds-prepare-vms.md)済みであることを確認してください。
  
  
1.  リモート デスクトップ サービスのために使用する予定のすべてのサーバーをサーバー マネージャーに追加します。  
    1.  サーバー マネージャーで、 **[管理]**  >  **[サーバーの追加]** をクリックします。  
    2.  **[Find Now]** をクリックします。  
    3.  展開内の各サーバーをクリックし (たとえば Contoso-Cb1、Contoso-WebGw1、および Contoso-Sh1)、 **[OK]** をクリックします。  
2.  リモート デスクトップ サービス コンポーネントを展開するセッション ベースの展開を作成します。  
    1.  サーバー マネージャーで、 **[管理]**  >  **[役割と機能の追加]** をクリックします。  
    2.  **[リモート デスクトップ サービスのインストール]** 、 **[標準の展開]** 、 **[セッション ベースのデスクトップ展開]** の順にクリックします。  
    3.  RD 接続ブローカー サーバー、RD Web アクセス サーバー、および RD セッション ホスト サーバーの適切なサーバーを選択します (たとえばそれぞれに、Contoso-Cb1、Contoso-WebGw1、Contoso-SH1)。  
    4.  **[必要に応じて対象サーバーを自動的に再起動する]** を選択し、 **[展開]** をクリックします。  
    5.  展開が正常に完了するまで待機します  
3.  RD ライセンス サーバーを追加します。  
    1.  サーバー マネージャーで、 **[リモート デスクトップ サービス] > [概要] > [+RD Licensing] (RD ライセンスの追加)** とクリックします。  
    2.  RD ライセンス サーバーがインストールされる仮想マシンを選択します (たとえば Contoso-Cb1)。  
    3.  **[次へ]** をクリックし、 **[追加]** をクリックします。  
4.  RD ライセンス サーバーをアクティブ化し、それをライセンス サーバー グループに追加します。  
    1.  サーバー マネージャーで、 **[ツール] > [ターミナル サービス] > [リモート デスクトップ ライセンス マネージャー]** とクリックします。  
    2.  RD ライセンス マネージャーで、サーバーを選択してから、 **[アクション] > [サーバーのアクティブ化]** とクリックします。  
    3.  **[会社についての情報]** ページに到達するまで既定値を受け入れるサーバーのアクティブ化ウィザードで既定値を受け入れます。 次に、会社についての情報を入力します。  
    4.  最後のページまでの残りのページでは既定値をそのまま使用します。 **[ライセンスのインストール ウィザードを開始する]** チェック ボックスをオフにして、 **[完了]** をクリックします。  
    5.  **[アクション] > [構成の確認] > [グループに追加] > [OK]** とクリックします。 AAD DC Administrators グループで、ユーザーの資格情報を入力し、SCP として登録します。 Azure AD Domain Services を使用している場合、この手順が機能しない可能性がありますが、警告やエラーは無視できます。  
5.  RD ゲートウェイ サーバーと証明書名を追加します。  
    1.  サーバー マネージャーで、 **[リモート デスクトップ サービス] > [概要] > [+RD Gateway] (RD ゲートウェイの追加)** とクリックします。  
    2.  RD ゲートウェイ サーバーの追加ウィザードで、RD ゲートウェイ サーバー (たとえば Contoso-WebGw1) をインストールする仮想マシンを選択します。  
    3.  RD ゲートウェイ サーバーの外部完全修飾 DNS 名 (FQDN) を使用して、RD ゲートウェイ サーバーの SSL 証明書名を入力します。 Azure では、これは **DNS 名**ラベルであり、servicename.location.cloudapp.azure.com という形式を使用します。 たとえば、contoso.westus.cloudapp.azure.com です。  
    4.  **[次へ]** をクリックし、 **[追加]** をクリックします。
6.  RD ゲートウェイ サーバーと RD 接続ブローカー サーバーの自己署名証明書を作成してインストールします。

       > [!NOTE]
       > 信頼された証明機関から証明書を提供し、インストールしている場合は、役割ごとにステップ h からステップ k までの手順を実行します。 これらの証明書ごとに .pfx ファイルを用意する必要があります。
       
    1.  サーバー マネージャーで、 **[リモート デスクトップ サービス] > [概要] > [タスク] > [Edit Deployment Properties] (展開プロパティの編集)** の順にクリックします。  
    2.  **[証明書]** を展開し、表まで下にスクロールします。 **[RD ゲートウェイ] > [新しい証明書の作成]** とクリックします。  
    3.  RD ゲートウェイ サーバー (たとえば、contoso.westus.cloudapp.azure.com) の外部 FQDN を使用して証明書名を入力し、パスワードを入力します。  
    4.  **[この証明書を保存する]** を選択してから、前のステップで証明書用に作成した共有フォルダーを参照します。 (たとえば、\Contoso Cb1\Certificates。)  
    5.  証明書のファイル名 (たとえば ContosoRdGwCert) を入力し、 **[保存]** をクリックします。  
    6.  **[Allow the certificate to be added to the Trusted Root Certificate Authorities certificate store on the destination computers] (対象のコンピューターの信頼されたルート証明機関の証明書ストアに証明書を追加できるようにする)** を選択して、 **[OK]** をクリックします。  
    7.  **[適用]** をクリックし、証明書が RD ゲートウェイ サーバーに正常に適用されるのを待ちます。  
    8.  **[RD Web アクセス] > [既存の証明書の選択]** とクリックします。  
    9.  RD ゲートウェイ サーバー (たとえば ContosoRdGwCert) 用に作成された証明書を参照してから、 **[開く]** をクリックします。  
    10. 証明書のパスワードを入力し、 **[Allow the certificate to be added to the Trusted Root Certificate store on the destination computers] (対象のコンピューターの信頼されたルート証明書ストアに証明書を追加できるようにする)** を選択して、 **[OK]** をクリックします。  
    11. **[適用]** をクリックし、証明書が RD Web アクセス サーバーに正常に適用されるのを待ちます。  
    12. 新しい証明書の名前 (たとえば Contoso-Cb1.Contoso.com) に RD 接続ブローカー サーバーの内部 FQDN を使用して、 **[RD 接続ブローカー - シングル サインオンを有効にする]** と **[RD Connection Broker - Publishing services] (RD 接続ブローカー - 公開サービス)** のサブステップ 1 ～ 11 を繰り返します。  
7.  自己署名パブリック証明書をエクスポートし、クライアント コンピューターにコピーします。 信頼された証明機関からの証明書を使用している場合は、この手順をスキップできます。  
    1.  certlm.msc を起動します。  
    2.  **[個人用]** を展開し、 **[証明書]** をクリックします。  
    3.  右側のウィンドウで、クライアント認証を目的とした RD 接続ブローカーの証明書 (たとえば **Contoso-Cb1.Contoso.com**) を右クリックします。  
    4.  **[すべてのタスク] > [エクスポート]** とクリックします。  
    5.  **[エクスポートするファイル]** ページに到達するまで既定値を受け入れる証明書のエクスポート ウィザードで既定のオプションを受け入れます。  
    6.  証明書のために作成した共有フォルダー (たとえば \Contoso-Cb1\Certificates) に移動します。  
    7.  ファイル名 (たとえば ContosoCbClientCert) を入力し、 **[保存]** をクリックします。  
    8.  **[次へ]** をクリックし、 **[完了]** をクリックします。  
    9.  エクスポートした証明書に適切なファイル名 (たとえば **ContosoWebGwClientCert**) を付けて、RD ゲートウェイ (たとえば contoso.westus.cloudapp.azure.com) と Web 証明書のサブステップ 1 ～ 8 を繰り返します。  
    10. ファイル エクスプローラーで、証明書が格納されているフォルダー (たとえば \Contoso-Cb1\Certificates) に移動します。  
    11. エクスポートした 2 つのクライアント証明書を選択し、それらを右クリックして **[コピー]** をクリックします。  
    12. ローカル クライアント コンピューターに証明書を貼り付けます。  
8.  RD ゲートウェイおよび RD ライセンスの展開のプロパティを構成します。  
    1.  サーバー マネージャーで、 **[リモート デスクトップ サービス] > [概要] > [タスク] > [Edit Deployment Properties] (展開プロパティの編集)** の順にクリックします。  
    2.  **[RD ゲートウェイ]** を展開し、 **[ローカル アドレスには RD ゲートウェイ サーバーを使用しない]** オプションをオフにします。  
    3.  **[RD ライセンス]** を展開し、 **[ユーザーごと]** を選択します  
    4.  **[OK]** をクリックします。  
10. セッション コレクションを作成します。 これらのステップでは、基本的なコレクションを作成します。 コレクションの詳細については、[デスクトップと実行するアプリのためにリモート デスクトップ サービスのコレクションを作成する](rds-create-collection.md)ことに関するページを参照してください。
 
    1.  サーバー マネージャーで、 **[リモート デスクトップ サービス] > [コレクション] > [タスク] > [セッション コレクションの作成]** の順にクリックします。  
    2.  コレクションの名前 (たとえば ContosoDesktop) を入力します。  
    3.  RD セッション ホスト サーバー (Contoso-Sh1) を選択し、既定のユーザー グループ (Contoso\Domain Users) をそのまま使用して、上で作成したユーザー プロファイル ディスクへの汎用名前付け規則 (UNC) パスを入力します (\Contoso-Cb1\UserDisks)。  
    4.  最大サイズを設定し、 **[作成]** をクリックします。  
  

これでリモート デスクトップ サービスの基本インフラストラクチャが作成されました。 高可用性の展開を作成する必要がある場合は、[接続ブローカー クラスター](rds-connection-broker-cluster.md)または [2 つ目の RD セッション ホスト サーバー](rds-scale-rdsh-farm.md)を追加できます。

