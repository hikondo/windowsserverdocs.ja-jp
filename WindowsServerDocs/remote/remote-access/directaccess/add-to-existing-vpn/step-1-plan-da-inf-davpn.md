---
title: 手順 1. DirectAccess インフラストラクチャを計画する
description: このトピックは、「Windows Server 2016 の既存のリモートアクセス (VPN) 展開に DirectAccess を追加する」の一部です。
manager: brianlic
ms.prod: windows-server
ms.technology: networking-da
ms.topic: article
ms.assetid: 4ca50ea8-6987-4081-acd5-5bf9ead62acd
ms.author: lizross
author: eross-msft
ms.openlocfilehash: be4d7028f1922152b2779e82a7c78d9b3a5b753a
ms.sourcegitcommit: b00d7c8968c4adc8f699dbee694afe6ed36bc9de
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/08/2020
ms.locfileid: "80859555"
---
# <a name="step-1-plan-directaccess-infrastructure"></a>手順 1. DirectAccess インフラストラクチャを計画する

>適用対象: Windows Server (半期チャネル)、Windows Server 2016

基本的なリモート アクセスの展開を計画する際の最初の手順は、展開に必要なインフラストラクチャを計画することです。 このトピックでは、インフラストラクチャの計画手順を説明します。  
  
|タスク|説明|  
|----|--------|  
|ネットワークのトポロジと設定を計画する|リモート アクセス サーバーの配置場所 (エッジか、ネットワーク アドレス変換 (NAT) デバイスまたはファイアウォールの内側) を決定し、IP アドレス指定およびルーティングを計画します。|  
|ファイアウォールの要件を計画する|エッジ ファイアウォール経由のリモート アクセスの許可を計画します。|  
|証明書の要件を計画する|リモート アクセスでは、クライアント認証に Kerberos または証明書を使用できます。 この基本的なリモート アクセスの展開では、Kerberos が自動的に構成され、リモート アクセス サーバーによって自動的に発行される自己署名証明書を使用して、認証が実行されます。|  
|DNS の要件を計画する|リモート アクセス サーバー、インフラストラクチャ サーバー、ローカルでの名前解決オプション、およびクライアント接続に関する DNS 設定を計画します。|  
|Active Directory を計画する|ドメイン コントローラーと Active Directory の要件を計画します。|  
|グループ ポリシー オブジェクトを計画する|組織で必要な GPO とその GPO の作成または編集方法を決定します。|  
  
計画タスクは特定の順序で実行する必要はありません。  
  
## <a name="plan-network-topology-and-settings"></a>ネットワークのトポロジと設定を計画する  
  
### <a name="plan-network-adapters-and-ip-addressing"></a>ネットワーク アダプターと IP アドレス指定を計画する  
  
1. 使用するネットワーク アダプターのトポロジを決定します。 リモート アクセスは次のいずれかを使ってセットアップできます。  
  
    - 2つのネットワークアダプターがある場合: 1 つのネットワークアダプターがインターネットに接続されていて、もう一方が境界ネットワークに接続され、もう一方のネットワークアダプターが内部ネットワークに接続されています。ネットワーク.  
  
    - NAT デバイスの背後に1つのネットワークアダプターがある場合: リモートアクセスサーバーが NAT デバイスの内側にインストールされ、1つのネットワークアダプターが内部ネットワークに接続されます。  
  
2. IP アドレス指定の要件を特定します。  
  
    DirectAccess は、IPv6 と IPsec を組み合わせて、DirectAccess クライアント コンピューターと企業内部ネットワークとの間にセキュリティで保護された接続を確立します。 ただし、DirectAccess は、IPv6 インターネットへの接続または内部ネットワーク上でのネイティブ IPv6 サポートを必ずしも必要とはしません。 その代わりに、IPv6 移行テクノロジを自動的に構成、使用して、IPv4 インターネット上 (6to4、Teredo、IP-HTTPS) および IPv4 専用イントラネット上 (NAT64 または ISATAP) で IPv6 トラフィックをトンネリングします。 このような移行テクノロジの概要については、次のリソースを参照してください。  
  
    - [IPv6 移行テクノロジ](https://technet.microsoft.com/library/bb726951.aspx)  
  
    - [Ip-https トンネリングプロトコル仕様](https://msdn.microsoft.com/library/dd358571.aspx)  
  
3. 次の表に従って、必要なアダプターとアドレス指定を構成します。 1つのネットワークアダプターを使用して NAT デバイスの背後に配置する場合は、[内部ネットワークアダプター] 列のみを使用して IP アドレスを構成します。  
  
    |IP アドレスの種類|外部ネットワーク アダプター|内部ネットワーク アダプター|ルーティングの要件|  
    |-|--------------|--------------------|------------|  
    |IPv4 イントラネットおよび IPv4 インターネット|次の内容を構成します。<br/><br/>-適切なサブネットマスクを持つ1つの静的パブリック IPv4 アドレス。<br/>-インターネットファイアウォールまたはローカルインターネットサービスプロバイダー (ISP) ルーターのデフォルトゲートウェイ IPv4 アドレス。|次の内容を構成します。<br/><br/>適切なサブネット マスクを持つ IPv4 イントラネット アドレスが。<br/>-イントラネット名前空間の接続固有の DNS サフィックス。 DNS サーバーは内部インターフェイスにも構成する必要があります。<br/>-イントラネットインターフェイスに既定のゲートウェイを構成しないでください。|内部 IPv4 ネットワーク上のすべてのサブネットに到達できるようにリモート アクセス サーバーを構成するには、次のようにします。<br/><br/>1. イントラネット上のすべての場所の IPv4 アドレス空間を一覧表示します。<br/>2. **route add-p**または**netsh interface ipv4 add route**コマンドを使用して、ipv4 アドレス空間を静的ルートとしてリモートアクセスサーバーの ipv4 ルーティングテーブルに追加します。|  
    |IPv6 インターネットおよび IPv6 イントラネット|次の内容を構成します。<br/><br/>-ISP によって提供される自動構成されたアドレス構成を使用します。<br/>- **Route print**コマンドを使用して、ISP ルーターを指す既定の ipv6 ルートが ipv6 ルーティングテーブルに存在することを確認します。<br/>-ISP ルーターとイントラネットルーターが RFC 4191 で説明されている既定のルーター基本設定を使用し、ローカルイントラネットルーターよりも高い既定の基本設定を使用しているかどうかを確認します。 どちらについても使用している場合は、既定のルートに他の構成は必要ありません。 ISP ルーターの高度な基本設定によって、リモート アクセス サーバーの既定の IPv6 アクティブ ルートが IPv6 インターネットを示すことが保証されます。<br/><br/>リモート アクセス サーバーは IPv6 ルーターであるため、ネィティブ IPv6 インフラストラクチャがある場合は、インターネット インターフェイスからイントラネット上のドメイン コントローラに到達することもできます。 この場合、リモート アクセス サーバーのインターネット接続インターフェイスの IPv6 アドレスへの接続を防ぐ境界ネットワークのドメイン コントローラーに、パケット フィルターを追加します。|次の内容を構成します。<br/><br/>-既定の基本設定レベルを使用していない場合は、 **netsh interface ipv6 Set InterfaceIndex ignoredefaultroutes = enabled**コマンドを使用してイントラネットインターフェイスを構成します。 このコマンドを実行すると、イントラネット ルーターを示す既定のルートがそれ以上 IPv6 ルーティング テーブルに追加されないことが保証されます。 イントラネット インターフェイスの InterfaceIndex は、netsh interface show interface コマンドの表示で確認できます。|IPv6 イントラネットがある場合、IPv6 のすべての場所に到達できるようにリモート アクセス サーバーを構成するには、次のようにします。<br/><br/>1. イントラネット上のすべての場所の IPv6 アドレス空間を一覧表示します。<br/>2. **netsh interface ipv6 add route**コマンドを使用して、ipv6 アドレス空間を静的ルートとしてリモートアクセスサーバーの ipv6 ルーティングテーブルに追加します。|  
    |IPv6 インターネットおよび IPv4 イントラネット|リモート アクセス サーバーは、IPv4 インターネット上の 6to4 リレーへの Microsoft 6to4 Adapter インターフェイスを使って、既定の IPv6 ルート トラフィックを転送します。 IPv4 インターネット上に Microsoft 6to4 リレーの IPv4 アドレス用リモート アクセス サーバーを構成するには (企業ネットワークにネイティブ IPv6 が展開されていないときに使用)、netsh interface ipv6 6to4 set relay name=192.88.99.1 state=enabled コマンドを使用できます。|||  
  
    > [!NOTE]
    > 1. パブリック IPv4 アドレスが割り当てられている DirectAccess クライアントは、6to4 移行テクノロジを使ってイントラネットに接続します。 6to4 を使って DirectAccess サーバーに接続できない DirectAccess クライアントは、IP-HTTPS を使用します。  
    > 2. ネイティブ IPv6 クライアント コンピューターは、ネイティブ IPv6 経由でリモート アクセス サーバーに接続できます。移行テクノロジを必要としません。  
  
### <a name="plan-firewall-requirements"></a>ファイアウォールの要件を計画する

エッジ ファイアウォールの背後に設置されたリモート アクセス サーバーが IPv4 インターネット上にあるときは、リモート アクセス トラフィックについて次の例外が必要になります。  
  
- 6to4 トラフィックの IP プロトコル 41 の受信および送信します。  
  
- IP-HTTPS の伝送制御プロトコル (TCP) 宛先ポート 443 と TCP 発信元ポート 443 が送信されます。  
  
- 1 つのネットワーク アダプターを使ってリモート アクセスを展開し、ネットワーク ロケーション サーバーをリモート アクセス サーバーにインストールする場合は、TCP ポート 62000 も除外する必要があります。  
  
リモート アクセス サーバーが IPv6 インターネット上にあるときは、リモート アクセス トラフィックについて次の例外が必要になります。  
  
- IP プロトコル 50  
  
- UDP 宛先ポート 500 の受信と、UDP 発信元ポート 500 の送信。  
  
追加のファイアウォールを使用する場合は、次の内部ネットワーク ファイアウォール例外をリモート アクセス トラフィックに適用します。  
  
- ISATAP-プロトコル 41 の受信と送信  
  
- すべての IPv4/IPv6 トラフィックに対する TCP/UDP  
  
### <a name="plan-certificate-requirements"></a>証明書の要件を計画する

IPsec の証明書の要件には、DirectAccess クライアント コンピューターとリモート アクセス サーバーとの間で IPsec 接続を確立するときにクライアントによって使用されるコンピューター証明書と、DirectAccess クライアントとの IPsec 接続を確立するためにリモート アクセス サーバーによって使用されるコンピューター証明書が含まれます。 Windows Server 2012 の DirectAccess の場合、これらの IPsec 証明書の使用は必須ではありません。 DirectAccess の有効化ウィザードでは、証明書を要求せずに IPsec 認証を実行する Kerberos プロキシとして機能するようにリモート アクセス サーバーを構成します。  
  
1. **Ip-https サーバー**: リモートアクセスを構成すると、リモートアクセスサーバーは ip-https web リスナーとして機能するように自動的に構成されます。 IP-HTTPS サイトは Web サイト証明書を要求します。また、クライアント コンピューターは、その証明書の証明書失効リスト (CRL) サイトに接続できる必要があります。 DirectAccess の有効化ウィザードでは、SSTP VPN 証明書の使用を試みます。 SSTP が構成されていない場合は、IP-HTTPS の証明書がコンピューターの個人用ストアにあるかどうを確認します。 どれも使用できない場合は、自己署名証明書を自動的に作成します。  
  
2. **ネットワークロケーションサーバー**: ネットワークロケーションサーバーは、企業ネットワーク内にクライアントコンピューターが配置されているかどうかを検出するために使用される web サイトです。 ネットワーク ロケーション サーバーには、Web サイト証明書が必要です。 DirectAccess クライアントは、その証明書の CRL サイトに接続できる必要があります。 DirectAccess の有効化ウィザードでは、ネットワーク ロケーション サーバーの証明書がコンピューターの個人用ストアにあるかどうかを確認します。 ない場合は、自己署名証明書を自動的に作成します。  
  
これらの各要素の認定要件を次の表にまとめます。  
  
|IPsec 認証|IP-HTTPS サーバー|ネットワーク ロケーション サーバー|  
|------------|----------|--------------|  
|認証に Kerberos プロキシを使用しない場合、IPsec 認証用にリモートアクセスサーバーおよびクライアントに対してコンピューター証明書を発行するには、内部 CA が必要です。|パブリック CA: IP-HTTPS 証明書を発行するためにパブリック CA を使用することをお勧めします。これにより、CRL 配布ポイントを外部で使用できるようになります。|内部 CA: 内部 CA を使用して、ネットワークロケーションサーバーの web サイト証明書を発行できます。 CRL 配布ポイントが内部ネットワークからいつでも利用できることを確認してください。|  
||内部 CA: 内部 CA を使用して ip-https 証明書を発行できます。ただし、CRL 配布ポイントが外部で使用可能であることを確認する必要があります。|自己署名証明書: ネットワークロケーションサーバーの web サイトの自己署名証明書を使用できます。ただし、マルチサイト展開では自己署名証明書を使用できません。|  
||自己署名証明書: IP-HTTPS サーバーの自己署名証明書を使用できます。ただし、CRL 配布ポイントが外部で使用可能であることを確認する必要があります。 自己署名証明書はマルチサイト展開で使用できません。||  
  
#### <a name="plan-certificates-for-ip-https"></a>IP-HTTPS の証明書を計画する

リモート アクセス サーバーは IP-HTTPS リスナーとして動作します。HTTPS Web サイト証明書をサーバーに手動でインストールする必要があります。 計画時には次のことに注意します。  
  
- CRL がすぐに使用できるように、パブリック CA を使用することをお勧めします。  
  
- サブジェクト フィールドに、リモート アクセス サーバーのインターネット アダプターの IPv4 アドレスまたは IP-HTTPS URL (ConnectTo アドレス) の FQDN のいずれかを指定します。 リモート アクセス サーバーが NAT デバイスの内側に存在する場合は、NAT デバイスのパブリック名またはアドレスを指定する必要があります。  
  
- 証明書の共通名は、IP-HTTPS サイトの名前と一致している必要があります。  
  
- [拡張キー使用法] フィールドに、サーバー認証オブジェクト識別子 (OID) を使用します。  
  
- [CRL 配布ポイント] フィールドに、インターネットに接続している DirectAccess クライアントがアクセスできる CRL 配布ポイントを指定します。  
  
- IP-HTTPS 証明書には秘密キーが必要です。  
  
- IP-HTTPS 証明書は、個人用ストアに直接インポートする必要があります。  
  
- IP-HTTPS 証明書の名前にはワイルドカードを含めることができます。  
  
#### <a name="plan-website-certificates-for-the-network-location-server"></a>ネットワーク ロケーション サーバーの Web サイト証明書を計画する

ネットワーク ロケーション サーバー Web サイトを計画するには、次の点に注意してください。  
  
- サブジェクト フィールドに、ネットワーク ロケーション サーバーのイントラネット インターフェイスの IP アドレスまたはネットワーク ロケーション URL の FQDN のいずれかを指定します。  
  
- 拡張キー使用法フィールドに、サーバー認証 OID を使用します。  
  
- CRL 配布ポイント フィールドに、イントラネットに接続している DirectAccess クライアントがアクセスできる CRL 配布ポイントを指定します。 この CRL 配布ポイントは、内部ネットワークの外側からアクセスできないようにしてください。  
  
- 後でマルチサイトまたはクラスタ展開の構成を予定している場合は、証明書の名前がリモート アクセス サーバーの内部名と一致していてはなりません。  

    > [!NOTE]  
    > IP-HTTPS とネットワーク ロケーション サーバーの証明書に**サブジェクト名**があることを確認してください。 証明書に**サブジェクト名**がなく、**代替名**がある場合は、リモート アクセス ウィザードで受け付けられません。  
  
#### <a name="plan-dns-requirements"></a>DNS の要件を計画する

リモート アクセスの展開では、次に対して DNS が必要です。  
  
- **Directaccess クライアント要求**: DNS は、内部ネットワークに配置されていない directaccess クライアントコンピューターからの要求を解決するために使用されます。 DirectAccess クライアントは、DirectAccess ネットワークロケーションサーバーへの接続を試行して、インターネットまたは企業ネットワーク上に配置されているかどうかを判断します。接続が成功した場合、クライアントはイントラネット上にあると判断され、DirectAccess は使用されず、クライアントの要求は、クライアントコンピューターのネットワークアダプターに構成されている DNS サーバーを使用して解決されます。 接続に失敗した場合、クライアントはインターネット上にあると見なされます。 DirectAccess クライアントは名前解決ポリシー テーブル (NRPT) を使って、名前の要求を解決するときに使用する DNS サーバーを判断します。 クライアントが名前解決に DirectAccess DNS64 または代替の内部 DNS サーバーを使用するように指定することができます。 名前解決の実行時、NRPT が DirectAccess クライアントによって使用されて、要求の処理方法が特定されます。 クライアントは、<https://internal>などの FQDN または単一ラベル名を要求します。 単一ラベル名が要求の場合は、DNS サフィックスが追加されて FQDN になります。 DNS クエリが NRPT 内のエントリに一致し、そのエントリに対して DNS4 またはイントラネット DNS サーバーが指定されている場合、そのクエリは指定されたサーバーを使って名前解決のために送信されます。 一致するエントリはあっても DNS サーバーが指定されていない場合は、除外規則を意味しているので、通常の名前解決が適用されます。  
  
    リモート アクセス管理コンソールで NRPT に新しいサフィックスを追加するとき、そのサフィックスの既定の DNS サーバーを自動的に検出するには、 **[検出]** をクリックします。 自動検出のしくみは次のとおりです。  
  
    1. 企業ネットワークが IPv4 ベースまたは IPv4 と IPv6 の組み合わせである場合、既定のアドレスはリモート アクセス サーバー上の内部アダプター DNS64 アドレスです。  
  
    2. 企業ネットワークが IPv6 ベースである場合、既定のアドレスは、企業ネットワーク内の DNS サーバーの IPv6 アドレスです。  
  
-  **インフラストラクチャサーバー**  
  
    1. **ネットワークロケーションサーバー**: DirectAccess クライアントがネットワークロケーションサーバーに接続し、内部ネットワーク上にあるかどうかを確認します。 内部ネットワーク上のクライアントは、ネットワーク ロケーション サーバーの名前を解決できる必要がありますが、インターネットに配置されているときは名前を解決できないようにする必要があります。 このような処理が行われるように、既定では、ネットワーク ロケーション サーバーの FQDN が除外規則として NRPT に追加されます。 また、リモート アクセスを構成する場合、次の規則が自動的に作成されます。  
  
        1. ルート ドメインまたはリモート アクセス サーバーのドメイン名の DNS サフィックス規則、およびリモート アクセス サーバー上に構成されたイントラネット DNS サーバーに対応する IPv6 アドレス。 たとえば、リモート アクセス サーバーが corp.contoso.com ドメインのメンバーである場合、corp.contoso.com DNS サフィックスについて規則が作成されます。  
  
        2. ネットワーク ロケーション サーバーの FQDN の除外規則。 たとえば、ネットワークロケーションサーバーの URL が <https://nls.corp.contoso.com>場合、FQDN nls.corp.contoso.com に対して除外ルールが作成されます。  
  
        **Ip-https サーバー**: リモートアクセスサーバーは ip-https リスナーとして機能し、そのサーバー証明書を使用して ip-https クライアントを認証します。 IP-HTTPS 名は、パブリック DNS サーバーを使って DirectAccess クライアントによって解決できる必要があります。  
  
        **接続検証**方法: リモートアクセスは、DirectAccess クライアントコンピューターが内部ネットワークへの接続を確認するために使用する既定の web プローブを作成します。 プローブが想定どおりに動作するように、次の名前を DNS 内に手動で登録する必要があります。  
  
        1.  directaccess-webprobehost は、リモートアクセスサーバーの内部 IPv4 アドレス、または IPv6 専用環境の IPv6 アドレスに解決される必要があります。  
  
        2.  corpconnectivityhost は、localhost (ループバック) アドレスに解決される必要があります。 A レコードと AAAA レコードが作成されます。A レコードは 127.0.0.1 の値を持ち、AAAA レコードは NAT64 プレフィックスと最後の 32 ビットが 127.0.0.1 で構成される値を持ちます。 NAT64 プレフィックスは、コマンドレット get-netnattransitionconfiguration を実行して取得できます。  
  
            > [!NOTE]  
            > これは IPv4 専用環境でのみ有効です。 IPv4+IPv6、または IPv6 専用環境では、AAAA レコードのみをループバック IP アドレス ::1 で作成する必要があります。  
  
        HTTP または PING 経由で他の Web アドレスを使用して、追加の接続検証方法を作成できます。 接続検証方法ごとに、DNS エントリが存在している必要があります。  
  
#### <a name="dns-server-requirements"></a>DNS サーバーの要件  
  
- DirectAccess クライアントの場合は、Windows Server 2003、Windows Server 2008、Windows Server 2008 R2、Windows Server 2012、または IPv6 をサポートする任意の DNS サーバーのいずれかを実行している DNS サーバーを使用する必要があります。  
  
### <a name="plan-active-directory"></a>Active Directory を計画する

リモートアクセスでは、次のように Active Directory と Active Directory グループポリシーオブジェクトを使用します。  
  
- **認証**: 認証には Active Directory が使用されます。 イントラネット トンネルでは、内部リソースにアクセスするユーザーに対して Kerberos 認証を使用します。  
  
- **グループポリシーオブジェクト**: リモートアクセスは、リモートアクセスサーバー、クライアント、および内部アプリケーションサーバーに適用されるグループポリシーオブジェクトに、構成設定を収集します。  
  
- **セキュリティグループ**: リモートアクセスは、セキュリティグループを使用して、DirectAccess クライアントコンピューターとリモートアクセスサーバーをまとめて収集し、識別します。 グループ ポリシーは必要なセキュリティ グループに適用されます。  
  
- **拡張 ipsec ポリシー**: リモートアクセスでは、クライアントとリモートアクセスサーバー間で ipsec 認証と暗号化を使用できます。 IPsec 認証と暗号化を、指定した内部アプリケーション サーバーまで拡張できます。   
  
#### <a name="active-directory-requirements"></a>Active Directory の用件  
  
リモート アクセスの展開用に Active Directory を計画するときは、次のことが必要です。  
  
- Windows server 2012、Windows Server 2008 R2、Windows Server 2008、または Windows Server 2003 オペレーティングシステムにインストールされているドメインコントローラーが少なくとも1つ。  
  
    ドメイン コントローラーが境界ネットワーク上にある場合は (したがってリモート アクセス サーバーのインターネット接続ネットワーク アダプターからアクセスできる)、インターネット アダプターの IP アドレスへの接続を禁止するため、ドメイン コントローラー上でパケット フィルターを追加してリモート アクセス サーバーがアクセスできないようにします。  
  
- リモート アクセス サーバーはドメイン メンバーである必要があります。  
  
- DirectAccess クライアントは、ドメイン メンバーである必要があります。 クライアントは次に所属することができます。  
  
    - リモート アクセス サーバーと同じフォレスト内の任意のドメイン。  
  
    - リモート アクセス サーバー ドメインと双方向の信頼関係がある任意のドメイン。  
  
    - リモート アクセス ドメインが所属するフォレストと双方向の信頼関係があるフォレスト内の任意のドメイン。  
  
> [!NOTE]  
> - リモート アクセス サーバーはドメイン コントローラーにできません。  
> - リモート アクセス用に使用される Active Directory ドメイン コントローラーは、リモート アクセス サーバーの外部インターネット アダプター (アダプターは Windows ファイアウォールのドメイン プロファイルにあってはいけません) からアクセスできてはいけません。  
  
### <a name="plan-group-policy-objects"></a>グループ ポリシー オブジェクトを計画する

リモート アクセスの構成時に構成された DirectAccess 設定はグループ ポリシー オブジェクト (GPO) に収集されます。 次に示すとおり、DirectAccess の設定は 3 つの異なる GPO に読み込まれて配布されます。  
  
- **DirectAccess クライアント gpo**: この gpo には、IPv6 移行テクノロジの設定、NRPT エントリ、セキュリティが強化された Windows ファイアウォールの接続セキュリティ規則を含むクライアント設定が含まれています。 この GPO は、クライアント コンピューターに対して指定されたセキュリティ グループに適用されます。  
  
- **Directaccess サーバー GPO**: この gpo には、展開でリモートアクセスサーバーとして構成されている任意のサーバーに適用される directaccess 構成設定が含まれています。 また、セキュリティが強化された Windows ファイアウォールの接続セキュリティの規則も含まれます。  
  
- **アプリケーションサーバー GPO**: この gpo には、必要に応じて DirectAccess クライアントからの認証と暗号化を拡張する、選択したアプリケーションサーバーの設定が含まれています。 認証と暗号化を拡張しない場合、この GPO は使用されません。  
  
GPO は DirectAccess の有効化ウィザードによって自動的に作成され、各 GPO に既定名が指定されます。  
  
> [!CAUTION]  
> DirectAccess コマンドレットを実行する前に、すべてのリモートアクセスグループポリシーオブジェクトをバックアップするには、次の手順を使用します。[リモートアクセス構成のバックアップと復元](https://go.microsoft.com/fwlink/?LinkID=257928)  
  
GPO は 2 つの方法で構成できます。  
  
1. **自動**: 自動的に作成されるように指定できます。 各 GPO には既定の名前が指定されます。  
  
2. **手動**: Active Directory 管理者によって事前に定義されている gpo を使用できます。  
  
特定の GPO を使用するように DirectAccess をいったん構成してしまうと、別の GPO の使用を構成できなくなることに注意してください。  
  
#### <a name="automatically-created-gpos"></a>自動的に作成された GPO

自動的に作成された GPO を使用するときは、次の点に注意してください。  
  
自動的に作成された GPO は、次に示すように、場所とリンク先のパラメーターに基づいて適用されます。  
  
- DirectAccess サーバー GPO の場合、場所とリンクのパラメーターはどちらも、リモート アクセス サーバーを含むドメインを示します。  
  
- クライアント GPO が作成されると、場所は GPO の作成先となる単一ドメインに設定されます。 GPO 名は各ドメインで検索され、存在する場合は DirectAccess の設定が読み込まれます。 リンク先は GPO が作成されたドメインのルートに設定されます。 GPO はクライアント コンピューターまたはアプリケーション サーバーを含むドメインごとに作成され、その個々のドメインのルートにリンクされます。  
  
自動で作成された GPO を使用しているときに DirectAccess の設定を適用する場合、リモート アクセス サーバー管理者は次のアクセス許可が必要になります。  
  
- 各ドメインの GPO 作成アクセス許可。  
  
- 選択したすべてのクライアント ドメイン ルートのリンク アクセス許可。  
  
- サーバー GPO ドメイン ルートのリンク アクセス許可。  
  
- セキュリティの作成、編集、削除、および変更のアクセス許可が GPO には必要です。  
  
- リモート アクセス管理者が、必要なドメインごとに GPO 読み取りアクセス許可を持つことが推奨されます。 これによって、GPO の作成時に、重複する名前の GPO が存在しないことをリモート アクセスが確認できるようになります。  
  
GPO をリンクするための正しいアクセス許可がない場合は、警告が表示されることに注意してください。 リモート アクセスの操作は続行されますが、リンク処理は行われません。 この警告が表示された場合は、後でアクセス許可が設定されても、リンクは自動的には作成されません。 代わりに、管理者がリンクを手動で作成する必要があります。  
  
#### <a name="manually-created-gpos"></a>手動で作成された GPO

手動で作成された GPO を使用するときは、次の点に注意してください。  
  
- GPO はリモート アクセス セットアップ ウィザードを実行する前に存在している必要があります。  
  
- 手動で作成された GPO を使用しているとき DirectAccess の設定を適用する場合、リモート アクセス管理者はそれらの GPO に対する完全な GPO アクセス許可 (セキュリティの編集、削除、および変更) が必要になります。  
  
- 手動で作成された GPO を使用しているときは、GPO へのリンクがドメイン全体で検索されます。 GPO がドメイン内でリンクされていない場合は、ドメイン ルート内にリンクが自動的に作成されます。 リンクを作成するために必要なアクセス許可がない場合は、警告が表示されます。  
  
GPO をリンクするための正しいアクセス許可がない場合は、警告が表示されることに注意してください。 リモート アクセスの操作は続行されますが、リンク処理は行われません。 この警告が表示された場合は、後でアクセス許可を追加しても、リンクは自動的には作成されません。 代わりに、管理者がリンクを手動で作成する必要があります。  
  
#### <a name="recovering-from-a-deleted-gpo"></a>削除された GPO からの回復

リモート アクセス サーバー、クライアント、またはアプリケーション サーバーの GPO が誤って削除され、バックアップも使用できない場合は、構成設定を削除し、再構成する必要があります。 バックアップを使用できる場合は、バックアップから GPO を復元できます。  
  
**リモートアクセス管理**で、 **gpo (gpo 名) が見つからないこと**を示すエラーメッセージが表示されます。 構成設定を削除するには、次の手順に従います。  
  
1. PowerShell コマンドレット **Uninstall-remoteaccess** を実行します。  
  
2. **リモートアクセス管理**を再度開きます。  
  
3. GPO が見つからないというエラー メッセージが表示されます。 **[構成設定の削除]** をクリックします。 完了すると、サーバーが未構成の状態に復元されます。  

