---
title: '手順 2: DirectAccess VPN サーバーを構成する'
description: このトピックは、「Windows Server 2016 の既存のリモートアクセス (VPN) 展開に DirectAccess を追加する」の一部です。
manager: brianlic
ms.topic: article
ms.assetid: fe221fc9-c7d9-4508-b8a1-000d2515283c
ms.author: lizross
author: eross-msft
ms.openlocfilehash: a9206ca86f9b64036b9a16d29e6c442268c3d4ed
ms.sourcegitcommit: dfa48f77b751dbc34409aced628eb2f17c912f08
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/07/2020
ms.locfileid: "87953728"
---
#  <a name="step-2-configure-the-directaccess-vpn-server"></a>手順 2: DirectAccess VPN サーバーを構成する

>適用先:Windows Server (半期チャネル)、Windows Server 2016

このトピックでは、DirectAccess の有効化ウィザードを使用して、基本的なリモート アクセスの展開に必要なクライアントおよびサーバー設定を構成する方法について説明します。

次の表に、このトピックを使用して実行できる手順の概要を示します。

|タスク       |説明|
|-----------|-----------|
|DirectAccess クライアントを構成する|DirectAccess クライアントを含むセキュリティ グループでリモート アクセス サーバーを構成します。|
|ネットワーク トポロジを構成する|リモート アクセス サーバー設定を構成します。|
|DNS サフィックス検索一覧を構成する|必要に応じて、サフィックス検索一覧を変更します。|
|GPO 構成|必要に応じて、GPO を変更します。|

## <a name="to-start-the-enable-directacces-wizard"></a>DirectAccess の有効化ウィザードを起動するには

1. サーバーマネージャーで、[**ツール**] をクリックし、[**リモートアクセス**] をクリックします。DirectAccess の有効化ウィザードは、[**次回からこの画面を表示**しない] を選択していない限り、自動的に開始されます。

2. ウィザードが自動的に起動しない場合は、[ルーティングとリモート アクセス] ツリーのサーバー ノードを右クリックし、[**DirectAccess の有効化**] をクリックします。

3. **[次へ]** をクリックします。

## <a name="configure-directaccess-clients"></a>DirectAccess クライアントを構成する

DirectAccess を使用するようにプロビジョニングするクライアント コンピューターは、選択したセキュリティ グループに属している必要があります。 DirectAccess の構成後、セキュリティ グループのクライアント コンピューターが DirectAccess グループ ポリシーを受け取るようにプロビジョニングされます。

1. [**グループの選択**] ページで、[**追加**] をクリックします。

2. [**グループの選択**] ダイアログ ボックスで、DirectAccess クライアント コンピューターを含むセキュリティ グループを選択します。

3. [**モバイル コンピューターに対してのみ DirectAccess を有効にする**] チェック ボックスをオンにし、モバイル コンピューターのみが内部ネットワークにアクセスできるようにします。

4. [**強制トンネリングを使用する**] チェック ボックスをオンにし、すべてのクライアント トラフィックをリモート アクセス サーバー経由で (内部ネットワークおよびインターネットへ) ルーティングします。

5. **[次へ]** をクリックします。

## <a name="configure-the-network-topology"></a>ネットワーク トポロジを構成する

リモート アクセスを展開するには、正しいネットワーク アダプター、クライアント コンピューターが接続できるリモート アクセス サーバーのパブリック URL (対処する接続)、対処する接続にサブジェクトが一致する IP-HTTPS 証明書を使用して、リモート アクセス サーバーを構成する必要があります。

1. [**ネットワーク トポロジ**] ページで、組織で使用する展開トポロジをクリックします。 [**クライアントからリモート アクセス サーバーへの接続に使用するパブリック名または IPv4 アドレスを入力してください**] に展開のパブリック名を入力し (この名前は IP-HTTPS 証明書のサブジェクト名に一致し、edge1.contoso.com などになります)、[**次へ**] をクリックします。

## <a name="configure-the-dns-suffix-search-list"></a>DNS サフィックス検索一覧を構成する

DNS クライアントでは、DNS ドメイン サフィックス検索一覧を構成して、DNS 検索機能を拡張したり、変更したりできます。 一覧にサフィックスを追加することによって、指定した複数の DNS ドメイン内で、短い修飾されていないコンピューター名を検索できます。 DNS クエリが失敗した場合、DNS クライアント サービスではこの一覧を使用して別の名前サフィックスを元の名前に付加し、これらの代替の FQDN で DNS サーバーに対して DNS クエリを繰り返すことができます。

1. [**DNS クライアントのサフィックス検索一覧を使用して DirectAccess クライアントを構成する**] を選択し、クライアント名の検索用の追加のサフィックスを指定します。

2. **新しいサフィックスに新しい**サフィックス名を入力し、[**追加**] をクリックします。 また、**使用するドメインサフィックス**の検索順序を変更したり、サフィックスを削除したりすることができます。

>付箋\(1 つまたは複数のドメインコンピュータに、コンピュータが属している Active Directory ドメインと一致しない DNS サフィックスがある、不整合な名前空間のシナリオでは、 \) 必要なすべてのサフィックスを含めるように検索リストがカスタマイズされていることを確認する必要があります。 リモート アクセス ウィザードは既定で、Active Directory DNS 名をクライアントのプライマリ DNS サフィックスとして構成します。 管理者は、クライアントが名前の解決に使用する DNS サフィックスを追加していることを確認する必要があります。

コンピューターとサーバーでは、次の既定の DNS 検索動作が事前に定義されており、短い非修飾名を完了および解決するときに使用されます。サフィックス検索一覧が空か、指定されていない場合は、コンピューターのプライマリ DNS サフィックスが短い非修飾名に付加され、DNS クエリを使用して結果の FQDN が解決されます。

このクエリが失敗した場合、コンピューターは、ネットワーク接続用に構成された接続固有の DNS サフィックスを追加することによって、代替 Fqdn に対して追加のクエリを実行できます。接続固有のサフィックスが構成されていない場合、またはこのような接続固有の Fqdn のクエリが失敗した場合、クライアントはプライマリサフィックス (デボルブとも呼ばれます) の体系的な削減に基づいて、クエリの再試行を開始できます。

たとえば、プライマリサフィックスが "example.microsoft.com" の場合、デボルブプロセスでは、"microsoft.com" および "com" ドメインで短い名前を検索することで、短い名前のクエリを再試行できます。

サフィックス検索リストが空でなく、少なくとも1つの DNS サフィックスが指定されている場合、短い DNS 名の修飾と解決は、指定されたサフィックスリストによって可能になった Fqdn のみを検索するように制限されます。

一覧内の各サフィックスの追加と試行の結果として形成されるすべての FQDN のクエリが解決されない場合、クエリ プロセスは失敗し、"名前が見つかりません" という結果が生成されます。

> [!WARNING]
> ドメイン サフィックス一覧を使用した場合、クライアントはクエリが応答されないか、解決されない場合に、さまざまな DNS ドメイン名に基づいて、追加の代替クエリを送信し続けます。 サフィックス一覧のエントリを使用して名前が解決されると、未使用の一覧のエントリは試されません。 このため、一覧は、最も多く使用されるドメイン サフィックスを先頭にして順序付けると最も効率的です。
>
> ドメイン名サフィックス検索は、DNS 名エントリが完全に修飾されていない場合にのみ使われます。 DNS 名を完全修飾するには、名前の最後に末尾のピリオド (.) を入力します。

## <a name="gpo-configuration"></a>GPO 構成

リモートアクセスを構成すると、グループポリシーオブジェクト (GPO) に DirectAccess 設定が収集されます。

[ **Gpo 設定**] で、DirectAccess サーバーの gpo 名とクライアントの gpo 名が一覧表示されます。 さらに、GPO 選択設定を変更できます。

2つの Gpo は、DirectAccess の設定で自動的に設定され、この方法で配布されます。

1. **DirectAccess クライアント GPO**。 この GPO には、IPv6 移行テクノロジ設定、NRPT エントリ、セキュリティが強化された Windows ファイアウォール接続セキュリティの規則を含むクライアント設定が含まれます。 この GPO は、クライアント コンピューターに対して指定されたセキュリティ グループに適用されます。

2. **DirectAccess サーバー GPO**。 この GPO には、展開でリモートアクセスサーバーとして構成されている任意のサーバーに適用される DirectAccess 構成設定が含まれています。 また、セキュリティが強化された Windows ファイアウォールの接続セキュリティの規則も含まれます。

## <a name="summary"></a>まとめ

リモートアクセスの構成が完了すると、**概要**が表示されます。 構成した設定を変更するか、[**完了**] をクリックして構成を適用することができます。
