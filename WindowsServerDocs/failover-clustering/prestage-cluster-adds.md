---
title: Active Directory Domain Services でクラスター コンピューター アカウントを事前設定する
description: Active Directory Domain Services でクラスターコンピューターオブジェクトをプレステージする方法
ms.prod: windows-server
ms.topic: article
author: JasonGerend
ms.author: jgerend
manager: lizross
ms.technology: storage-failover-clustering
ms.date: 05/09/2019
ms.localizationpriority: medium
ms.openlocfilehash: c0d8efc1bdb5a2c3a653afbe61b211f94658101d
ms.sourcegitcommit: d99bc78524f1ca287b3e8fc06dba3c915a6e7a24
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/27/2020
ms.locfileid: "87181728"
---
# <a name="prestage-cluster-computer-objects-in-active-directory-domain-services"></a>Active Directory Domain Services でクラスター コンピューター アカウントを事前設定する

> 適用先:Windows Server 2019、Windows Server 2016、Windows Server 2012 R2、Windows Server 2012

このトピックでは、Active Directory ドメイン サービス (AD DS) でクラスター コンピューター オブジェクトをプレステージする方法について説明します。 この手順を使用すると、ユーザーまたはグループが AD DS でコンピューター オブジェクトを作成する権限を持っていない場合でも、フェールオーバー クラスターを作成できるようになります。

クラスターの作成ウィザードまたは Windows PowerShell を使用してフェールオーバー クラスターを作成する場合は、クラスターの名前を指定する必要があります。 クラスターを作成する場合に十分な権限を持っている場合は、クラスターの作成プロセスによって、クラスターの名前と一致するコンピューター オブジェクトが AD DS 内に自動的に作成されます。 このオブジェクトは、"クラスター名オブジェクト" (CNO) とも呼ばれます。** クライアント アクセス ポイントを使用するクラスター化された役割を構成するときに、CNO を通じて、仮想コンピューター オブジェクト (VCO) が自動的に作成されます。 たとえば、 *FileServer1*という名前のクライアント アクセス ポイントを持つ高可用性ファイル サーバーを作成すると、CNO は対応する VCO を AD DS 内に作成します。

>[!NOTE]
>AD DS で CNO または Vco が作成されていない Active Directory デタッチされたクラスターを作成するオプションがあります。 これは、特定の種類のクラスター展開を目的としたオプションです。 詳細については、「[Active Directory からデタッチされたクラスターを展開する](</previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/dn265970(v%3dws.11)>)」を参照してください。

CNO が自動的に作成されるようにするには、フェールオーバー クラスターを作成するユーザーが、組織単位 (OU) に対して、またはクラスターを形成するサーバーが存在しているコンテナーに対して、**コンピューター オブジェクトを作成する**権限を持っている必要があります。 この権限を持っていないユーザーまたはグループがクラスターを作成できるようにするには、AD DS で適切な権限を持つユーザー (通常はドメイン管理者) が AD DS 内に CNO をプレステージします。 このようにすると、ドメイン管理者はクラスターで使用される命名規則をより細かく制御し、クラスター オブジェクトがどの OU 内に作成されるかを制御できるようになります。

## <a name="step-1-prestage-the-cno-in-ad-ds"></a>手順 1: AD DS で CNO をプレステージする

開始する前に、次の情報を確認しておきます。

- クラスターの割り当て先の名前
- クラスターを作成する権限を付与するユーザーアカウントまたはグループの名前

ベスト プラクティスとして、クラスター オブジェクト用の OU を作成することをお勧めします。 使用する OU が既に存在する場合、この手順を完了するには、**Account Operators** グループのメンバーシップが最低限必要です。 クラスター オブジェクト用の OU を作成する必要がある場合、この手順を完了するには、**Domain Admins** グループのメンバーシップ、またはそれと同等のメンバーシップが最低限必要です。

>[!NOTE]
>OU でなく、既定の Computers コンテナーに CNO を作成する場合は、このトピックの手順 3. を完了する必要はありません。 このシナリオでは、クラスター管理者は追加の構成をしなくても、最大で 10 個の VCO を作成できます。

### <a name="prestage-the-cno-in-ad-ds"></a>AD DS で CNO を事前設定する

1. リモート サーバー管理ツールから AD DS ツールがインストールされているコンピューター上で、またはドメイン コントローラー上で、 **[Active Directory ユーザーとコンピューター]** を開きます。 サーバーでこれを行うにはサーバーマネージャーを起動し、[**ツール**] メニューの [ **Active Directory ユーザーとコンピューター**] を選択します。
2. クラスターコンピューターオブジェクトの OU を作成するには、ドメイン名または既存の OU を右クリックして [**新規**作成] をポイントし、[**組織単位**] を選択します。 [**名前**] ボックスに OU の名前を入力し、[ **OK]** を選択します。
3. コンソールツリーで、CNO を作成する OU を右クリックし、[**新規**作成] をポイントして、[**コンピューター**] を選択します。
4. [**コンピューター名**] ボックスに、フェールオーバークラスターに使用する名前を入力し、[ **OK]** を選択します。

   >[!NOTE]
   >これは、クラスターを作成するユーザーがクラスターの作成ウィザードの **[クラスター管理用のアクセス ポイント]** ページで指定するか、 *–Name* Windows PowerShell コマンドレットで **New-Cluster** パラメーターの値として指定するクラスター名です。

5. ベストプラクティスとして、作成したコンピューターアカウントを右クリックし、[**プロパティ**] をクリックして、[**オブジェクト**] タブを選択します。[**オブジェクト**] タブで、[**誤って削除**されないようにオブジェクトを保護する] チェックボックスをオンにし、[ **OK]** を選択します。
6. 作成したコンピューターアカウントを右クリックし、[**アカウントを無効に**する] を選択します。 [**はい**] を選択して確定し、[ **OK]** を選択します。

   >[!NOTE]
   >クラスターの作成中は、ドメイン内の既存のコンピューターまたはクラスターによってアカウントが使用されていないことをクラスターの作成プロセスが確認できるように、アカウントを無効にする必要があります。

![サンプル クラスター OU での無効化された CNO](media/prestage-cluster-adds/disabled-cno-in-the-example-clusters-ou.png)

**図 1.例のクラスター OU で無効になっている CNO**

## <a name="step-2-grant-the-user-permissions-to-create-the-cluster"></a>手順 2: クラスターを作成する権限をユーザーに与える

フェールオーバー クラスターの作成に使用するユーザー アカウントが CNO に対してフル コントロールの権限を持つように、権限を構成する必要があります。

この手順を実行するためには、**Account Operators** グループのメンバーシップが最低限必要です。

クラスターを作成するためのアクセス許可をユーザーに付与するには、次の手順を実行します。

1. [Active Directory ユーザーとコンピューター] の **[表示]** メニューで、**[拡張機能]** がオンになっていることを確認します。
2. CNO を探して右クリックし、[**プロパティ**] を選択します。
3. **[Security (セキュリティ)]** タブで **[Add (追加)]** を選択します。
4. **[ユーザー、コンピューター、またはグループの選択**] ダイアログボックスで、アクセス許可を付与するユーザーアカウントまたはグループを指定し、[ **OK]** を選択します。
5. 追加したユーザー アカウントまたはグループを選択し、**[フル コントロール]** の横にある **[許可]** チェック ボックスをオンにします。

   ![クラスターを作成するユーザーまたはグループへのフル コントロールの許可](media/prestage-cluster-adds/granting-full-control-to-the-user-create-the-cluster.png)

   **図 2.クラスターを作成するユーザーまたはグループにフルコントロールを付与する**
6. **[OK]** を選択します。

この手順を完了すると、権限を付与されたユーザーがフェールオーバー クラスターを作成できるようになります。 ただし、CNO が OU 内にある場合は、手順 3. が完了するまで、クライアント アクセス ポイントを必要とするクラスター化された役割をユーザーが作成することはできません。

>[!NOTE]
>CNO が既定の Computers コンテナー内にある場合、クラスター管理者は追加の構成をしなくても、最大で 10 個の VCO を作成できます。 10 個以上の VCO を追加するには、Computers コンテナーの CNO に **"コンピューター オブジェクトを作成する"** 権限を明示的に付与する必要があります。

## <a name="step-3-grant-the-cno-permissions-to-the-ou-or-prestage-vcos-for-clustered-roles"></a>手順 3: CNO に OU へのアクセス許可を与えるか、クラスター化された役割のための VCO をプレステージする

クライアント アクセス ポイントを持つクラスター化された役割を作成する場合、クラスターは CNO と同じ OU 内に VCO を作成します。 この動作が自動的に行われるようにするために、CNO は OU にコンピューター オブジェクトを作成する権限を持っている必要があります。

AD DS で CNO をプレステージした場合、VCO を作成するには、次のいずれかの操作を行います。

- オプション 1: [CNO に OU へのアクセス許可を与えます](#grant-the-cno-permissions-to-the-ou)。 このオプションを使用すると、クラスターは自動的に AD DS 内に VCO を作成できます。 そのため、フェールオーバー クラスターの管理者は、AD DS 内で VCO がプレステージされていなくても、クラスター化された役割を作成できます。

>[!NOTE]
>このオプションの手順を実行するには、**Domain Admins** グループのメンバーシップ、またはそれと同等のメンバーシップが最低限必要です。

- オプション 2:[クラスター化された役割のために VCO を事前](#prestage-a-vco-for-a-clustered-role)設定します。 組織の要件によって、クラスター化された役割のためのアカウントをプレステージする必要がある場合は、このオプションを使用します。 たとえば、命名規則を制御したり、どのクラスター化された役割が作成されるかを制御したい場合があります。

>[!NOTE]
>このオプションの手順を実行するには、**Account Operators** グループのメンバーシップが最低限必要です。

### <a name="grant-the-cno-permissions-to-the-ou"></a>CNO のアクセス許可を OU に付与します。

1. [Active Directory ユーザーとコンピューター] の **[表示]** メニューで、**[拡張機能]** がオンになっていることを確認します。
2. 「[手順 1: AD DS で cno をプレステージ](#step-1-prestage-the-cno-in-ad-ds)する」で cno を作成した OU を右クリックし、[**プロパティ**] を選択します。
3. [**セキュリティ**] タブで、[**詳細設定**] を選択します。
4. [**セキュリティの詳細設定**] ダイアログボックスで、[**追加**] を選択します。
5. [**プリンシパル**] の横の [**プリンシパルの選択**] を選択します。
6. **[ユーザー、コンピューター、サービスアカウントまたはグループの選択**] ダイアログボックスで、[**オブジェクトの種類**] を選択し、[**コンピューター** ] チェックボックスをオンにして、[ **OK]** を選択します。
7. [**選択するオブジェクト名を入力してください**] に CNO の名前を入力し、[**名前の確認**] を選択して、[ **OK]** を選択します。 無効なオブジェクトを追加しようとしていることを示す警告メッセージが表示されたら、[ **OK]** を選択します。
8. **[アクセス許可エントリ]** ダイアログ ボックスで、**[種類]** の一覧が **[許可]** に設定され、**[適用先]** の一覧が **[このオブジェクトとすべての子オブジェクト]** に設定されていることを確認します。
9. **[アクセス許可]** で **[コンピューター オブジェクトの作成]** チェック ボックスをオンにします。

   ![CNO へのコンピューター オブジェクトを作成する権限の付与](media/prestage-cluster-adds/granting-create-computer-objects-permission-to-the-cno.png)

   **図 3.CNO へのコンピューターオブジェクトの作成アクセス許可の付与**
10. [Active Directory ユーザーとコンピューター] スナップインに戻るまで [ **OK** ] を選択します。

フェールオーバー クラスターの管理者は、クライアント アクセス ポイントを持つクラスター化された役割を作成し、リソースをオンラインにできるようになりました。

### <a name="prestage-a-vco-for-a-clustered-role"></a>クラスター化された役割のために VCO を事前設定する

1. 操作を始める前に、クラスターの名前と、クラスター化された役割に使用する名前を確認します。
2. [Active Directory ユーザーとコンピューター] の **[表示]** メニューで、**[拡張機能]** がオンになっていることを確認します。
3. [Active Directory ユーザーとコンピューター] で、クラスターの CNO が存在する OU を右クリックし、[**新規作成**] をポイントして [**コンピューター**] を選択します。
4. [**コンピューター名**] ボックスに、クラスター化された役割に使用する名前を入力し、[ **OK]** を選択します。
5. ベストプラクティスとして、作成したコンピューターアカウントを右クリックし、[**プロパティ**] をクリックして、[**オブジェクト**] タブを選択します。[**オブジェクト**] タブで、[**誤って削除**されないようにオブジェクトを保護する] チェックボックスをオンにし、[ **OK]** を選択します。
6. 作成したコンピューターアカウントを右クリックし、[**プロパティ**] を選択します。
7. **[Security (セキュリティ)]** タブで **[Add (追加)]** を選択します。
8. **[ユーザー、コンピューター、サービスアカウントまたはグループの選択**] ダイアログボックスで、[**オブジェクトの種類**] を選択し、[**コンピューター** ] チェックボックスをオンにして、[ **OK]** を選択します。
9. [**選択するオブジェクト名を入力してください**] に CNO の名前を入力し、[**名前の確認**] を選択して、[ **OK]** を選択します。 無効なオブジェクトを追加しようとしていることを示す警告メッセージが表示された場合は、[ **OK]** を選択します。
10. CNO が選択されていることを確認し、**[フル コントロール]** の横にある **[許可]** チェック ボックスをオンにします。
11. **[OK]** を選択します。

フェールオーバー クラスターの管理者は、プレステージされた VCO 名と一致するクライアント アクセス ポイントを持つクラスター化された役割を作成し、リソースをオンラインにできるようになりました。

## <a name="more-information"></a>詳細情報

- [フェールオーバー クラスタリング](failover-clustering.md)
- [Active Directory でクラスターのアカウントを構成する](configure-ad-accounts.md)